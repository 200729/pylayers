<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pylayers.measures.ptin &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../../../index.html"><img src="../../../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../../../notebook/index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pylayers.measures.ptin</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="kn">as</span> <span class="nn">nplg</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">pdb</span>

<span class="kn">from</span> <span class="nn">pylayers.location.geometric.constraints.cla</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.location.geometric.constraints.toa</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.location.geometric.constraints.rss</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.network.model</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.location.algebraic.algebraic</span> <span class="kn">import</span> <span class="o">*</span>


<div class="viewcode-block" id="cdf"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.cdf">[docs]</a><span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">colsym</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">lab</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a cumulative density function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">x</span>  <span class="o">=</span> <span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">n</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">repeat</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">colsym</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">lab</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
        <span class="c">#plt.semilogx(x2,y2,colsym,label=lab,linewidth=lw)</span>
        </div>
<div class="viewcode-block" id="get_data"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.get_data">[docs]</a><span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        read data from csv File</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">values</span>
        <span class="c">#data = genfromtxt(fname,delimiter=&#39;;&#39;)</span>
        <span class="c">#return data</span>

<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c"># Scenario 11 and 12 LOS corridor rotation (0, then 90) degree#</span>
<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</div>
<div class="viewcode-block" id="s1x_dump_csv"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s1x_dump_csv">[docs]</a><span class="k">def</span> <span class="nf">s1x_dump_csv</span><span class="p">(</span><span class="n">scenario</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s11.csv&quot;</span>
    <span class="k">elif</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
        <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s12.csv&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error: sceanrio is either 11 or 12&#39;</span><span class="p">)</span>
    <span class="n">ts_s12</span> <span class="o">=</span> <span class="s">&quot;2013-05-13 23:37:00.000&quot;</span> <span class="c"># s12 start from here</span>
    <span class="n">f_gt</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario1x/TruePosition.csv&#39;</span>
    <span class="n">f_aco</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario1x/ACOLinkMeasurements.csv&#39;</span>
    <span class="n">f_dlr</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario1x/DLR_COOP_Measurement.csv&#39;</span>
    <span class="n">f_cea</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario1x/CEALinkMeasurements.csv&#39;</span>
    <span class="n">f_it</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario1x/ITLinkMeasurements.csv&#39;</span>

    <span class="n">data_gt</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_gt</span><span class="p">)</span>
    <span class="n">data_aco</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_aco</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;ACO &#39;</span><span class="p">,</span><span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">AcoPeerID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">AcoPeerID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">AcoPeerID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_aco</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">AcoPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;Zigbee&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_aco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_aco</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from DLR ofdm links</span>
    <span class="n">data_dlr</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_dlr</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;DLR &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">DlrPeerID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DlrPeerID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">DlrPeerID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_dlr</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">DlrPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_dlr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_dlr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_dlr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from CEA links</span>
    <span class="n">data_cea</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_cea</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;CEA &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">CeaPeerID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">CeaPeerID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">CeaPeerID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_cea</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">CeaPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;UWB&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="p">}</span>
        <span class="n">df_cea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_cea</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_cea</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from IT links</span>
    <span class="n">data_it</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_it</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_it</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">u</span><span class="o">=</span><span class="n">where</span><span class="p">(</span><span class="n">data_it</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;IT &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">ItPeerID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ItPeerID</span> <span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">scenario</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ItPeerID</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">ts_s12</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c">#due to missing data (wifi coordinates) the next &quot;if&quot; condition is necessary</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="bp">None</span>
            
        <span class="n">vect_it</span> <span class="o">=</span> <span class="p">{</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;S2&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_it</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_it</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_it</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    </div>
<div class="viewcode-block" id="s11_rss_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s11_rss_aco">[docs]</a><span class="k">def</span> <span class="nf">s11_rss_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s11.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid zigbee measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># get all measured RSS</span>
    <span class="n">all_rss</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u1</span><span class="p">:</span>
        <span class="n">all_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]))</span>
    <span class="c"># plot the histogram of zigbee RSS</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">all_rss</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssZig_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># get the rss values, the mean RSS and the distance for each GT position</span>
    <span class="n">mean_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rssj</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">mean_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rssj</span><span class="p">)),</span><span class="n">rssj</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssZig_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># get the path loss model</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="n">mean_rss</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">mean_rss</span><span class="p">)</span><span class="o">-</span><span class="n">PL0</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist</span><span class="p">)))</span>
    <span class="k">print</span> <span class="n">PL0</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>
</div>
<div class="viewcode-block" id="s11_rss_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s11_rss_dlr">[docs]</a><span class="k">def</span> <span class="nf">s11_rss_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s11.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="c"># get the index u of all valid zigbee measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># get all measured RSS</span>
    <span class="n">all_rss</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u1</span><span class="p">:</span>
        <span class="n">all_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]))</span>
    <span class="c"># plot the histogram of zigbee RSS</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">all_rss</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># get the rss values, the mean RSS and the distance for each GT position</span>
    <span class="n">mean_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rssj</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">mean_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rssj</span><span class="p">)),</span><span class="n">rssj</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># get the path loss model</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="n">mean_rss</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">mean_rss</span><span class="p">)</span><span class="o">-</span><span class="n">PL0</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist</span><span class="p">)))</span>
    <span class="k">print</span> <span class="n">PL0</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>
</div>
<div class="viewcode-block" id="s11_toa_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s11_toa_dlr">[docs]</a><span class="k">def</span> <span class="nf">s11_toa_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s11.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RTD/2 [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_toaDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Ranging error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_toaDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s11_toa_cea"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s11_toa_cea">[docs]</a><span class="k">def</span> <span class="nf">s11_toa_cea</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s11.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_toaCEA_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_toaCEA_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s11_rss_it"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s11_rss_it">[docs]</a><span class="k">def</span> <span class="nf">s11_rss_it</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s11.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid zigbee measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># get all measured RSS</span>
    <span class="n">all_rss</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u1</span><span class="p">:</span>
        <span class="n">all_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]))</span>
    <span class="c"># plot the histogram of zigbee RSS</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">all_rss</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssS2_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># get the rss values, the mean RSS and the distance for each GT position</span>
    <span class="n">mean_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rssj</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">mean_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rssj</span><span class="p">)),</span><span class="n">rssj</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S11_rssS2_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># get the path loss model</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="n">mean_rss</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">mean_rss</span><span class="p">)</span><span class="o">-</span><span class="n">PL0</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist</span><span class="p">)))</span>
    <span class="k">print</span> <span class="n">PL0</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>
</div>
<div class="viewcode-block" id="s12_rss_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s12_rss_aco">[docs]</a><span class="k">def</span> <span class="nf">s12_rss_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s12.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="c"># get the index u of all valid zigbee measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># get all measured RSS</span>
    <span class="n">all_rss</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u1</span><span class="p">:</span>
        <span class="n">all_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]))</span>
    <span class="c"># plot the histogram of zigbee RSS</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">all_rss</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_rssZig_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># get the rss values, the mean RSS and the distance for each GT position</span>
    <span class="n">mean_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rssj</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">mean_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rssj</span><span class="p">)),</span><span class="n">rssj</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_rssZig_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># get the path loss model</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="n">mean_rss</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">mean_rss</span><span class="p">)</span><span class="o">-</span><span class="n">PL0</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist</span><span class="p">)))</span>
    <span class="k">print</span> <span class="n">PL0</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>        
</div>
<div class="viewcode-block" id="s12_toa_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s12_toa_dlr">[docs]</a><span class="k">def</span> <span class="nf">s12_toa_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s12.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">11</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RTD/2 [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_toaDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Ranging error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_toaDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="s12_toa_cea"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s12_toa_cea">[docs]</a><span class="k">def</span> <span class="nf">s12_toa_cea</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s12.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_toaCEA_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_toaCEA_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s12_rss_it"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s12_rss_it">[docs]</a><span class="k">def</span> <span class="nf">s12_rss_it</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s12.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid zigbee measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c"># get all measured RSS</span>
    <span class="n">all_rss</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u1</span><span class="p">:</span>
        <span class="n">all_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">11</span><span class="p">]))</span>
    <span class="c"># plot the histogram of zigbee RSS</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">all_rss</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_rssS2_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c"># get the rss values, the mean RSS and the distance for each GT position</span>
    <span class="n">mean_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rssj</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rssj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">mean_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">rssj</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rssj</span><span class="p">)),</span><span class="n">rssj</span><span class="p">,</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S12_rssS2_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># get the path loss model</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">dist</span><span class="p">),</span><span class="n">mean_rss</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">mean_rss</span><span class="p">)</span><span class="o">-</span><span class="n">PL0</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">asarray</span><span class="p">(</span><span class="n">dist</span><span class="p">)))</span>
    <span class="k">print</span> <span class="n">PL0</span><span class="p">,</span> <span class="o">-</span><span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>   
<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c"># Scenario 2.1</span>
<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</div>
<div class="viewcode-block" id="s21_dump_csv"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s21_dump_csv">[docs]</a><span class="k">def</span> <span class="nf">s21_dump_csv</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s21.csv&quot;</span>
    <span class="n">f_gt</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario21/TruePosition.csv&#39;</span>
    <span class="n">f_aco</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario21/ACOLinkMeasurements.csv&#39;</span>
    <span class="n">f_dlr</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario21/DLR_COOP_Measurement.csv&#39;</span>
    <span class="n">f_cea</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario21/CEALinkMeasurements.csv&#39;</span>
    <span class="n">f_it</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario21/ITLinkMeasurements.csv&#39;</span>

    <span class="n">data_gt</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_gt</span><span class="p">)</span>
    <span class="n">data_aco</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_aco</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,:]))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;ACO &#39;</span><span class="p">,</span><span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">AcoPeerID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">AcoPeerID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_aco</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">AcoPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;Zigbee&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_aco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_aco</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from DLR ofdm links</span>
    <span class="n">data_dlr</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_dlr</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;DLR &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">DlrPeerID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">DlrPeerID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
            
        <span class="n">vect_dlr</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">DlrPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_dlr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_dlr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_dlr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from CEA links</span>
    <span class="n">data_cea</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_cea</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;CEA &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">CeaPeerID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">CeaPeerID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
                
        <span class="n">vect_cea</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">CeaPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;UWB&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="p">}</span>
        <span class="n">df_cea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_cea</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_cea</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            
        
    <span class="c"># dump data from IT links</span>
    <span class="n">data_it</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_it</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_it</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;IT &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">ItPeerID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ItPeerID</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c">#due to missing data (wifi coordinates) the next &quot;if&quot; condition is necessary</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="bp">None</span>
                
        <span class="n">vect_it</span> <span class="o">=</span> <span class="p">{</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">ItPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;S2&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_it</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_it</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_it</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="s21_rss_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s21_rss_aco">[docs]</a><span class="k">def</span> <span class="nf">s21_rss_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s21.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_rssZig_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="n">models</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">models</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">node</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_rssZig_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="k">return</span> <span class="n">models</span>

    </div>
<div class="viewcode-block" id="s21_toa_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s21_toa_dlr">[docs]</a><span class="k">def</span> <span class="nf">s21_toa_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s21.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RTD/2 [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_toaDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Ranging error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_toaDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>
    

</div>
<div class="viewcode-block" id="s21_toa_cea"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s21_toa_cea">[docs]</a><span class="k">def</span> <span class="nf">s21_toa_cea</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s21.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_toaCEA_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_toaCEA_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="s21_rss_it"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s21_rss_it">[docs]</a><span class="k">def</span> <span class="nf">s21_rss_it</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s21.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_rssS2_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
    <span class="k">print</span> <span class="s">&#39;GPL: &#39;</span><span class="p">,</span> <span class="n">PL0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>

    <span class="c">#for node in [ItSumsFixed]+ItSumsMobile:</span>
        <span class="c">#u = where((data[:,10]==&#39;S2&#39;)&amp;(data[:,2]==node))[0]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">ItWifi</span><span class="o">+</span><span class="p">[</span><span class="n">ItSumsFixed</span><span class="p">]</span><span class="o">+</span><span class="n">ItSumsMobile</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
            <span class="k">print</span> <span class="s">&#39;Node&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="s">&#39;: &#39;</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S21_rssS2_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c">#for node in [ItSumsFixed]+ItSumsMobile:</span>
        <span class="c">#u = where((data[:,10]==&#39;S2&#39;)&amp;(data[:,2]==node))[0]</span>
        <span class="c">#rss_all = data[u,11]</span>
        <span class="c">#dist_all = ((data[u,3]-data[u,7])**2+(data[u,4]-data[u,8])**2+(data[u,5]-data[u,9])**2)**0.5</span>
        <span class="c">#v = where((dist_all!=0) &amp; (isnan(list(dist_all))!=True))[0]</span>
        <span class="c">#PL=polyfit(10*log10(list(dist_all[v])),rss_all[v],1)</span>
        <span class="c">#n=-PL[0]</span>
        <span class="c">#PL0=PL[1]</span>
        <span class="c">#RSSI_std = std(list(rss_all[v])-PL0+10*n*log10(list(dist_all[v])))</span>
        <span class="c">#print &#39;Node&#39;, node, &#39;: &#39;,PL0, n, RSSI_std</span>
        <span class="c">#plt.plot(dist_all[v],rss_all[v],&#39;+&#39;,ms=8)</span>
    <span class="c">#plt.xlabel(&#39;Distance (m)&#39;)</span>
    <span class="c">#plt.ylabel(&#39;RSS [dBm]&#39;)</span>
    <span class="c">#plt.grid(&#39;on&#39;)</span>
    <span class="c">#plt.savefig(&#39;S21_rssS2_vs_dist_bis.png&#39;,format=&#39;png&#39;)</span>
    <span class="c">#plt.close()</span>
</div>
<div class="viewcode-block" id="s41_rss_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_rss_aco">[docs]</a><span class="k">def</span> <span class="nf">s41_rss_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_rssZig_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="n">models</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">models</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">node</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_rssZig_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="k">return</span> <span class="n">models</span>

    </div>
<div class="viewcode-block" id="s41_toa_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_toa_dlr">[docs]</a><span class="k">def</span> <span class="nf">s41_toa_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">26</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RTD/2 [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_toaDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Ranging error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_toaDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>
    

</div>
<div class="viewcode-block" id="s41_toa_cea"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_toa_cea">[docs]</a><span class="k">def</span> <span class="nf">s41_toa_cea</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="c"># get the index u of all valid OFDM measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TOA ranging error values, the mean TOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">toa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">toa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#toa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_toa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="n">toa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">toa_err</span><span class="p">,</span><span class="n">toa_err_j</span><span class="p">))</span>
        <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">toa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">),</span><span class="s">&#39;k-&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_toaCEA_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">toa_err</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Measured Distance [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_toaCEA_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_toa_err</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="s41_rss_it"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_rss_it">[docs]</a><span class="k">def</span> <span class="nf">s41_rss_it</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_rssS2_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
    <span class="k">print</span> <span class="s">&#39;GPL: &#39;</span><span class="p">,</span> <span class="n">PL0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>

    <span class="c">#for node in [ItSumsFixed]+ItSumsMobile:</span>
        <span class="c">#u = where((data[:,10]==&#39;S2&#39;)&amp;(data[:,2]==node))[0]</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">ItWifi</span><span class="o">+</span><span class="p">[</span><span class="n">ItSumsFixed</span><span class="p">]</span><span class="o">+</span><span class="n">ItSumsMobile</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;S2&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">))</span><span class="o">!=</span><span class="bp">True</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
            <span class="k">print</span> <span class="s">&#39;Node&#39;</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="s">&#39;: &#39;</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">RSSI_std</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_rssS2_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c">#for node in [ItSumsFixed]+ItSumsMobile:</span>
        <span class="c">#u = where((data[:,10]==&#39;S2&#39;)&amp;(data[:,2]==node))[0]</span>
        <span class="c">#rss_all = data[u,11]</span>
        <span class="c">#dist_all = ((data[u,3]-data[u,7])**2+(data[u,4]-data[u,8])**2+(data[u,5]-data[u,9])**2)**0.5</span>
        <span class="c">#v = where((dist_all!=0) &amp; (isnan(list(dist_all))!=True))[0]</span>
        <span class="c">#PL=polyfit(10*log10(list(dist_all[v])),rss_all[v],1)</span>
        <span class="c">#n=-PL[0]</span>
        <span class="c">#PL0=PL[1]</span>
        <span class="c">#RSSI_std = std(list(rss_all[v])-PL0+10*n*log10(list(dist_all[v])))</span>
        <span class="c">#print &#39;Node&#39;, node, &#39;: &#39;,PL0, n, RSSI_std</span>
        <span class="c">#plt.plot(dist_all[v],rss_all[v],&#39;+&#39;,ms=8)</span>
    <span class="c">#plt.xlabel(&#39;Distance (m)&#39;)</span>
    <span class="c">#plt.ylabel(&#39;RSS [dBm]&#39;)</span>
    <span class="c">#plt.grid(&#39;on&#39;)</span>
    <span class="c">#plt.savefig(&#39;S21_rssS2_vs_dist_bis.png&#39;,format=&#39;png&#39;)</span>
    <span class="c">#plt.close()</span>
         
    
    

<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c"># Scenario 4.1</span>
<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</div>
<div class="viewcode-block" id="s41_dump_csv"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_dump_csv">[docs]</a><span class="k">def</span> <span class="nf">s41_dump_csv</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s41.csv&quot;</span>
    <span class="n">f_gt</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario41/TruePosition.csv&#39;</span>
    <span class="n">f_aco</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario41/ACOLinkMeasurements.csv&#39;</span>
    <span class="n">f_dlr</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario41/DLR_COOP_Measurement.csv&#39;</span>
    <span class="n">f_cea</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario41/CEALinkMeasurements.csv&#39;</span>
    <span class="n">f_it</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario41/ITLinkMeasurements.csv&#39;</span>

    <span class="n">data_gt</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_gt</span><span class="p">)</span>
    <span class="n">data_aco</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_aco</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,:]))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;ACO &#39;</span><span class="p">,</span><span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">AcoPeerID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">AcoPeerID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_aco</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">AcoPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;Zigbee&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_aco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_aco</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from DLR ofdm links</span>
    <span class="n">data_dlr</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_dlr</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;DLR &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">DlrPeerID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">DlrPeerID</span> <span class="o">==</span> <span class="n">DlrRtdMaster</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
            
        <span class="n">vect_dlr</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">DlrPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;RTD-OFDM&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_dlr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_dlr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_dlr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c"># dump data from CEA links</span>
    <span class="n">data_cea</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_cea</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;CEA &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">CeaPeerID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">CeaPeerID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
                
        <span class="n">vect_cea</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">CeaPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;UWB&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="p">}</span>
        <span class="n">df_cea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_cea</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_cea</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        
    <span class="c"># dump data from IT links</span>
    <span class="n">data_it</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_it</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_it</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;IT &#39;</span><span class="p">,</span> <span class="n">i</span>
        
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">ItPeerID</span> <span class="o">=</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ItPeerID</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">ItPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c">#due to missing data (wifi coordinates) the next &quot;if&quot; condition is necessary</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i2</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">peerx</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peery</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">peerz</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nodex</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">nodey</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">nodez</span> <span class="o">=</span> <span class="bp">None</span>
                
        <span class="n">vect_it</span> <span class="o">=</span> <span class="p">{</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">ItPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;S2&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_it</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_it</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_it</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_it</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s41_rss2dist_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_rss2dist_aco">[docs]</a><span class="k">def</span> <span class="nf">s41_rss2dist_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">models</span><span class="o">=</span><span class="n">s21_rss_aco</span><span class="p">()</span>
    <span class="n">gpl</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">d0</span><span class="o">=</span><span class="mf">1.</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">range_all</span><span class="o">=</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss_all</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">rss</span> <span class="ow">in</span> <span class="n">rss_all</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">gpl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span> <span class="n">rss</span><span class="p">)</span> <span class="o">/</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">d0</span><span class="p">)</span>
        <span class="n">range_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">S</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">range_err</span> <span class="o">=</span> <span class="n">range_all</span><span class="o">-</span><span class="n">dist_all</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">range_err</span><span class="p">)),</span> <span class="n">std</span><span class="p">(</span><span class="n">range_err</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">k</span>
        <span class="n">vect_aco</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">2</span><span class="p">]),</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">6</span><span class="p">]),</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">data</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;Zigbee&#39;</span><span class="p">,</span>
                        <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">range_all</span><span class="p">[</span><span class="n">k</span><span class="p">],</span>
                        <span class="c">#columns[12]: None,</span>
                        <span class="c">#columns[13]: None,</span>
                        <span class="c">#columns[14]: None,</span>
                        <span class="c">#columns[15]: None,</span>
                        <span class="c">#columns[16]: None,</span>
                        <span class="c">#columns[17]: None,</span>
                        <span class="c">#columns[18]: None,</span>
                        <span class="p">}</span>
        <span class="n">df_aco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_aco</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;s41_estimated_Zigbee_dist.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">&#39;s41_estimated_Zigbee_dist.csv&#39;</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
        </div>
<div class="viewcode-block" id="s41_loc_cea"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_loc_cea">[docs]</a><span class="k">def</span> <span class="nf">s41_loc_cea</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">gtpid</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">rgpa_Pos_err</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">ml_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wls_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c">#crb_Pos_err = []</span>
    <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gtpid</span><span class="p">:</span>
        <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">CeaMobile</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">MobilePos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">CeaFixed</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">CeaMobile</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Toa</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Toa_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Toa</span><span class="p">])))</span>
                    <span class="n">RN_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>
                    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">CLA</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">)):</span>
                <span class="n">Ti</span><span class="o">=</span> <span class="n">TOA</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">HT</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">PE</span><span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err</span><span class="p">)</span>
            <span class="c"># algebraic techniques</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MobilePos</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_gt</span><span class="o">.</span><span class="n">T</span>

            <span class="n">ldp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="o">/</span><span class="mf">0.3</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">))</span>
            <span class="n">Al</span> <span class="o">=</span> <span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">ldp</span><span class="p">)</span>
            <span class="n">P0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c"># intial guess for ML</span>

            
            <span class="n">ml_pos</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">ml_locate</span><span class="p">(</span><span class="n">P0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ml_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">ml_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml_pos_err</span><span class="p">)</span>

            <span class="c">#wls_pos = Al.wls_locate(0,1,0)</span>
            <span class="c">#wls_pos_err = ((wls_pos[0,0]-MobilePos[0])**2+(wls_pos[1,0]-MobilePos[1])**2+(wls_pos[2,0]-MobilePos[2])**2)**0.5</span>
            <span class="c">#wls_Pos_err.append(wls_pos_err)</span>

            <span class="c">#crb_pos = Al.crb(MobilePos,0,1,0)</span>
            <span class="c">#crb_Pos_err.append(crb_pos)</span>
            
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span><span class="s">&#39;RGPA&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;ML&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c">#cdf(wls_Pos_err,&#39;y-&#39;,&#39;WLS&#39;, lw=2)</span>
    <span class="c">#cdf(crb_Pos_err,&#39;b-&#39;,&#39;CRB&#39;, lw=2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Positioning error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Cumulative probability&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_UWB_ML_RGPA.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="s41_loc_zig"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_loc_zig">[docs]</a><span class="k">def</span> <span class="nf">s41_loc_zig</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">gtpid</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">rgpa_Pos_err</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">ml_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">wls_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">crb_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gtpid</span><span class="p">:</span>
        <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">MobilePos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Rss</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Rss_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Rss</span><span class="p">])))</span>
                    <span class="n">RN_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>
                    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">rss_std</span> <span class="o">=</span> <span class="mf">7.71</span>
            <span class="n">rss_np</span> <span class="o">=</span> <span class="mf">2.25</span>
            <span class="n">d0</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">pl0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">49.31</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">CLA</span><span class="p">()</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span><span class="n">rssnp</span><span class="o">=</span><span class="n">rss_np</span><span class="p">,</span> <span class="n">d0</span><span class="o">=</span><span class="n">d0</span><span class="p">,</span> <span class="n">sigrss</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;mode&#39;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">PL0</span> <span class="o">=</span> <span class="n">pl0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">)):</span>
                <span class="n">Ti</span><span class="o">=</span><span class="n">RSS</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Rss_gt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">HT</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">PE</span><span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err</span><span class="p">)</span>
            <span class="c"># algebraic techniques</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MobilePos</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_gt</span><span class="o">.</span><span class="n">T</span>
            
            <span class="n">ldp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rss_gt</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_std</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_np</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;d0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d0</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;PL0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pl0</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">Al</span> <span class="o">=</span> <span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">ldp</span><span class="p">)</span>
            <span class="n">P0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c"># intial guess for ML</span>

            
            <span class="n">ml_pos</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">ml_locate</span><span class="p">(</span><span class="n">P0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ml_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">ml_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml_pos_err</span><span class="p">)</span>

            <span class="c">#wls_pos = Al.wls_locate(1,0,0)</span>
            <span class="c">#wls_pos_err = ((wls_pos[0,0]-MobilePos[0])**2+(wls_pos[1,0]-MobilePos[1])**2+(wls_pos[2,0]-MobilePos[2])**2)**0.5</span>
            <span class="c">#wls_Pos_err.append(wls_pos_err)</span>

            <span class="c">#crb_pos = Al.crb(MobilePos,1,0,0)</span>
            <span class="c">#crb_Pos_err.append(crb_pos)</span>
            
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span><span class="s">&#39;RGPA&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;ML&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c">#cdf(wls_Pos_err,&#39;y-&#39;,&#39;WLS&#39;, lw=2)</span>
    <span class="c">#cdf(crb_Pos_err,&#39;b-&#39;,&#39;CRB&#39;, lw=2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Positioning error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Cumulative probability&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_Zig_ML_RGPA.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="s41_loc_zig_uwb"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_loc_zig_uwb">[docs]</a><span class="k">def</span> <span class="nf">s41_loc_zig_uwb</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">gtpid</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">rgpa_Pos_err</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">rgpa_Pos_err_rss</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">ml_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ml_Pos_err_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c">#wls_Pos_err = []</span>
    <span class="n">crb_Pos_err_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">crb_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gtpid</span><span class="p">:</span>
        <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_RSS_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">MobilePos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Rss</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Rss_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Rss</span><span class="p">])))</span>
                    <span class="n">RN_RSS_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_RSS_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>


        <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_TOA_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">CeaFixed</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">CeaMobile</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Toa</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Toa_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Toa</span><span class="p">])))</span>
                    <span class="n">RN_TOA_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_TOA_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>
                    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="c">#print &#39;number of RSS=&#39;,len(Rss_gt)</span>
            <span class="n">rss_std</span> <span class="o">=</span> <span class="mf">7.71</span>
            <span class="n">rss_np</span> <span class="o">=</span> <span class="mf">2.25</span>
            <span class="n">d0</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">pl0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">49.31</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">CLA</span><span class="p">()</span>
            <span class="n">C_rss</span><span class="o">=</span><span class="n">CLA</span><span class="p">()</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span><span class="n">rssnp</span><span class="o">=</span><span class="n">rss_np</span><span class="p">,</span> <span class="n">d0</span><span class="o">=</span><span class="n">d0</span><span class="p">,</span> <span class="n">sigrss</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;mode&#39;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">PL0</span> <span class="o">=</span> <span class="n">pl0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">)):</span>
                <span class="n">Ti</span><span class="o">=</span><span class="n">RSS</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Rss_gt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_RSS_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
                <span class="n">C_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            <span class="n">C_rss</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
            <span class="c">#C_rss.merge2()</span>
            <span class="c">#C_rss.refine(C_rss.Nc)</span>
            <span class="c">#C_rss.estpos2()</span>
            <span class="n">PE_rss</span><span class="o">=</span> <span class="n">C_rss</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err_rss</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE_rss</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE_rss</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE_rss</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err_rss</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">)):</span>
                <span class="n">Ti</span><span class="o">=</span> <span class="n">TOA</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_TOA_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            <span class="n">C</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
            <span class="c">#C.merge2()</span>
            <span class="c">#C.refine(C.Nc)</span>
            <span class="c">#C.estpos2()</span>
            <span class="n">PE</span><span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err</span><span class="p">)</span>
            <span class="c">#pdb.set_trace()</span>
            <span class="c"># algebraic techniques</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MobilePos</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_RSS_gt</span><span class="o">.</span><span class="n">T</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_TOA_gt</span><span class="o">.</span><span class="n">T</span>
            
            <span class="n">ldp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rss_gt</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_std</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_np</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;d0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d0</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;PL0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pl0</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="o">/</span><span class="mf">0.3</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">))</span>
            <span class="n">Al</span> <span class="o">=</span> <span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">ldp</span><span class="p">)</span>
            <span class="n">P0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c"># intial guess for ML</span>

            
            <span class="n">ml_pos_rss</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">ml_locate</span><span class="p">(</span><span class="n">P0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ml_pos_err_rss</span> <span class="o">=</span> <span class="p">((</span><span class="n">ml_pos_rss</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos_rss</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos_rss</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">ml_Pos_err_rss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml_pos_err_rss</span><span class="p">)</span>

            <span class="n">ml_pos</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">ml_locate</span><span class="p">(</span><span class="n">P0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ml_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">ml_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml_pos_err</span><span class="p">)</span>

            <span class="c">#wls_pos = Al.wls_locate(1,0,0)</span>
            <span class="c">#wls_pos_err = ((wls_pos[0,0]-MobilePos[0])**2+(wls_pos[1,0]-MobilePos[1])**2+(wls_pos[2,0]-MobilePos[2])**2)**0.5</span>
            <span class="c">#wls_Pos_err.append(wls_pos_err)</span>

            <span class="c">#crb_pos = Al.crb(MobilePos,1,1,0)</span>
            <span class="c">#crb_Pos_err.append(crb_pos)</span>
            <span class="c">#crb_pos_rss = Al.crb(MobilePos,1,0,0)</span>
            <span class="c">#crb_Pos_err_rss.append(crb_pos_rss)</span>
            
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span><span class="s">&#39;RGPA (RSS+TOA)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err_rss</span><span class="p">,</span><span class="s">&#39;g--&#39;</span><span class="p">,</span><span class="s">&#39;RGPA(RSS)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;ML (RSS+TOA)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">ml_Pos_err_rss</span><span class="p">,</span><span class="s">&#39;r--&#39;</span><span class="p">,</span><span class="s">&#39;ML (RSS)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c">#cdf(wls_Pos_err,&#39;y-&#39;,&#39;WLS&#39;, lw=2)</span>
    <span class="c">#cdf(crb_Pos_err,&#39;b-&#39;,&#39;CRB (RSS+TOA)&#39;, lw=2)</span>
    <span class="c">#cdf(crb_Pos_err_rss,&#39;b--&#39;,&#39;CRB (RSS)&#39;, lw=2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Positioning error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Cumulative probability&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S41_ZigUwb_ML_RGPA.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s41_loc_zig_uwb_amb"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s41_loc_zig_uwb_amb">[docs]</a><span class="k">def</span> <span class="nf">s41_loc_zig_uwb_amb</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s41.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">gtpid</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">rgpa_Pos_err</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">rgpa_Pos_err_ht</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">ml_Pos_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ml_Pos_err_rss</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c">#wls_Pos_err = []</span>
    <span class="c">#crb_Pos_err = []</span>
    <span class="k">for</span> <span class="n">gt</span> <span class="ow">in</span> <span class="n">gtpid</span><span class="p">:</span>
        <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_RSS_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">MobilePos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">AcoDongleID</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Rss</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Rss_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Rss_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Rss</span><span class="p">])))</span>
                    <span class="n">RN_RSS_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_RSS_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>


        <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span>
        <span class="n">RN_TOA_gt</span> <span class="o">=</span> <span class="n">array</span><span class="p">([])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">fnode</span> <span class="ow">in</span> <span class="n">CeaFixed</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;GTPID= &#39;</span><span class="p">,</span><span class="n">gt</span><span class="p">,</span> <span class="s">&#39;Fixed Node = &#39;</span><span class="p">,</span> <span class="n">fnode</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;UWB&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">gt</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">fnode</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="n">CeaMobile</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">FixedPos</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]])</span>
                <span class="n">TrueDist</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
                <span class="n">Toa</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
                <span class="c">#if (any(isnan(FixedPos))==False) &amp; (abs(Toa-TrueDist)&lt;=1):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">isnan</span><span class="p">(</span><span class="n">FixedPos</span><span class="p">))</span><span class="o">==</span><span class="bp">False</span><span class="p">):</span>
                    <span class="n">Toa_gt</span> <span class="o">=</span> <span class="n">hstack</span><span class="p">((</span><span class="n">Toa_gt</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">Toa</span><span class="p">])))</span>
                    <span class="n">RN_TOA_gt</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">RN_TOA_gt</span><span class="p">,</span><span class="n">FixedPos</span><span class="p">))</span>
                    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">)</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">:</span>
            <span class="c">#print &#39;number of RSS=&#39;,len(Rss_gt)</span>
            <span class="n">rss_std</span> <span class="o">=</span> <span class="mf">7.71</span>
            <span class="n">rss_np</span> <span class="o">=</span> <span class="mf">2.25</span>
            <span class="n">d0</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">pl0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">49.31</span>
            <span class="n">C_ht</span> <span class="o">=</span> <span class="n">CLA</span><span class="p">()</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">CLA</span><span class="p">()</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="mf">3.</span><span class="p">,</span><span class="n">rssnp</span><span class="o">=</span><span class="n">rss_np</span><span class="p">,</span> <span class="n">d0</span><span class="o">=</span><span class="n">d0</span><span class="p">,</span> <span class="n">sigrss</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">&#39;mode&#39;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">PL0</span> <span class="o">=</span> <span class="n">pl0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
                <span class="n">Ti</span><span class="o">=</span> <span class="n">TOA</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_TOA_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:])</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
                <span class="n">C_ht</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            <span class="c">#for i in range(len(Rss_gt)):</span>
            <span class="c">#for i in range(2,4):</span>
                <span class="n">Ti</span><span class="o">=</span><span class="n">RSS</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">,</span><span class="n">value</span> <span class="o">=</span> <span class="n">Rss_gt</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">std</span><span class="o">=</span><span class="n">rss_std</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">RN_RSS_gt</span><span class="p">[</span><span class="n">i</span><span class="p">,:],</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">)</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
                <span class="n">C_ht</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ti</span><span class="p">)</span>
            
            <span class="n">C</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">HT</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="c">#C.merge2()</span>
            <span class="c">#C.refine(C.Nc)</span>
            <span class="c">#C.estpos()</span>
            <span class="n">PE</span><span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err</span><span class="p">)</span>
            <span class="n">C_ht</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">HT</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="c">#C_ht.merge2()</span>
            <span class="c">#C.refine(C_ht.Nc)</span>
            <span class="c">#C_ht.estpos_amb()</span>
            <span class="n">PE_ht</span><span class="o">=</span> <span class="n">C_ht</span><span class="o">.</span><span class="n">pe</span>
            <span class="n">rgpa_pos_err_ht</span> <span class="o">=</span> <span class="p">((</span><span class="n">PE_ht</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE_ht</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">PE_ht</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">rgpa_Pos_err_ht</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgpa_pos_err_ht</span><span class="p">)</span>
            <span class="c">#pdb.set_trace()</span>
            <span class="c"># algebraic techniques</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MobilePos</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_RSS_gt</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            <span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RN_TOA_gt</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:]</span><span class="o">.</span><span class="n">T</span>
            
            <span class="n">ldp</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rss_gt</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_std</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;RSS_np&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rss_np</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;d0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d0</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;PL0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pl0</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Rss_gt</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]))</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Toa_gt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mf">0.3</span>
            <span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TOA_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.19</span><span class="o">/</span><span class="mf">0.3</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span><span class="p">(</span><span class="n">Toa_gt</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">Al</span> <span class="o">=</span> <span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">ldp</span><span class="p">)</span>
            <span class="n">P0</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="c"># intial guess for ML</span>

            <span class="n">ml_pos</span> <span class="o">=</span> <span class="n">Al</span><span class="o">.</span><span class="n">ml_locate</span><span class="p">(</span><span class="n">P0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">ml_pos_err</span> <span class="o">=</span> <span class="p">((</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">ml_pos</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">MobilePos</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
            <span class="n">ml_Pos_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml_pos_err</span><span class="p">)</span>

            <span class="c">#wls_pos = Al.wls_locate(1,0,0)</span>
            <span class="c">#wls_pos_err = ((wls_pos[0,0]-MobilePos[0])**2+(wls_pos[1,0]-MobilePos[1])**2+(wls_pos[2,0]-MobilePos[2])**2)**0.5</span>
            <span class="c">#wls_Pos_err.append(wls_pos_err)</span>

            <span class="c">#crb_pos = Al.crb(MobilePos,1,0,0)</span>
            <span class="c">#crb_Pos_err.append(crb_pos)</span>
            
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err_ht</span><span class="p">,</span><span class="s">&#39;g-&#39;</span><span class="p">,</span><span class="s">&#39;RGPA HT (RSS+TOA)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">rgpa_Pos_err</span><span class="p">,</span><span class="s">&#39;g--&#39;</span><span class="p">,</span><span class="s">&#39;RGPA (RSS+TOA)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">cdf</span><span class="p">(</span><span class="n">ml_Pos_err</span><span class="p">,</span><span class="s">&#39;r-&#39;</span><span class="p">,</span><span class="s">&#39;ML (RSS+TOA)&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="c">#cdf(ml_Pos_err_rss,&#39;r--&#39;,&#39;ML (RSS)&#39;, lw=2)</span>
    <span class="c">#cdf(wls_Pos_err,&#39;y-&#39;,&#39;WLS&#39;, lw=2)</span>
    <span class="c">#cdf(crb_Pos_err,&#39;b-&#39;,&#39;CRB&#39;, lw=2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Positioning error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Cumulative probability&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        

<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="c"># Scenario 4.2</span>
<span class="c">#%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
</div>
<div class="viewcode-block" id="s42_dump_csv"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s42_dump_csv">[docs]</a><span class="k">def</span> <span class="nf">s42_dump_csv</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s42.csv&quot;</span>
    <span class="n">f_gt</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/TruePosition.csv&#39;</span>
    <span class="n">f_aco</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/ACOLinkMeasurements.csv&#39;</span>
    <span class="n">f_dlr</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/DLR_LTE_Measurements.csv&#39;</span>
    <span class="n">f_dlr_tdoa</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/DLR_LTE_TDoA.csv&#39;</span>
    <span class="n">f_cea</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/CEALinkMeasurements.csv&#39;</span>

    <span class="n">data_gt</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_gt</span><span class="p">)</span>
    <span class="n">data_aco</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_aco</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,:]))</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;ACO &#39;</span><span class="p">,</span><span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">AcoPeerID</span> <span class="o">=</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">AcoPeerID</span> <span class="ow">in</span> <span class="p">[</span><span class="n">AcoDongleID</span><span class="p">,</span><span class="n">AcoMobileID</span><span class="p">]:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">AcoPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">vect_aco</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">AcoPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;Zigbee&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="n">data_aco</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_aco</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_aco</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_aco</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>


    <span class="c"># dump data from CEA links</span>
    <span class="n">data_cea</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_cea</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;CEA &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">CeaPeerID</span> <span class="o">=</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">CeaPeerID</span> <span class="o">==</span> <span class="n">CeaMobile</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">CeaPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
                
        <span class="n">vect_cea</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">]),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">CeaPeerID</span><span class="p">),</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="s">&#39;UWB&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">data_cea</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="p">}</span>
        <span class="n">df_cea</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_cea</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">df_cea</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s42_lte_dump_csv"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s42_lte_dump_csv">[docs]</a><span class="k">def</span> <span class="nf">s42_lte_dump_csv</span><span class="p">():</span>
    
    <span class="n">csvfname</span><span class="o">=</span><span class="s">&quot;s42_lte.csv&quot;</span>
    <span class="n">f_gt</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/TruePosition.csv&#39;</span>
    <span class="n">f_dlr</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/DLR_LTE_Measurements.csv&#39;</span>
    <span class="n">f_dlr_tdoa</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/scenario42/DLR_LTE_TDoA.csv&#39;</span>
    <span class="n">data_gt</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_gt</span><span class="p">)</span>
    <span class="c"># dump data from DLR LTE links</span>
    <span class="n">data_dlr</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_dlr</span><span class="p">)</span>
    <span class="n">data_tdoa</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">f_dlr_tdoa</span><span class="p">)</span>
    <span class="n">u</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">u</span><span class="p">:</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">print</span> <span class="s">&#39;DLR LTE &#39;</span><span class="p">,</span> <span class="n">i</span>
        <span class="n">NodeID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">NodeID</span> <span class="o">==</span> <span class="n">DlrTdoaMobile</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">NodeID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nodex</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">nodey</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">nodez</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">DlrPeerBsID</span> <span class="o">=</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">DlrPeerBsID</span> <span class="o">==</span> <span class="n">DlrTdoaMobile</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerBsID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i2</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerBsID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerBsx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peerBsy</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerBsz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_tdoa</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="nb">float</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c">#print data_dlr[i,0]</span>
        <span class="c">#print data_tdoa[:,1]</span>
        <span class="c">#print v</span>
        <span class="n">DlrPeerID</span> <span class="o">=</span> <span class="n">data_tdoa</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">DlrPeerID</span> <span class="o">==</span> <span class="n">DlrTdoaMobile</span><span class="p">:</span>
            <span class="n">i3</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i3</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data_gt</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">DlrPeerID</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">peerx</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">peery</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">peerz</span> <span class="o">=</span> <span class="n">data_gt</span><span class="p">[</span><span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span>
                
        <span class="n">vect_dlr</span> <span class="o">=</span> <span class="p">{</span><span class="n">columns1</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">9</span><span class="p">]),</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">NodeID</span><span class="p">),</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span><span class="n">nodex</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span><span class="n">nodey</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">5</span><span class="p">]:</span><span class="n">nodez</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">6</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">DlrPeerBsID</span><span class="p">),</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">7</span><span class="p">]:</span><span class="n">peerBsx</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">8</span><span class="p">]:</span><span class="n">peerBsy</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">9</span><span class="p">]:</span><span class="n">peerBsz</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span><span class="nb">int</span><span class="p">(</span><span class="n">DlrPeerID</span><span class="p">),</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">11</span><span class="p">]:</span><span class="n">peerx</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">12</span><span class="p">]:</span><span class="n">peery</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">13</span><span class="p">]:</span><span class="n">peerz</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">14</span><span class="p">]:</span><span class="s">&#39;LTE&#39;</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">16</span><span class="p">]:</span> <span class="nb">float</span><span class="p">(</span><span class="n">data_tdoa</span><span class="p">[</span><span class="n">v</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">20</span><span class="p">]:</span> <span class="n">data_dlr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">21</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="n">columns1</span><span class="p">[</span><span class="mi">22</span><span class="p">]:</span> <span class="bp">None</span><span class="p">,</span>
                    <span class="p">}</span>
        <span class="n">df_dlr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">vect_dlr</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">columns</span><span class="o">=</span><span class="n">columns1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">df_dlr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df_dlr</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csvfname</span><span class="p">,</span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;;&#39;</span><span class="p">,</span><span class="n">mode</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s42_rss_aco"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s42_rss_aco">[docs]</a><span class="k">def</span> <span class="nf">s42_rss_aco</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s42.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">50</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S42_rssZig_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
    <span class="n">models</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">AcoFixedID</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">node</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
        <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">dist_all</span><span class="o">!=</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">PL</span><span class="o">=</span><span class="n">polyfit</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])),</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=-</span><span class="n">PL</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">PL0</span><span class="o">=</span><span class="n">PL</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">RSSI_std</span> <span class="o">=</span> <span class="n">std</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">])</span><span class="o">-</span><span class="n">PL0</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">n</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">])))</span>
        <span class="n">models</span> <span class="o">=</span> <span class="n">vstack</span><span class="p">((</span><span class="n">models</span><span class="p">,</span><span class="n">array</span><span class="p">([</span><span class="n">node</span><span class="p">,</span><span class="n">PL0</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">RSSI_std</span><span class="p">])))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dist_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="n">rss_all</span><span class="p">[</span><span class="n">v</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Distance (m)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;RSS [dBm]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S42_rssZig_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        
    <span class="k">return</span> <span class="n">models</span>
</div>
<div class="viewcode-block" id="s42_lte_dlr"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s42_lte_dlr">[docs]</a><span class="k">def</span> <span class="nf">s42_lte_dlr</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s42_lte.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    
    <span class="c"># get the index u of all valid LTE measurements</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;LTE&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c"># get the TDOA ranging error values, the mean TDOA ranging error and the true distance for each GT position</span>
    <span class="n">mean_tdoa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tdoa_err</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dist</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">u2</span><span class="p">:</span>
        <span class="n">uj</span> <span class="o">=</span> <span class="n">where</span><span class="p">((</span><span class="n">data</span><span class="p">[:,</span><span class="mi">14</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;LTE&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">j</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">11</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">12</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">13</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">tdoa_err_j</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">16</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">uj</span><span class="p">))</span>
        <span class="c">#tdoa_err_j=abs(data[uj,12]-d*ones(len(uj)))</span>
        <span class="n">mean_tdoa_err</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">tdoa_err_j</span><span class="p">))</span>
        <span class="n">tdoa_err</span><span class="o">=</span><span class="n">hstack</span><span class="p">((</span><span class="n">tdoa_err</span><span class="p">,</span><span class="n">tdoa_err_j</span><span class="p">))</span>
        <span class="c">#print mean(tdoa_err_j), std(tdoa_err_j), len(uj)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tdoa_err_j</span><span class="p">)),</span><span class="n">data</span><span class="p">[</span><span class="n">uj</span><span class="p">,</span><span class="mi">16</span><span class="p">],</span><span class="s">&#39;+&#39;</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
    <span class="c">#plt.plot(range(21),range(21),&#39;k-&#39;,lw=2)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Actual TDOA [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Measured TDOA [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S42_tdoaDLR_vs_dist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c"># plot the histogram of OFDM TOA</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">tdoa_err</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="n">normed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;TDOA ranging error [m]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;Number of points&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="s">&#39;on&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s">&#39;S42_tdoaDLR_hist.png&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="n">mean_tdoa_err</span><span class="p">),</span> <span class="n">std</span><span class="p">(</span><span class="n">mean_tdoa_err</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="s42_rss_aco_old"><a class="viewcode-back" href="../../../modules/pylayers.measures.html#pylayers.measures.ptin.s42_rss_aco_old">[docs]</a><span class="k">def</span> <span class="nf">s42_rss_aco_old</span><span class="p">():</span>

    <span class="n">fname</span><span class="o">=</span><span class="n">DISTDIR</span><span class="o">+</span><span class="s">&#39;/s42.csv&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">10</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;Zigbee&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">models</span><span class="o">=</span><span class="n">s21_rss_aco</span><span class="p">()</span>
    <span class="n">gpl</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">d0</span><span class="o">=</span><span class="mf">1.</span>
    <span class="n">rss_all</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
    <span class="n">dist_all</span> <span class="o">=</span> <span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="p">[</span><span class="n">u</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">range_all</span><span class="o">=</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rss_all</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">rss</span> <span class="ow">in</span> <span class="n">rss_all</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">M</span> <span class="o">=</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">gpl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span> <span class="n">rss</span><span class="p">)</span> <span class="o">/</span> <span class="n">gpl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">log</span><span class="p">(</span><span class="n">d0</span><span class="p">)</span>
        <span class="n">range_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">M</span> <span class="o">-</span> <span class="n">S</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="n">range_err</span> <span class="o">=</span> <span class="n">range_all</span><span class="o">-</span><span class="n">dist_all</span>
    <span class="k">print</span> <span class="n">mean</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">range_err</span><span class="p">)),</span> <span class="n">std</span><span class="p">(</span><span class="n">range_err</span><span class="p">)</span>
    <span class="sd">&#39;&#39;&#39;k = 0</span>
<span class="sd">    for j in u:</span>
<span class="sd">        print k</span>
<span class="sd">        vect_aco = {columns[0]:data[j,0],</span>
<span class="sd">                        columns[1]:int(data[j,1]),</span>
<span class="sd">                        columns[2]:int(data[j,2]),</span>
<span class="sd">                        columns[3]:data[j,3],</span>
<span class="sd">                        columns[4]:data[j,4],</span>
<span class="sd">                        columns[5]:data[j,5],</span>
<span class="sd">                        columns[6]:int(data[j,6]),</span>
<span class="sd">                        columns[7]:data[j,7],</span>
<span class="sd">                        columns[8]:data[j,8],</span>
<span class="sd">                        columns[9]:data[j,9],</span>
<span class="sd">                        columns[10]:&#39;Zigbee&#39;,</span>
<span class="sd">                        columns[11]: range_all[k],</span>
<span class="sd">                        #columns[12]: None,</span>
<span class="sd">                        #columns[13]: None,</span>
<span class="sd">                        #columns[14]: None,</span>
<span class="sd">                        #columns[15]: None,</span>
<span class="sd">                        #columns[16]: None,</span>
<span class="sd">                        #columns[17]: None,</span>
<span class="sd">                        #columns[18]: None,</span>
<span class="sd">                        }</span>
<span class="sd">        df_aco = pd.DataFrame(data=vect_aco,index=arange(1),columns=columns[0:12])</span>
<span class="sd">        if j == u[0]:</span>
<span class="sd">            df_aco.to_csv(&#39;s42_estimated_Zigbee_dist.csv&#39;,sep=&#39;;&#39;,mode=&#39;a&#39;,index=0)</span>
<span class="sd">        else:</span>
<span class="sd">            df_aco.to_csv(&#39;s42_estimated_Zigbee_dist.csv&#39;,sep=&#39;;&#39;,mode=&#39;a&#39;,index=0,header=False)</span>
<span class="sd">        k+=1&#39;&#39;&#39;</span>
</div>
<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="s">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">DISTDIR</span><span class="o">=</span><span class="s">&quot;./&quot;</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Timestamp&#39;</span><span class="p">,</span><span class="s">&#39;GTPID&#39;</span><span class="p">,</span><span class="s">&#39;NodeID&#39;</span><span class="p">,</span><span class="s">&#39;NodeX&#39;</span><span class="p">,</span><span class="s">&#39;NodeY&#39;</span><span class="p">,</span><span class="s">&#39;NodeZ&#39;</span><span class="p">,</span><span class="s">&#39;PeerID&#39;</span><span class="p">,</span><span class="s">&#39;PeerX&#39;</span><span class="p">,</span><span class="s">&#39;PeerY&#39;</span><span class="p">,</span><span class="s">&#39;PeerZ&#39;</span><span class="p">,</span><span class="s">&#39;RAT&#39;</span><span class="p">,</span><span class="s">&#39;RSS&#39;</span><span class="p">,</span><span class="s">&#39;TOA&#39;</span><span class="p">,</span><span class="s">&#39;SNR&#39;</span><span class="p">,</span><span class="s">&#39;CIR&#39;</span><span class="p">,</span><span class="s">&#39;CIR_real&#39;</span><span class="p">,</span><span class="s">&#39;CIR_imag&#39;</span><span class="p">,</span><span class="s">&#39;BER&#39;</span><span class="p">,</span><span class="s">&#39;FER&#39;</span><span class="p">]</span>
    <span class="n">columns1</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Timestamp&#39;</span><span class="p">,</span><span class="s">&#39;GTPID&#39;</span><span class="p">,</span><span class="s">&#39;NodeID&#39;</span><span class="p">,</span><span class="s">&#39;NodeX&#39;</span><span class="p">,</span><span class="s">&#39;NodeY&#39;</span><span class="p">,</span><span class="s">&#39;NodeZ&#39;</span><span class="p">,</span><span class="s">&#39;PeerBsID&#39;</span><span class="p">,</span><span class="s">&#39;PeerBsX&#39;</span><span class="p">,</span><span class="s">&#39;PeerBsY&#39;</span><span class="p">,</span><span class="s">&#39;PeerBsZ&#39;</span><span class="p">,</span><span class="s">&#39;PeerID&#39;</span><span class="p">,</span><span class="s">&#39;PeerX&#39;</span><span class="p">,</span><span class="s">&#39;PeerY&#39;</span><span class="p">,</span><span class="s">&#39;PeerZ&#39;</span><span class="p">,</span><span class="s">&#39;RAT&#39;</span><span class="p">,</span><span class="s">&#39;RSS&#39;</span><span class="p">,</span><span class="s">&#39;TDOA&#39;</span><span class="p">,</span><span class="s">&#39;SNR&#39;</span><span class="p">,</span><span class="s">&#39;CIR&#39;</span><span class="p">,</span><span class="s">&#39;CIR_real&#39;</span><span class="p">,</span><span class="s">&#39;CIR_imag&#39;</span><span class="p">,</span><span class="s">&#39;BER&#39;</span><span class="p">,</span><span class="s">&#39;FER&#39;</span><span class="p">]</span>

    <span class="c"># Zigbee acorde nodes IDs</span>
    <span class="n">AcoDongleID</span><span class="o">=</span><span class="mi">18</span>
    <span class="n">AcoFixedID</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">49</span><span class="p">]</span>
    <span class="n">AcoMobileID</span><span class="o">=</span><span class="mi">50</span>

    <span class="c"># DLR RTD slave and master IDs</span>
    <span class="n">DlrRtdSlave</span> <span class="o">=</span> <span class="mi">25</span>
    <span class="n">DlrRtdMaster</span> <span class="o">=</span> <span class="mi">24</span> <span class="c">#mobile on the trolley</span>

    <span class="c"># CEA nodes IDs</span>
    <span class="n">CeaMobile</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">CeaFixed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">62</span><span class="p">]</span>

    <span class="c"># IT nodes IDs</span>
    <span class="n">ItSumsMobile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">ItSumsFixed</span><span class="o">=</span><span class="mi">1</span>
    <span class="n">ItWifi</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">73</span><span class="p">]</span>

    <span class="c"># DLR LTE TDOA nodes IDs</span>
    <span class="n">DlrTdoaFixed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">26</span><span class="p">]</span>
    <span class="n">DlrTdoaMobile</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../../../notebook/index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2014, PyLayers developer team.
      Last updated on mars 09, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_setDomainName', 'pylayers.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })(); 
</script> 
 
  </body>
</html>