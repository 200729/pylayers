<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pylayers.simul.simulem &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../../../index.html"><img src="../../../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../../../notebook/index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../../index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for pylayers.simul.simulem</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    This module run the electromagnetic simulation with an old</span>
<span class="sd">    version of the Ray Tracing tool</span>

<span class="sd">    Deprecated</span>

<span class="sd">Utility Functions</span>
<span class="sd">=================</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     rename</span>
<span class="sd">     spafile</span>

<span class="sd">Palch class</span>
<span class="sd">===========</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Palch.__init__</span>
<span class="sd">    Palch.info</span>
<span class="sd">    Palch.info2</span>
<span class="sd">    Palch.load</span>
<span class="sd">    Palch.save</span>
<span class="sd">    Palch.gui</span>

<span class="sd">Patra class</span>
<span class="sd">===========</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     Patra.__init__</span>
<span class="sd">     Patra.info</span>
<span class="sd">     Patra.load</span>
<span class="sd">     Patra.save</span>
<span class="sd">     Patra.gui</span>

<span class="sd">Pafreq class</span>
<span class="sd">=============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     Pafreq.__init__</span>
<span class="sd">     Pafreq.info</span>
<span class="sd">     Pafreq.load</span>
<span class="sd">     Pafreq.save</span>
<span class="sd">     Pafreq.gui</span>



<span class="sd">Patud class</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     Patud.__init__</span>
<span class="sd">     Patud.info</span>
<span class="sd">     Patud.gui</span>

<span class="sd">     </span>
<span class="sd">Launch class</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     Launch.info</span>
<span class="sd">     Launch.choose</span>
<span class="sd">     Launch.load</span>
<span class="sd">     Launch.show</span>

<span class="sd">Simul class</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Simul.__init__</span>
<span class="sd">    Simul.gui</span>
<span class="sd">    Simul.updcfg</span>
<span class="sd">    Simul.clean</span>
<span class="sd">    Simul.clean_project</span>
<span class="sd">    Simul.save</span>
<span class="sd">    Simul.save_project</span>
<span class="sd">    Simul.load_project</span>
<span class="sd">    Simul.choose</span>
<span class="sd">    Simul.load</span>
<span class="sd">    Simul.layout</span>
<span class="sd">    Simul.show</span>
<span class="sd">    Simul.PL</span>
<span class="sd">    Simul.evalcir</span>
<span class="sd">    Simul.loadcir</span>
<span class="sd">    Simul.pltcir</span>
<span class="sd">    Simul.scatter</span>
<span class="sd">    Simul.info</span>
<span class="sd">    Simul.info2</span>
<span class="sd">    Simul.filtray</span>
<span class="sd">    Simul.showray</span>
<span class="sd">    Simul.show3l</span>
<span class="sd">    Simul._show3</span>
<span class="sd">    Simul.show3</span>
<span class="sd">    Simul.freq</span>
<span class="sd">    Simul.getlaunch</span>
<span class="sd">    Simul.gettra</span>
<span class="sd">    Simul.gettud</span>
<span class="sd">    Simul.launching</span>
<span class="sd">    Simul.tracing</span>
<span class="sd">    Simul.tratotud</span>
<span class="sd">    Simul.field</span>
<span class="sd">    Simul.run2</span>
<span class="sd">    Simul.run</span>
<span class="sd">    Simul.gt</span>
<span class="sd">    Simul.delay</span>
<span class="sd">    Simul.gr</span>
<span class="sd">    Simul.VC</span>
<span class="sd">    Simul.cir</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">doctest</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">getopt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">Tkinter</span><span class="o">,</span> <span class="nn">tkFileDialog</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">ConfigParser</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">cPickle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.io</span> <span class="kn">as</span> <span class="nn">spio</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">struct</span> <span class="kn">as</span> <span class="nn">stru</span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">import</span> <span class="nn">pylayers.util.geomutil</span> <span class="kn">as</span> <span class="nn">geu</span>
<span class="kn">import</span> <span class="nn">pylayers.util.plotutil</span> <span class="kn">as</span> <span class="nn">plu</span>
<span class="kn">import</span> <span class="nn">pylayers.signal.waveform</span> <span class="kn">as</span> <span class="nn">wvf</span>
<span class="kn">import</span> <span class="nn">pylayers.signal.bsignal</span> <span class="kn">as</span> <span class="nn">bs</span>
<span class="kn">from</span> <span class="nn">pylayers.simul.radionode</span> <span class="kn">import</span> <span class="n">RadioNode</span>
<span class="kn">from</span> <span class="nn">pylayers.util</span> <span class="kn">import</span> <span class="n">easygui</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.slab</span> <span class="kn">import</span> <span class="n">Slab</span><span class="p">,</span> <span class="n">SlabDB</span><span class="p">,</span> <span class="n">Mat</span><span class="p">,</span> <span class="n">MatDB</span>
<span class="c"># Handle Layout</span>
<span class="kn">from</span> <span class="nn">pylayers.gis.layout</span> <span class="kn">import</span> <span class="n">Layout</span>
<span class="c"># Handle Rays</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop.raysc</span> <span class="kn">import</span> <span class="n">GrRay3D</span><span class="p">,</span> <span class="n">GrRayTud</span>
<span class="c"># Handle VectChannel and ScalChannel</span>
<span class="kn">from</span> <span class="nn">pylayers.antprop</span> <span class="kn">import</span> <span class="n">channelc</span><span class="p">,</span><span class="n">signature</span>
<span class="c">#from   Channel import *</span>
<span class="c"># Handle directory hierarchy</span>
<span class="kn">from</span> <span class="nn">pylayers.util.project</span> <span class="kn">import</span> <span class="o">*</span>
<span class="c"># Handle UWB measurements</span>
<span class="kn">from</span> <span class="nn">pylayers.measures</span> <span class="kn">import</span> <span class="n">mesuwb</span> <span class="k">as</span> <span class="n">muwb</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">tvtk.api</span> <span class="kn">import</span> <span class="n">tvtk</span>
    <span class="kn">from</span> <span class="nn">mayavi.sources.vtk_data_source</span> <span class="kn">import</span> <span class="n">VTKDataSource</span>
    <span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">&#39;Layout:Mayavi is not installed&#39;</span>
<span class="kn">import</span> <span class="nn">pdb</span>


<div class="viewcode-block" id="rename"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.rename.html#pylayers.simul.simulem.rename">[docs]</a><span class="k">def</span> <span class="nf">rename</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span><span class="n">itx</span><span class="p">,</span><span class="n">irx</span><span class="p">,</span><span class="n">rep</span><span class="o">=</span><span class="s">&#39;./&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; rename simulation file with proper itx/irx </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    _filmename : short file name</span>
<span class="sd">    itx : transmitter index</span>
<span class="sd">    irx : transmitter index</span>
<span class="sd">    rep : directory</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    </span>
<span class="sd">    tratotud</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span><span class="n">rep</span><span class="p">)</span>
    <span class="n">f1</span>  <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;tx_[0-9]*&#39;</span><span class="p">,</span><span class="s">&#39;tx_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">),</span><span class="n">_filename</span><span class="p">)</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">&#39;rx_[0-9]*&#39;</span><span class="p">,</span><span class="s">&#39;rx_&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span><span class="n">f1</span><span class="p">)</span>
    <span class="n">filenew</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">new</span><span class="p">,</span><span class="n">rep</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">filenew</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="spafile"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.spafile.html#pylayers.simul.simulem.spafile">[docs]</a><span class="k">def</span> <span class="nf">spafile</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">sdir</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        create a .spa file for  Ray Tracing</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            _filename</span>
<span class="sd">                shortname of the file .spa</span>
<span class="sd">            point</span>
<span class="sd">                3d coordinates string</span>
<span class="sd">            sdir</span>
<span class="sd">                save directory relative to $BASENAME</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">filespaTx</span> <span class="o">=</span> <span class="n">_filename</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="n">sdir</span><span class="p">)</span>
    <span class="n">fspa</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">fspa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;0</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">fspa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;1</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">chaine</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">point</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;[&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;]&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">fspa</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chaine</span> <span class="o">+</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">fspa</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<span class="k">class</span> <span class="nc">Palch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Launching parameters class</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>

<span class="sd">    info</span>
<span class="sd">    load</span>
<span class="sd">        load from Project launch directory</span>
<span class="sd">    save</span>
<span class="sd">        save to Project launch directory</span>
<span class="sd">    gui</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Palch.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.__init__.html#pylayers.simul.simulem.Palch.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Palch.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.info.html#pylayers.simul.simulem.Palch.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;            Launching Parameter               &quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>

        <span class="k">print</span> <span class="s">&quot;angTx      : Tx angular step ( degrees)     : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">angTx</span>
        <span class="k">print</span> <span class="s">&quot;ISBang     : ISB angular sector ( degrees ) : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISBang</span>
        <span class="k">print</span> <span class="s">&quot;ethreshold : Exploration Threshold (linear) : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ethreshold</span>
        <span class="k">print</span> <span class="s">&quot;maxdeep    : Tree deep max (integer value)  : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span>
        <span class="k">print</span> <span class="s">&quot;typalgo    : Type of algo (default 0)       : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">typalgo</span>
</div>
<div class="viewcode-block" id="Palch.info2"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.info2.html#pylayers.simul.simulem.Palch.info2">[docs]</a>    <span class="k">def</span> <span class="nf">info2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">print</span> <span class="n">j</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Palch.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.load.html#pylayers.simul.simulem.Palch.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filepalch</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepalch</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">angTx</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ISBang</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ethreshold</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">typalgo</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Palch.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.save.html#pylayers.simul.simulem.Palch.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filepalch</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepalch</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angTx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ISBang</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ethreshold</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typalgo</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Palch.gui"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Palch.gui.html#pylayers.simul.simulem.Palch.gui">[docs]</a>    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Launching parameter .palch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">palchgui</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;Launching Parameter&#39;</span><span class="p">,</span>
                                <span class="p">(</span><span class="s">&#39;Tx angular step (degrees)&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;ISB angular sector (degrees)&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;Exploration threshold (linear)&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;Tree deep max (integer value)&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;type of algo (default 0)&#39;</span><span class="p">),</span>
                                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angTx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ISBang</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ethreshold</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">typalgo</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">palchgui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angTx</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">palchgui</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ISBang</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">palchgui</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ethreshold</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">palchgui</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">palchgui</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">typalgo</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">palchgui</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

</div>
<span class="k">class</span> <span class="nc">Patra</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tracing parameters class</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Patra.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patra.__init__.html#pylayers.simul.simulem.Patra.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Patra.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patra.info.html#pylayers.simul.simulem.Patra.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;            Tracing  Parameter                &quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;Max deep     : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span>
        <span class="k">print</span> <span class="s">&quot;distdiff     : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distdiff</span>
        <span class="k">print</span> <span class="s">&quot;var2D3D  0=2D 1=3D    : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2D3D</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">print</span> <span class="n">j</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Patra.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patra.load.html#pylayers.simul.simulem.Patra.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filepatra</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTRA&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepatra</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distdiff</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var2D3D</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Patra.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patra.save.html#pylayers.simul.simulem.Patra.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; save</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filepatra</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTRA&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepatra</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">distdiff</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">var2D3D</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Patra.gui"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patra.gui.html#pylayers.simul.simulem.Patra.gui">[docs]</a>    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get the Launching parameter .palch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">patragui</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;Launching Parameter&#39;</span><span class="p">,</span>
                                <span class="p">(</span><span class="s">&#39;Max Deep &#39;</span><span class="p">,</span>
                                 <span class="s">&#39;DistDiff&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;2D3D &#39;</span><span class="p">),</span>
                                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">distdiff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">var2D3D</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">patragui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maxdeep</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">patragui</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">distdiff</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">patragui</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var2D3D</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">patragui</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

</div>
<span class="k">class</span> <span class="nc">Pafreq</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; frequency setting</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Pafreq.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Pafreq.__init__.html#pylayers.simul.simulem.Pafreq.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Pafreq.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Pafreq.info.html#pylayers.simul.simulem.Pafreq.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display frequency range information</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;    Channel frequency range                   &quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;fGHz min : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fghzmin</span>
        <span class="k">print</span> <span class="s">&quot;fGHz max : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fghzmax</span>
        <span class="k">print</span> <span class="s">&quot;Number of points : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span>
</div>
<div class="viewcode-block" id="Pafreq.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Pafreq.load.html#pylayers.simul.simulem.Pafreq.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filefreq</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filefreq</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fghzmin</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fghzmax</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="Pafreq.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Pafreq.save.html#pylayers.simul.simulem.Pafreq.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filefreq</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
        <span class="n">fi</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filefreq</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fghzmin</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fghzmax</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
        <span class="n">fi</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Pafreq.gui"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Pafreq.gui.html#pylayers.simul.simulem.Pafreq.gui">[docs]</a>    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the Launching parameter .palch</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pafreqgui</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;Propagation Channel frequency &#39;</span><span class="p">,</span>
                                 <span class="p">(</span><span class="s">&#39;fp_min (GHz) &#39;</span><span class="p">,</span>
                                  <span class="s">&#39;fp_max (GHz) &#39;</span><span class="p">,</span>
                                  <span class="s">&#39;nfp  &#39;</span><span class="p">),</span>
                                 <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fghzmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fghzmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">pafreqgui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fghzmin</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">pafreqgui</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fghzmax</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">pafreqgui</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">pafreqgui</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

</div>
<span class="k">class</span> <span class="nc">Patud</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; tratotud parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Patud.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patud.__init__.html#pylayers.simul.simulem.Patud.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">purc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">nrmax</span><span class="o">=</span><span class="mi">500</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">purc</span> <span class="o">=</span> <span class="n">purc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">num</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrmax</span> <span class="o">=</span> <span class="n">nrmax</span>
</div>
<div class="viewcode-block" id="Patud.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patud.info.html#pylayers.simul.simulem.Patud.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; info</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">        &gt;&gt;&gt; p=Patud()</span>
<span class="sd">        &gt;&gt;&gt; p.info()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;            tratotud  parameters              &quot;</span>
        <span class="k">print</span> <span class="s">&quot;----------------------------------------------&quot;</span>
        <span class="k">print</span> <span class="s">&quot;num (-1 all rays) : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span>
        <span class="k">print</span> <span class="s">&quot;nrmax : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrmax</span>
        <span class="k">print</span> <span class="s">&quot;purc : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">purc</span>
</div>
<div class="viewcode-block" id="Patud.gui"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Patud.gui.html#pylayers.simul.simulem.Patud.gui">[docs]</a>    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; gui for tratotud parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tudgui</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;Launching Parameter&#39;</span><span class="p">,</span>
                              <span class="p">(</span><span class="s">&#39;num&#39;</span><span class="p">,</span>
                               <span class="s">&#39;nrmax&#39;</span><span class="p">,</span>
                               <span class="s">&#39;purc&#39;</span><span class="p">),</span>
                              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">purc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">tudgui</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrmax</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">tudgui</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">purc</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">tudgui</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

</div>
<span class="k">class</span> <span class="nc">Launch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; container to handle data from .lch files</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    Tx        array 1x3</span>
<span class="sd">    Ray_exist</span>
<span class="sd">    nstr</span>
<span class="sd">    deep</span>
<span class="sd">    x</span>
<span class="sd">    y</span>
<span class="sd">    node_phii</span>
<span class="sd">    node_phir</span>
<span class="sd">    edge_length</span>
<span class="sd">    edge_type</span>
<span class="sd">    tail</span>
<span class="sd">    head</span>


<span class="sd">    Methods</span>
<span class="sd">    ------</span>
<span class="sd">    load      : load a .lch file</span>
<span class="sd">    show      : view a .lch file</span>
<span class="sd">    info      : info about .lch</span>
<span class="sd">    launching :</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Launch.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Launch.info.html#pylayers.simul.simulem.Launch.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get __dict__ info</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
        <span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">print</span> <span class="n">j</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Launch.choose"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Launch.choose.html#pylayers.simul.simulem.Launch.choose">[docs]</a>    <span class="k">def</span> <span class="nf">choose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Choose a Launching  file in launchdir</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">tkFileDialog</span>
        <span class="n">FD</span> <span class="o">=</span> <span class="n">tkFileDialog</span>
        <span class="n">filelch</span> <span class="o">=</span> <span class="n">FD</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s">&quot;Fichiers Launching &quot;</span><span class="p">,</span> <span class="s">&quot;*.lch&quot;</span><span class="p">),</span>
                                                <span class="p">(</span><span class="s">&quot;All&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">)],</span>
                                     <span class="n">title</span><span class="o">=</span><span class="s">&quot;Please choose a Launching file&quot;</span><span class="p">,</span>
                                     <span class="n">initialdir</span><span class="o">=</span><span class="n">lchdir</span><span class="p">)</span>
        <span class="n">_filelch</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">filelch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_filelch</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Launch.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Launch.load.html#pylayers.simul.simulem.Launch.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_filelch</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; load a .lch file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        _filelch : string</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filelch</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filelch</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filelch</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">start</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1024</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">filestr</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">filestr</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1024</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">fileslab</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileslab</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">fileslab</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1024</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">filepalch</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">filepalch</span><span class="p">)</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">1024</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="n">filespa</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x00</span><span class="s">&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filespa</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">filespa</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Tx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Tx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ray_exist</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_num</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">node_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_num</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_phii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node_phid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge_length</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">edge_type</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s">&#39;float&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tail</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nstr</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deep</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_phii</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">node_phid</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">8</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge_length</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;d&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">stop</span>
            <span class="n">stop</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="mi">4</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">edge_type</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">stru</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s">&#39;i&#39;</span><span class="p">,</span> <span class="n">dt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Launch.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Launch.show.html#pylayers.simul.simulem.Launch.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">deepmax</span><span class="o">=</span><span class="mi">1</span> <span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; show ray launching until a given depth</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        L        : Layout</span>
<span class="sd">        deepmax  : display until deepmax (def=1)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig : pyplot figure descriptor</span>
<span class="sd">        ax  : pyplot Axes descriptor</span>

<span class="sd">        &quot;&quot;&quot;</span>
<span class="c">#        sl = SlabDB()</span>
<span class="c">#        sl.mat = MatDB()</span>
<span class="c">#        sl.mat.load(self.fileslab.replace(&#39;.slab&#39;, &#39;.mat&#39;))</span>
<span class="c">#        sl.load(self.fileslab)</span>
        <span class="c">#L      = Layout()</span>
        <span class="c">#L.sl   = sl</span>
        <span class="c">#G      = Graph(sl,filename=self.filestr)</span>
        <span class="c">#fig    = figure(facecolor=&#39;white&#39;)</span>
        <span class="c">#sp     = fig.add_subplot(111)</span>
        <span class="k">if</span> <span class="n">f</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">(</span><span class="n">fig</span> <span class="o">=</span> <span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">())</span>
        <span class="c">#indoor.display[&#39;Visu&#39;]=False</span>
        <span class="c">#indoor.display[&#39;alpha&#39;]=1.0</span>
        <span class="c">#indoor.display[&#39;Node&#39;]=True</span>
        <span class="c">#indoor.display[&#39;Edge&#39;]=True</span>
        <span class="c">#indoor.show(fig,sp)</span>

        <span class="n">Nseg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_num</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">ita</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tail</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">ihe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">sdeep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">deep</span><span class="p">[</span><span class="mi">1</span><span class="p">::]</span>
        <span class="n">usdeep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sdeep</span><span class="p">)</span>
        <span class="n">Mdeep</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">usdeep</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;scaled&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;off&#39;</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">usdeep</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">deepmax</span><span class="p">:</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">sdeep</span> <span class="o">==</span> <span class="n">k</span><span class="p">)</span>
                <span class="n">itak</span> <span class="o">=</span> <span class="n">ita</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">ihek</span> <span class="o">=</span> <span class="n">ihe</span><span class="p">[</span><span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">itak</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">itak</span><span class="p">]))</span>
                <span class="n">ph</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">ihek</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">ihek</span><span class="p">]))</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">displot</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">ph</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">Mdeep</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        pz   =  empty((2,))</span>
<span class="sd">        pn   = zeros((2,))</span>
<span class="sd">        for i in range(Nseg):</span>
<span class="sd">            pz = vstack((pz,pt[:,i],ph[:,i],pn))</span>
<span class="sd">            m1   = np.array([0,0,1])</span>
<span class="sd">                mask = np.kron(ones((2,Nseg)),m1)</span>
<span class="sd">                pzz  = pz[1:,:].T</span>
<span class="sd">                vertices = np.ma.masked_np.array(pzz,mask)</span>
<span class="sd">                plot(vertices[0,:],vertices[1,:],color=&#39;black&#39;)</span>
<span class="sd">                show()</span>


<span class="sd">        for i in range(self.node_num-1):</span>
<span class="sd">            ita = self.tail[i]-1</span>
<span class="sd">            ihe = self.head[i]-1</span>
<span class="sd">            xt = self.x[ita]</span>
<span class="sd">            yt = self.y[ita]</span>
<span class="sd">            xh = self.x[ihe]</span>
<span class="sd">            yh = self.y[ihe]</span>
<span class="sd">            plot([xt,xh],[yt,yh],color=&#39;black&#39;,linewidth=1)</span>

<span class="sd">        show()</span>
<span class="sd">        &quot;&quot;&quot;</span>



</div>
<span class="k">class</span> <span class="nc">Simul</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Simulation Class</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>

<span class="sd">    gui()</span>
<span class="sd">        graphical user interface</span>
<span class="sd">    choose()</span>
<span class="sd">        choose a simulation file in simuldir</span>
<span class="sd">    info()</span>
<span class="sd">        info about the simulation</span>
<span class="sd">    showray(itx,irx,iray)</span>
<span class="sd">        show a single ray</span>
<span class="sd">    help()</span>
<span class="sd">        help on using Simulation object</span>
<span class="sd">    structure2()</span>
<span class="sd">        get .str2 file (ASCII description structure)</span>
<span class="sd">    freq()</span>
<span class="sd">        return the frequency base</span>
<span class="sd">    getlaunch(k)</span>
<span class="sd">        return the launching tree kth Transmittter</span>
<span class="sd">    save()</span>
<span class="sd">        save Simulation file</span>
<span class="sd">    layout</span>
<span class="sd">        load a Layout file</span>
<span class="sd">    load()</span>
<span class="sd">        load Simulation</span>
<span class="sd">    show3()</span>
<span class="sd">        geomview vizualization</span>
<span class="sd">    show3l(itx,irx)</span>
<span class="sd">        geomview vizualization of link itx irx</span>
<span class="sd">    show()</span>
<span class="sd">        2D visualization of simulation with furniture</span>
<span class="sd">    launching()</span>
<span class="sd">        ray launching</span>
<span class="sd">    tracing(k)</span>
<span class="sd">        ray tracing</span>
<span class="sd">    tratotud(k,l)</span>
<span class="sd">        convert ray for tud</span>
<span class="sd">    field(l)</span>
<span class="sd">        evaluate field</span>
<span class="sd">    run(itx,irx)</span>
<span class="sd">        run simulation for links (itx,irx)</span>
<span class="sd">    cir(itx,irx,store_level=0,alpha=1.0)</span>
<span class="sd">        Channel Impulse Response calculation</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    fileconf</span>
<span class="sd">    filestr</span>
<span class="sd">    filemat</span>
<span class="sd">    fileslab</span>
<span class="sd">    filepalch</span>
<span class="sd">    filepatra</span>
<span class="sd">    filefreq</span>


<span class="sd">    filefield</span>
<span class="sd">    filetauk</span>
<span class="sd">    filetang</span>
<span class="sd">    filerang</span>

<span class="sd">    tx</span>
<span class="sd">    rx</span>

<span class="sd">    palch</span>
<span class="sd">    patra</span>
<span class="sd">    patud</span>
<span class="sd">    progress</span>

<span class="sd">    indoor</span>
<span class="sd">    mat</span>
<span class="sd">    sl</span>

<span class="sd">    Notes</span>
<span class="sd">    ------</span>

<span class="sd">    This class group together all the parametrization files of a simulation</span>

<span class="sd">    Directory list file :</span>

<span class="sd">        fileconf</span>

<span class="sd">    Constitutive parameters file :</span>

<span class="sd">        fileslab</span>
<span class="sd">        filemat</span>

<span class="sd">    Ray Tracing parameters files :</span>

<span class="sd">        filepalch</span>
<span class="sd">        filetra</span>

<span class="sd">    Frequency list file :</span>

<span class="sd">        filefreq</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Simul.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.__init__.html#pylayers.simul.simulem.Simul.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_filesimul</span><span class="o">=</span><span class="s">&#39;default.ini&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span> <span class="o">=</span> <span class="n">_filesimul</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drang</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c">#if os.path.isfile(pyu.getlong(_filesimul,&#39;ini&#39;)):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span> <span class="o">=</span> <span class="s">&quot;matDB.ini&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span> <span class="o">=</span> <span class="s">&quot;slabDB.ini&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filemat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span><span class="s">&#39;.mat&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileslab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span><span class="s">&#39;.slab&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slab</span><span class="o">=</span><span class="n">SlabDB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="s">&#39;defstr.str2&#39;</span>
        <span class="c">#</span>
        <span class="c"># Here was a nasty bug : Rule for the future</span>
        <span class="c">#    &quot;Always precise the key value of the passed argument&quot;</span>
        <span class="c">#</span>
        <span class="c"># Mal nommer les choses, c&#39;est ajouter au malheur du monde ( Albert Camus )</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">typ</span> <span class="o">=</span> <span class="s">&#39;tx&#39;</span><span class="p">,</span>
                            <span class="n">_fileini</span> <span class="o">=</span> <span class="s">&#39;radiotx.ini&#39;</span><span class="p">,</span>
                            <span class="n">_fileant</span> <span class="o">=</span> <span class="s">&#39;defant.vsh3&#39;</span><span class="p">,</span>
                            <span class="n">_filestr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                            <span class="n">typ</span> <span class="o">=</span> <span class="s">&#39;rx&#39;</span><span class="p">,</span>
                            <span class="n">_fileini</span> <span class="o">=</span> <span class="s">&#39;radiorx.ini&#39;</span><span class="p">,</span>
                            <span class="n">_fileant</span> <span class="o">=</span> <span class="s">&#39;defant.vsh3&#39;</span><span class="p">,</span>
                            <span class="n">_filestr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filepatra</span> <span class="o">=</span> <span class="s">&quot;def.patra&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span> <span class="o">=</span> <span class="s">&quot;def.palch&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span> <span class="o">=</span> <span class="s">&quot;def.freq&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patud</span> <span class="o">=</span> <span class="n">Patud</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">palch</span> <span class="o">=</span> <span class="n">Palch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patra</span> <span class="o">=</span> <span class="n">Patra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filepatra</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pafreq</span> <span class="o">=</span> <span class="n">Pafreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c"># simulation not loaded</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filelch</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filetra</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetud</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetang</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filerang</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetauk</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filefield</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">claunching</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctracing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctratotud</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span> <span class="o">=</span> <span class="s">&quot;project.conf&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfield</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c">#        self.freq = np.linspace(2, 11, 181, endpoint=True)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_filesimul</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">updcfg</span><span class="p">()</span>
        <span class="c">#self.load(self.filesimul)</span>

</div>
<div class="viewcode-block" id="Simul.gui"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.gui.html#pylayers.simul.simulem.Simul.gui">[docs]</a>    <span class="k">def</span> <span class="nf">gui</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; gui to modify the simulation file</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">simulgui</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="s">&#39;Simulation file&#39;</span><span class="p">,</span>
                                <span class="p">(</span><span class="s">&#39;filesimul&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;filestr&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;filefreq&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;filespaTx&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;filespaRx&#39;</span><span class="p">,</span>
                                 <span class="s">&#39;fileantTx&#39;</span>
                                 <span class="s">&#39;fileantRx&#39;</span><span class="p">),</span>
                                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">filespaTx</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">filespaRx</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">fileantTx</span><span class="p">,</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">fileantRx</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">simulgui</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filespaTx</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filespaRx</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileantTx</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileantRx</span> <span class="o">=</span> <span class="n">simulgui</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Simul.updcfg"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.updcfg.html#pylayers.simul.simulem.Simul.updcfg">[docs]</a>    <span class="k">def</span> <span class="nf">updcfg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; update simulation .ini config file with values currently in use.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;struc&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;conf&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;patra&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepatra</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;palch&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;txant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">fileant</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;rxant&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">fileant</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;tx&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">fileini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;rx&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">fileini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;mat&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;slab&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;purc&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">purc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;nrmax&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">nrmax</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;num&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">num</span><span class="p">))</span>

        <span class="c">#</span>
        <span class="c"># frequency section</span>
        <span class="c">#</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmin&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmax&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;nf&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)))</span>
        <span class="c">#</span>
        <span class="c"># waveform section</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;tw&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;twns&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;band&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;bandGHz&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;fc&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;fcGHz&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;thresh&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;threshdB&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;type&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;typ&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">,</span> <span class="s">&quot;fe&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="p">[</span><span class="s">&#39;feGHz&#39;</span><span class="p">]))</span>
        <span class="c">#</span>
        <span class="c"># output section</span>
        <span class="c">#</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

        <span class="c"># Initialize waveform</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">()</span>
        <span class="c"># Update waveform </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Simul.clean"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.clean.html#pylayers.simul.simulem.Simul.clean">[docs]</a>    <span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; clean</span>

<span class="sd">       Notes</span>
<span class="sd">       -----</span>
<span class="sd">       obsolete</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            level  = 1</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelch</span><span class="p">[</span><span class="n">itx</span><span class="p">],</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
                <span class="k">print</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">irx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span>
                                           <span class="n">pstruc</span><span class="p">([</span><span class="s">&#39;DIRTRA&#39;</span><span class="p">]))</span>
                    <span class="k">print</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">irx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
                    <span class="k">print</span> <span class="n">filename</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetauk</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span><span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
                    <span class="k">print</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">level</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">irx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
                    <span class="k">print</span> <span class="n">filename</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filerang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
                    <span class="k">print</span> <span class="n">filename</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filefield</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
                    <span class="k">print</span> <span class="n">filename</span>

</div>
<div class="viewcode-block" id="Simul.clean_project"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.clean_project.html#pylayers.simul.simulem.Simul.clean_project">[docs]</a>    <span class="k">def</span> <span class="nf">clean_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Clean Pyrpoject directory</span>

<span class="sd">        remove .lch, .tra, .field .tud, .tauk, .tang, .rang, &lt;pyproject&gt;/output</span>

<span class="sd">        remove [output] entries into .ini of self.filesimul</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd"> </span>
<span class="sd">        verbose : boolean</span>
<span class="sd">            Verbose mode on/off</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            Boolean:</span>
<span class="sd">                True if the project has been cleaned, False otherwise</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>

            <span class="k">print</span> <span class="s">&quot;-----------------------------------&quot;</span>
            <span class="k">print</span> <span class="s">&quot;-----------------------------------&quot;</span>
            <span class="k">print</span> <span class="s">&quot;          WARNING                  &quot;</span>
            <span class="k">print</span> <span class="s">&quot;-----------------------------------&quot;</span>
            <span class="k">print</span> <span class="s">&quot;-----------------------------------&quot;</span>
            <span class="k">print</span> <span class="s">&quot;You are about to remove ALL previous computed raytracing files.&quot;</span>
            <span class="k">print</span> <span class="s">&quot;If you decide to remove it, you will need to restart the entire </span><span class="se">\</span>
<span class="s">    raytracing simulation to exploit simulation results&quot;</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s"> Do you want to remove these simulation files ? y/n&quot;</span>
            <span class="n">r</span><span class="o">=</span><span class="nb">raw_input</span><span class="p">()</span>

        <span class="k">else</span> <span class="p">:</span>
            <span class="n">r</span> <span class="o">==</span><span class="s">&#39;y&#39;</span>

        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="s">&#39;y&#39;</span><span class="p">:</span>
            <span class="n">inifile</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s">&#39;BASENAME&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s">&#39;Error : there is no project  directory in $BASENAME&#39;</span><span class="p">)</span>



            <span class="n">dirlist</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;output&#39;</span><span class="p">]</span>
            <span class="n">extension</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;.lch&#39;</span><span class="p">,</span><span class="s">&#39;.field&#39;</span><span class="p">,</span><span class="s">&#39;.tra&#39;</span><span class="p">,</span><span class="s">&#39;.tud&#39;</span><span class="p">,</span><span class="s">&#39;.tang&#39;</span><span class="p">,</span><span class="s">&#39;.rang&#39;</span><span class="p">,</span><span class="s">&#39;.tauk&#39;</span><span class="p">]</span>
            <span class="n">rindic</span><span class="o">=</span><span class="bp">False</span>


            <span class="c"># remove file</span>

            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dirlist</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">extension</span><span class="p">:</span>
                    <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span><span class="s">&#39;/&#39;</span> <span class="o">+</span><span class="n">d</span> <span class="p">)</span>
                    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">f</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ex</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                            <span class="n">rindic</span><span class="o">=</span><span class="bp">True</span>
                            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                                <span class="k">print</span> <span class="n">f</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">d</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">f</span><span class="p">)</span>



                    <span class="k">if</span> <span class="n">rindic</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                            <span class="k">print</span> <span class="s">&#39;removed *&#39;</span> <span class="o">+</span> <span class="n">ex</span> <span class="o">+</span><span class="s">&#39; from &#39;</span> <span class="o">+</span><span class="n">d</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                        <span class="n">rindic</span><span class="o">=</span><span class="bp">False</span>


            <span class="c"># remove output into the self.filesimul ini file</span>

            <span class="n">simcfg</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
            <span class="n">simcfg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">inifile</span><span class="p">,</span><span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRSIMUL&#39;</span><span class="p">]))</span>
            <span class="n">simcfg</span><span class="o">.</span><span class="n">remove_section</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">inifile</span><span class="p">,</span><span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRSIMUL&#39;</span><span class="p">]),</span><span class="s">&#39;wb&#39;</span><span class="p">)</span>
            <span class="n">simcfg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dout</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">drang</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&#39;removed [output] entries into &#39;</span> <span class="o">+</span><span class="n">inifile</span> <span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                <span class="k">print</span> <span class="s">&#39;Project CLEANED&#39;</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;clean project process ABORTED&quot;</span>
            <span class="k">return</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="Simul.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.save.html#pylayers.simul.simulem.Simul.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; save simulation file</span>

<span class="sd">        Simulation files are .ini files which are saved in a dedicated</span>
<span class="sd">        directory basename/ini in the Project tree</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filesimul</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="p">,</span> <span class="s">&quot;ini&quot;</span><span class="p">)</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filesimul</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="c"># getting current spa file if any</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;tx&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">fileini</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;rx&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">fileini</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c"># save tx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="c"># save rx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="c"># save slab and mat file</span>
        <span class="c"># --</span>
        <span class="c"># self.slab.save(self.fileslabini)</span>
        <span class="c"># self.slab.mat.save(self.filematini)</span>
        <span class="c"># --</span>
        <span class="c"># fix bug #189</span>
        <span class="c">#   slab is a member of S.L not of S anymore</span>
        <span class="c">#   mat is a member of S.L.sl not of S.slab</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">sl</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">sl</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

<span class="c">#    def saveold(self):</span>
<span class="c">#        &quot;&quot;&quot; save simulation file</span>

<span class="c">#        &quot;&quot;&quot;</span>
<span class="c">#        filesimul = pyu.getlong(self.filesimul, &quot;ini&quot;)</span>
<span class="c">#        fd = open(filesimul, &quot;w&quot;)</span>
<span class="c">#        config = ConfigParser.ConfigParser()</span>

<span class="c">#        #</span>
<span class="c">#        # files section</span>
<span class="c">#        #</span>
<span class="c">#        #config.add_section(&quot;files&quot;)</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;conf&quot;, self.fileconf)</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;struc&quot;, self.filestr)</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;slab&quot;, self.fileslab)</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;mat&quot;, self.filemat)</span>

<span class="c">#        try:</span>
<span class="c">#            self.config.set(&quot;files&quot;, &quot;tx&quot;, self.tx.filespa)</span>
<span class="c">#        except:</span>
<span class="c">#            pass</span>
<span class="c">#        try:</span>
<span class="c">#            self.config.set(&quot;files&quot;, &quot;rx&quot;, self.rx.filespa)</span>
<span class="c">#        except:</span>
<span class="c">#            pass</span>
<span class="c">#        try:</span>
<span class="c">#            self.config.set(&quot;files&quot;, &quot;txant&quot;, self.tx.fileant)</span>
<span class="c">#        except:</span>
<span class="c">#            pass</span>
<span class="c">#        try:</span>
<span class="c">#            self.config.set(&quot;files&quot;, &quot;rxant&quot;, self.rx.fileant)</span>
<span class="c">#        except:</span>
<span class="c">#            pass</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;patra&quot;, self.filepatra)</span>
<span class="c">#        self.config.set(&quot;files&quot;, &quot;palch&quot;, self.filepalch)</span>
<span class="c">#        self.palch.save()</span>
<span class="c">#        self.patra.save()</span>

<span class="c">#        #</span>
<span class="c">#        # tud section</span>
<span class="c">#        #</span>

<span class="c">#        self.config.set(&quot;tud&quot;, &quot;purc&quot;, self.patud.purc)</span>
<span class="c">#        self.config.set(&quot;tud&quot;, &quot;nrmax&quot;, self.patud.nrmax)</span>
<span class="c">#        self.config.set(&quot;tud&quot;, &quot;num&quot;, self.patud.num)</span>

<span class="c">#        #</span>
<span class="c">#        # frequency section</span>
<span class="c">#        #</span>
<span class="c">#        self.config.set(&quot;frequency&quot;, &quot;fghzmin&quot;, self.freq[0])</span>
<span class="c">#        self.config.set(&quot;frequency&quot;, &quot;fghzmax&quot;, self.freq[-1])</span>
<span class="c">#        self.config.set(&quot;frequency&quot;, &quot;Nf&quot;, len(self.freq))</span>

<span class="c">#        #</span>
<span class="c">#        # output section</span>
<span class="c">#        #</span>
<span class="c">#        #filelch exists</span>
<span class="c">#        if self.progress &gt; 0:</span>
<span class="c">#            #config.add_section(&quot;output&quot;)</span>
<span class="c">#            for k in range(len(self.filelch)):</span>
<span class="c">#                _fileout = &quot;out&quot; + &quot;???&quot;</span>
<span class="c">#                filename = self.filelch[k]</span>
<span class="c">#                self.config.set(&quot;launch&quot;, str(k + 1), filename)</span>

<span class="c">#        # filetra exists</span>
<span class="c">#        for k in range(len(self.filelch)):</span>
<span class="c">#            if self.progress &gt; 1:</span>
<span class="c">#                #self.config.add_section(&quot;trace&quot;)</span>
<span class="c">#                for l in arange(len(self.filetra[k])):</span>
<span class="c">#                    filename = self.filetra[k][l]</span>
<span class="c">#                    self.config.set(&quot;trace&quot;, &quot;rx&quot; + str(l + 1), filename)</span>

<span class="c">#        # .tang exists</span>
<span class="c">#        # .rang exists</span>
<span class="c">#        # .tud exists</span>
<span class="c">#            if self.progress &gt; 2:</span>
<span class="c">#                #config.add_section(&quot;tud&quot;)</span>
<span class="c">#                #config.add_section(&quot;tang&quot;)</span>
<span class="c">#                #config.add_section(&quot;rang&quot;)</span>

<span class="c">#                for l in arange(len(self.filetud[k])):</span>
<span class="c">#                    ftud = self.filetud[k][l]</span>
<span class="c">#                    self.config.set(&quot;tud&quot;, &quot;rx&quot; + str(l + 1), ftud)</span>

<span class="c">#                for l in arange(len(self.filetang[k])):</span>
<span class="c">#                    ftang = self.filetang[k][l]</span>
<span class="c">#                    self.config.set(&quot;tang&quot;, &quot;rx&quot; + str(l + 1), ftang)</span>

<span class="c">#                for l in arange(len(self.filerang[k])):</span>
<span class="c">#                    frang = self.filerang[k][l]</span>
<span class="c">#                    self.config.set(&quot;rang&quot;, &quot;rx&quot; + str(l + 1), frang)</span>

<span class="c">#        # .field exist</span>
<span class="c">#        # .tauk exist</span>
<span class="c">#            if self.progress &gt; 3:</span>
<span class="c">#                #config.add_section(&quot;tauk&quot;)</span>
<span class="c">#                #config.add_section(&quot;field&quot;)</span>
<span class="c">#                for l in arange(len(self.filetud[k])):</span>
<span class="c">#                    ftauk = self.filetud[k][l]</span>
<span class="c">#                    self.config.set(&quot;tauk&quot;, &quot;rx&quot; + str(l + 1), ftauk)</span>

<span class="c">#                for l in arange(len(self.filefield[k])):</span>
<span class="c">#                    ffield = self.filefield[k][l]</span>
<span class="c">#                    self.config.set(&quot;field&quot;, &quot;rx&quot; + str(l + 1), ffield)</span>

<span class="c">#        self.config.write(fd)</span>
<span class="c">#        fd.close()</span>
</div>
<div class="viewcode-block" id="Simul.save_project"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.save_project.html#pylayers.simul.simulem.Simul.save_project">[docs]</a>    <span class="k">def</span> <span class="nf">save_project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; save Simulation files in a zipfile</span>

<span class="sd">        Simulation files are .ini files which are saved in a dedicated</span>
<span class="sd">        directory basename/ini in the Project tree</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">Tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">zipfileName</span> <span class="o">=</span> <span class="n">tkFileDialog</span><span class="o">.</span><span class="n">asksaveasfilename</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
                            <span class="n">filetypes</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;zipped file&quot;</span><span class="p">,</span><span class="s">&quot;zip&quot;</span><span class="p">)]</span> <span class="p">,</span>
                            <span class="n">title</span><span class="o">=</span><span class="s">&quot;Save Project&quot;</span><span class="p">,</span>
                            <span class="p">)</span>
        <span class="n">pyu</span><span class="o">.</span><span class="n">zipd</span><span class="p">(</span><span class="n">basename</span><span class="p">,</span><span class="n">zipfileName</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="k">print</span> <span class="s">&quot;Current project saved in&quot;</span><span class="p">,</span> <span class="n">zipfileName</span>
</div>
<div class="viewcode-block" id="Simul.load_project"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.load_project.html#pylayers.simul.simulem.Simul.load_project">[docs]</a>    <span class="k">def</span> <span class="nf">load_project</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; load Simulation files from a zipfile</span>

<span class="sd">        Simulation files are .ini files which are saved in a dedicated</span>
<span class="sd">        directory basename/ini in the Project tree</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">Tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">zipfileName</span><span class="o">=</span> <span class="n">tkFileDialog</span><span class="o">.</span><span class="n">askopenfile</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
                                            <span class="n">mode</span><span class="o">=</span><span class="s">&#39;rb&#39;</span><span class="p">,</span>
                                            <span class="n">title</span><span class="o">=</span><span class="s">&#39;Choose a project&#39;</span><span class="p">)</span>
        <span class="n">dirname</span> <span class="o">=</span> <span class="n">tkFileDialog</span><span class="o">.</span><span class="n">askdirectory</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">root</span><span class="p">,</span>
                                    <span class="n">initialdir</span><span class="o">=</span><span class="n">basename</span><span class="p">,</span>
                                    <span class="n">title</span><span class="o">=</span><span class="s">&#39;Please select a directory&#39;</span><span class="p">,</span>
                                    <span class="n">mustexist</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">pyu</span><span class="o">.</span><span class="n">unzipd</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span><span class="n">zipfileName</span><span class="p">)</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
        <span class="k">print</span> <span class="s">&quot;Current project loaded in&quot;</span><span class="p">,</span> <span class="n">dirname</span>
</div>
<div class="viewcode-block" id="Simul.choose"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.choose.html#pylayers.simul.simulem.Simul.choose">[docs]</a>    <span class="k">def</span> <span class="nf">choose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Choose a simulation file in simuldir</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">tkFileDialog</span> <span class="kn">as</span> <span class="nn">FD</span>
        <span class="n">fichsimul</span> <span class="o">=</span> <span class="n">FD</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s">&quot;Fichiers simul &quot;</span><span class="p">,</span>
                                                   <span class="s">&quot;*.simul&quot;</span><span class="p">),</span>
                                                  <span class="p">(</span><span class="s">&quot;All&quot;</span><span class="p">,</span> <span class="s">&quot;*&quot;</span><span class="p">)],</span>
                                       <span class="n">title</span><span class="o">=</span><span class="s">&quot;Please choose a simulation file&quot;</span><span class="p">,</span>
                                       <span class="n">initialdir</span><span class="o">=</span><span class="n">simuldir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">fichsimul</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Simul.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.load.html#pylayers.simul.simulem.Simul.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_filesimul</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; load a simulation configuration file</span>

<span class="sd">         each transmiter simulation results in the creation of an .ini file</span>
<span class="sd">         with the following sections</span>
<span class="sd">         related to the results obtained for different receivers</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _filesimul   : file in the simul directory of the Project</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span> <span class="o">=</span> <span class="n">_filesimul</span>
        <span class="n">filesimul</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="p">,</span> <span class="s">&quot;ini&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filesimul</span><span class="p">)</span>

        <span class="n">sections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_filetx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;tx&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section tx from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">_filerx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;rx&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section rx from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>


        <span class="k">try</span><span class="p">:</span>
            <span class="n">_fileanttx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;txant&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section txant from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
           <span class="n">_fileantrx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;rxant&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section rxant from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;struc&quot;</span><span class="p">)</span>
            <span class="c"># force .str extension</span>
            <span class="n">f</span><span class="p">,</span><span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="n">f</span><span class="o">+</span><span class="s">&#39;.str&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section struc from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                                <span class="n">typ</span> <span class="o">=</span> <span class="s">&#39;tx&#39;</span><span class="p">,</span>
                                <span class="n">_fileini</span> <span class="o">=</span> <span class="n">_filetx</span><span class="p">,</span>
                                <span class="n">_fileant</span> <span class="o">=</span> <span class="n">_fileanttx</span><span class="p">,</span>
                                <span class="n">_filestr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">rx</span> <span class="o">=</span> <span class="n">RadioNode</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                                <span class="n">typ</span> <span class="o">=</span> <span class="s">&#39;rx&#39;</span><span class="p">,</span>
                                <span class="n">_fileini</span> <span class="o">=</span> <span class="n">_filerx</span><span class="p">,</span>
                                <span class="n">_fileant</span> <span class="o">=</span> <span class="n">_fileantrx</span><span class="p">,</span>
                                <span class="n">_filestr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error during Radionode load&#39;</span><span class="p">)</span>
<span class="c">#</span>
<span class="c"># Launching and Tracing parameters</span>
<span class="c">#</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">palch</span> <span class="o">=</span> <span class="n">Palch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;palch&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;palch&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section palch from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patra</span> <span class="o">=</span> <span class="n">Patra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;patra&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filepatra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;patra&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section patra from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>
        <span class="c">#_outfilename = &quot;out&quot;+self.ntx+&quot;.ini&quot;</span>
        <span class="c">#self.outfilename = pyu.getlong(_outfilename,&quot;simul&quot;)</span>
<span class="c">#  Load Simulation Mat File</span>
<span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;mat&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">)</span>
<span class="c">#</span>
<span class="c">#  Load Simulation Slab File</span>
<span class="c">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;slab&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sl</span> <span class="o">=</span> <span class="n">SlabDB</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Slab load error&#39;</span><span class="p">)</span>
<span class="c">#</span>
<span class="c"># Load layout from .str or .str2 file</span>
<span class="c">#</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>
<span class="c">#            self.L.load(self.filestr)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Layout load error&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">nrmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;nrmax&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;num&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">patud</span><span class="o">.</span><span class="n">purc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;purc&quot;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

<span class="c">#</span>
<span class="c"># Frequency base</span>
<span class="c">#</span>
        <span class="k">if</span> <span class="s">&quot;frequency&quot;</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmin&quot;</span><span class="p">)),</span>
                                        <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getfloat</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmax&quot;</span><span class="p">)),</span>
                                        <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">getint</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;nf&quot;</span><span class="p">)),</span>
                                        <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;Error in section frequency from &#39;</span><span class="o">+</span> <span class="n">_filesimul</span><span class="p">)</span>
            <span class="c"># update .freq file in tud directory</span>

            <span class="n">filefreq</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filefreq</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">chaine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmin&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;fghzmax&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;frequency&quot;</span><span class="p">,</span> <span class="s">&quot;nf&quot;</span><span class="p">)</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">close</span>
<span class="c">#</span>
<span class="c"># Simulation Progress</span>
<span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="s">&quot;output&quot;</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">itx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">):</span>
                <span class="n">_filename</span>  <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">,</span> <span class="n">itx</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="n">_filename</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="s">&quot;output&quot;</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
                <span class="n">output</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="n">secout</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">if</span> <span class="s">&quot;launch&quot;</span> <span class="ow">in</span> <span class="n">secout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">keys_launch</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;launch&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kl</span> <span class="ow">in</span> <span class="n">keys_launch</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">kl</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;launch&quot;</span><span class="p">,</span> <span class="n">kl</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&quot;trace&quot;</span> <span class="ow">in</span> <span class="n">secout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">2</span>
                    <span class="n">keys_tra</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;trace&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kt</span> <span class="ow">in</span> <span class="n">keys_tra</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;trace&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>

                <span class="k">if</span> <span class="s">&quot;tang&quot;</span> <span class="ow">in</span> <span class="n">secout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">3</span>
                    <span class="n">keys_tang</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;tang&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kt</span> <span class="ow">in</span> <span class="n">keys_tang</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tang&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;rang&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&quot;field&quot;</span> <span class="ow">in</span> <span class="n">secout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">4</span>
                    <span class="n">keys_field</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;field&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kt</span> <span class="ow">in</span> <span class="n">keys_field</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                            <span class="s">&quot;field&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tauk&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&quot;cir&quot;</span> <span class="ow">in</span> <span class="n">secout</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">5</span>
                    <span class="n">keys_cir</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="s">&quot;cir&quot;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">kt</span> <span class="ow">in</span> <span class="n">keys_cir</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)][</span><span class="nb">int</span><span class="p">(</span><span class="n">kt</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;cir&quot;</span><span class="p">,</span> <span class="n">kt</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">itx</span><span class="p">)]</span> <span class="o">=</span> <span class="n">output</span>
        <span class="c">#</span>
        <span class="c"># Waveform section</span>
        <span class="c">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.layout"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.layout.html#pylayers.simul.simulem.Simul.layout">[docs]</a>    <span class="k">def</span> <span class="nf">layout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_filestruc</span><span class="p">,</span> <span class="n">_filematini</span><span class="o">=</span><span class="s">&#39;matDB.ini&#39;</span><span class="p">,</span> <span class="n">_fileslabini</span><span class="o">=</span><span class="s">&#39;slabDB.ini&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; load a layout in the simulation oject</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _filestruc : string</span>
<span class="sd">            short file name of the Layout object</span>
<span class="sd">        _filematini   : string</span>
<span class="sd">            short file name of the Mat object  (default matDB.ini)</span>
<span class="sd">        _fileslab  : string</span>
<span class="sd">            short file name of the Slab object (default slabDB.ini)</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">        &gt;&gt;&gt; S = Simul()</span>
<span class="sd">        &gt;&gt;&gt; S.layout(&#39;defstr.str&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">=</span> <span class="n">_filestruc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span> <span class="o">=</span> <span class="n">_filematini</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span> <span class="o">=</span> <span class="n">_fileslabini</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">Layout</span><span class="p">(</span><span class="n">_filestruc</span><span class="p">,</span><span class="n">_filematini</span><span class="p">,</span> <span class="n">_fileslabini</span><span class="p">)</span>
        <span class="c"># update config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;struc&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;slab&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslabini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;files&quot;</span><span class="p">,</span> <span class="s">&quot;mat&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filematini</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Simul.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.show.html#pylayers.simul.simulem.Simul.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">irx</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">furniture</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">traj</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="p">[],</span><span class="n">ax</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; show simulation</span>

<span class="sd">            Parameters</span>
<span class="sd">            -----------</span>
<span class="sd">            itx        : list of tx indexes</span>
<span class="sd">            irx        : list of rx indexes</span>
<span class="sd">            furniture  : boolean for METALIC furniture display</span>
<span class="sd">            s          : scale fir scatter plot  (default 8)</span>
<span class="sd">            c          : color for scatter plot  (default &#39;b&#39;)</span>
<span class="sd">            traj       : boolean  (def False)</span>
<span class="sd">            num        : boolean  (def False)</span>
<span class="sd">                display a number</span>


<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">            &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">            &gt;&gt;&gt; S = Simul()</span>
<span class="sd">            &gt;&gt;&gt; S.load(&#39;w1.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; S.L.loadfur(&#39;FurW1.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; S.show()</span>
<span class="sd">            &gt;&gt;&gt; plt.show()</span>



<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">itx</span> <span class="o">=</span> <span class="p">[</span><span class="n">itx</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">irx</span> <span class="o">=</span> <span class="p">[</span><span class="n">irx</span><span class="p">]</span>


        <span class="k">if</span> <span class="n">fig</span> <span class="o">==</span><span class="p">[]:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">ax</span><span class="o">==</span><span class="p">[]:</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="c">#self.L.display[&#39;scaled&#39;]=False</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c">#</span>
        <span class="k">if</span> <span class="n">furniture</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;lfur&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">fur</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">lfur</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">fur</span><span class="o">.</span><span class="n">Matname</span> <span class="o">==</span> <span class="s">&#39;METAL&#39;</span><span class="p">:</span>
                        <span class="n">fur</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;Warning : no furniture file loaded&quot;</span>

        <span class="k">if</span> <span class="n">irx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="c">#ax.scatter(self.rx.position[0,0],self.rx.position[0,1],c=&#39;k&#39;,s=s,linewidth=0)</span>
            <span class="c">#ax.scatter(self.rx.position[1,0],self.rx.position[1,1],c=&#39;b&#39;,s=s,linewidth=0)</span>
            <span class="c">#ax.scatter(self.rx.position[2,0],self.rx.position[2,1],c=&#39;g&#39;,s=s,linewidth=0)</span>
            <span class="c">#ax.scatter(self.rx.position[3,0],self.rx.position[3,1],c=&#39;c&#39;,s=s,linewidth=0)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">irx</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">itx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">302</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">traj</span><span class="p">:</span>
                <span class="n">cpt</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">itx</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                           <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">traj</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">cpt</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>
                        <span class="n">cpt</span> <span class="o">=</span> <span class="n">cpt</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="p">)</span>
        <span class="c">#for k in range(self.tx.N):</span>
        <span class="c">#    ax.text(self.tx.position[0,k],self.tx.position[1,k],str(k+1),color=&#39;black&#39;)</span>
        <span class="c">#    ax.scatter(self.tx.position[0,:],self.tx.position[0,:],</span>

        <span class="c">#for k in range(self.rx.N):</span>
        <span class="c">#   ax.text(self.rx.position[0,k],self.rx.position[1,k],str(k),color=&#39;black&#39;)</span>
</div>
<div class="viewcode-block" id="Simul.PL"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.PL.html#pylayers.simul.simulem.Simul.PL">[docs]</a>    <span class="k">def</span> <span class="nf">PL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; plot Path Loss</span>

<span class="sd">        itx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">td</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tEa</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tEo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span>
            <span class="n">cira</span><span class="p">,</span> <span class="n">ciro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loadcir</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">)</span>
            <span class="n">Ea</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">energy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Eo</span> <span class="o">=</span> <span class="n">ciro</span><span class="o">.</span><span class="n">energy</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">td</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">tEa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Ea</span><span class="p">)</span>
            <span class="n">tEo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Eo</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tEa</span><span class="p">),</span> <span class="s">&#39;xr&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">td</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tEo</span><span class="p">),</span> <span class="s">&#39;xb&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">td</span><span class="p">,</span> <span class="n">tEa</span><span class="p">,</span> <span class="n">tEo</span>
</div>
<div class="viewcode-block" id="Simul.evalcir"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.evalcir.html#pylayers.simul.simulem.Simul.evalcir">[docs]</a>    <span class="k">def</span> <span class="nf">evalcir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">algo</span><span class="o">=</span><span class="s">&#39;new&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        S</span>
<span class="sd">        tx</span>
<span class="sd">        rx</span>
<span class="sd">        wav</span>
<span class="sd">        cutoff</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">crxp</span> <span class="o">=-</span><span class="mi">1</span>
        <span class="n">ctxp</span> <span class="o">=-</span><span class="mi">1</span>
        <span class="n">tcir</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span>
        <span class="n">Ntx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span>
        <span class="n">Nrx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rx</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c">#for kt in range(1,Ntx-1):</span>
        <span class="c">#print kt+1</span>
        <span class="n">kt</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">tcir</span><span class="p">[</span><span class="n">kt</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">kt</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">kt</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">kt</span><span class="p">]])</span>
        <span class="k">for</span> <span class="n">kr</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nrx</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">):</span>
                <span class="k">print</span> <span class="n">kr</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">kr</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">kr</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="n">kr</span><span class="p">]])</span>
            <span class="n">ctx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">crx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="o">&lt;&gt;</span><span class="n">ctxp</span><span class="p">)</span><span class="o">|</span><span class="p">(</span><span class="n">crx</span><span class="o">&lt;&gt;</span><span class="n">crxp</span><span class="p">):</span>
                <span class="n">Si</span>  <span class="o">=</span> <span class="n">signature</span><span class="o">.</span><span class="n">Signatures</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">)</span>
                <span class="n">ctxp</span> <span class="o">=</span> <span class="n">ctx</span>
                <span class="n">crxp</span> <span class="o">=</span> <span class="n">crx</span>
                <span class="n">Si</span><span class="o">.</span><span class="n">run4</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span><span class="n">algo</span><span class="o">=</span><span class="n">algo</span><span class="p">)</span>
            <span class="n">r2d</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
            <span class="c">#r2d.show(S.L)</span>

            <span class="n">r3d</span> <span class="o">=</span> <span class="n">r2d</span><span class="o">.</span><span class="n">to3D</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="n">r3d</span><span class="o">.</span><span class="n">locbas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="n">r3d</span><span class="o">.</span><span class="n">fillinter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="n">Ct</span>  <span class="o">=</span> <span class="n">r3d</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span>
            <span class="n">sca</span> <span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
            <span class="n">cir</span> <span class="o">=</span> <span class="n">sca</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
            <span class="n">tcir</span><span class="p">[</span><span class="n">kt</span><span class="p">][</span><span class="n">kr</span><span class="p">]</span> <span class="o">=</span> <span class="n">cir</span>
        <span class="k">return</span><span class="p">(</span><span class="n">tcir</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.loadcir"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.loadcir.html#pylayers.simul.simulem.Simul.loadcir">[docs]</a>    <span class="k">def</span> <span class="nf">loadcir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        itx : Tx index</span>
<span class="sd">        irx : Rx index</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        cir(itx,irx)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_filecir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.mat&#39;</span>
        <span class="n">ext</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s">&#39;00&#39;</span> <span class="o">+</span> <span class="n">ext</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ext</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="s">&#39;0&#39;</span> <span class="o">+</span> <span class="n">ext</span>

        <span class="n">filecir</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filecir</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRCIR&#39;</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;/Tx&#39;</span> <span class="o">+</span> <span class="n">ext</span><span class="p">)</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">filecir</span><span class="p">)</span>

        <span class="n">kxa</span> <span class="o">=</span> <span class="s">&#39;ta&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>
        <span class="n">kya</span> <span class="o">=</span> <span class="s">&#39;cira&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>

        <span class="n">kxo</span> <span class="o">=</span> <span class="s">&#39;to&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>
        <span class="n">kyo</span> <span class="o">=</span> <span class="s">&#39;ciro&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>

        <span class="n">cira</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">TUsignal</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">kxa</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="n">kya</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">ciro</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">TUsignal</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">kxo</span><span class="p">],</span> <span class="n">D</span><span class="p">[</span><span class="n">kyo</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span><span class="p">(</span><span class="n">cira</span><span class="p">,</span> <span class="n">ciro</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.pltcir"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.pltcir.html#pylayers.simul.simulem.Simul.pltcir">[docs]</a>    <span class="k">def</span> <span class="nf">pltcir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">irx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s">&#39;linear&#39;</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="p">[],</span><span class="n">ax</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; plot Channel Impulse Response</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        itx : Tx index</span>
<span class="sd">        irx : Rx index</span>
<span class="sd">        mode : str</span>
<span class="sd">            {&#39;linear&#39;,&#39;dB&#39;}</span>
<span class="sd">            noise : boolean</span>
<span class="sd">        color : string</span>
<span class="sd">            default &#39;b&#39;</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">        &gt;&gt;&gt; S = Simul()</span>
<span class="sd">        &gt;&gt;&gt; S.load(&#39;where2.ini&#39;)</span>
<span class="sd">        &gt;&gt;&gt; S.run(1,1)</span>
<span class="sd">        &gt;&gt;&gt; S.pltcir(1,1,mode=&#39;linear&#39;,noise=False,color=&#39;k&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">fig</span> <span class="o">==</span><span class="p">[]:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="c">#if ax==[]:</span>
        <span class="c">#    ax = fig.gca()</span>

        <span class="n">_filecir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.mat&#39;</span>
        <span class="n">filecir</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filecir</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRCIR&#39;</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;/Tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.3d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">itx</span><span class="p">))</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">spio</span><span class="o">.</span><span class="n">loadmat</span><span class="p">(</span><span class="n">filecir</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s">&#39;211&#39;</span><span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="s">&#39;212&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">format</span> <span class="p">:</span>
            <span class="n">kxa</span> <span class="o">=</span> <span class="s">&#39;t&#39;</span>
            <span class="n">kya</span> <span class="o">=</span> <span class="s">&#39;cir&#39;</span>
            <span class="n">ta</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">kxa</span><span class="p">]</span>
            <span class="n">Tobs</span> <span class="o">=</span> <span class="n">ta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">te</span> <span class="o">=</span> <span class="n">ta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">ta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">noise</span><span class="p">:</span>
                <span class="n">na</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">Noise</span><span class="p">(</span><span class="n">Tobs</span> <span class="o">+</span> <span class="n">te</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">te</span><span class="p">)</span>
                <span class="n">naf</span> <span class="o">=</span> <span class="n">na</span><span class="o">.</span><span class="n">gating</span><span class="p">(</span><span class="mf">4.493</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">cira</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">TUsignal</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">kya</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>


        <span class="k">if</span> <span class="s">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
            <span class="n">kxo</span> <span class="o">=</span> <span class="s">&#39;to&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>
            <span class="n">kyo</span> <span class="o">=</span> <span class="s">&#39;ciro&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>
            <span class="n">to</span> <span class="o">=</span> <span class="n">D</span><span class="p">[</span><span class="n">kxo</span><span class="p">]</span>
            <span class="n">Tobs</span> <span class="o">=</span> <span class="n">to</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">te</span> <span class="o">=</span> <span class="n">to</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">to</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">noise</span><span class="p">:</span>
                <span class="n">no</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">Noise</span><span class="p">(</span><span class="n">Tobs</span> <span class="o">+</span> <span class="n">te</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">te</span><span class="p">)</span>
                <span class="n">nof</span> <span class="o">=</span> <span class="n">no</span><span class="o">.</span><span class="n">gating</span><span class="p">(</span><span class="mf">4.493</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ciro</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">TUsignal</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">kyo</span><span class="p">][:,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s">&#39;linear&#39;</span><span class="p">:</span>
            <span class="c">#plt.plot(ta,naf.y,color=&#39;k&#39;,label=&#39;Noise&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="n">D</span><span class="p">[</span><span class="n">kya</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Rx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (ns)&#39;</span><span class="p">)</span>

            <span class="sd">&#39;&#39;&#39;if noise:</span>
<span class="sd">                naf.plot(col=&#39;k&#39;)</span>
<span class="sd">            cira.plot(col=color)&#39;&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39;if noise:</span>
<span class="sd">                naf.plotdB(col=&#39;k&#39;)</span>
<span class="sd">            cira.plotdB()&#39;&#39;&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ta</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">kya</span><span class="p">])),</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;Rx &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;Time (ns)&#39;</span><span class="p">)</span>
<span class="c">#        plt.legend()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="c">#plt.savefig(&#39;Tx&#39;+str(itx),format=pdf,dpi=300)</span>
</div>
<div class="viewcode-block" id="Simul.scatter"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.scatter.html#pylayers.simul.simulem.Simul.scatter">[docs]</a>    <span class="k">def</span> <span class="nf">scatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gray</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
                <span class="n">spl</span><span class="o">=</span><span class="mi">221</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span>
                <span class="n">vaxis</span><span class="o">=</span><span class="p">((</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">18</span><span class="p">)),</span>
                <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">colbool</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                <span class="n">cblabel</span><span class="o">=</span><span class="s">&#39;dB&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>

<span class="sd">            itx</span>
<span class="sd">            irx</span>
<span class="sd">            values</span>
<span class="sd">            cmap</span>
<span class="sd">            s</span>
<span class="sd">            spl</span>
<span class="sd">            title</span>
<span class="sd">            vaxis</span>
<span class="sd">            vmin</span>
<span class="sd">            vmax</span>
<span class="sd">            colbool</span>
<span class="sd">            clabel</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spl</span><span class="p">)</span>
        <span class="n">xtx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">itx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">ytx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">itx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">xrx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">irx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">yrx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="n">irx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">furk</span> <span class="ow">in</span> <span class="n">siradel</span><span class="o">.</span><span class="n">siradel_furniture</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">fur</span> <span class="o">=</span> <span class="n">siradel</span><span class="o">.</span><span class="n">siradel_furniture</span><span class="p">[</span><span class="n">furk</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">fur</span><span class="o">.</span><span class="n">Matname</span> <span class="o">==</span> <span class="s">&#39;METAL&#39;</span><span class="p">:</span>
                <span class="n">fur</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

        <span class="c">#self.show(furniture=True)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">vaxis</span><span class="p">)</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xtx</span><span class="p">,</span> <span class="n">ytx</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                        <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xrx</span><span class="p">,</span> <span class="n">yrx</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">colbool</span><span class="p">:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cblabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">b1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.info.html#pylayers.simul.simulem.Simul.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="o">=</span><span class="p">[],</span> <span class="n">irx</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; display simulation information</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>
<span class="sd">         itx : Tx index</span>
<span class="sd">         irx : Rx index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span>
        <span class="k">print</span> <span class="s">&#39;------------------------------------------&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Layout Info : </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;provide a Layout in the simulation : S.L &quot;</span>
            <span class="k">print</span> <span class="s">&quot;&gt;&gt;&gt; S.layout(filename.str) &quot;</span>
            <span class="k">print</span> <span class="s">&quot;or &quot;</span>
            <span class="k">print</span> <span class="s">&quot;&gt;&gt;&gt; S.layout(filename.str2 &quot;</span>
            <span class="k">print</span> <span class="s">&quot;or &quot;</span>
            <span class="k">print</span> <span class="s">&quot;&gt;&gt;&gt; S.layout(filename.str,filematini,filematini) &quot;</span>
            <span class="k">print</span> <span class="s">&quot;default files exists for filematini and fileslabini &quot;</span>

            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Tx Info :</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;provide a tx in the simulation : S.tx &quot;</span>
            <span class="k">return</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;Rx Info :</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;provide a rx in the simulation : S.rx &quot;</span>
            <span class="k">return</span>

        <span class="c">#    print &quot;Tx : &quot;,self.tx.points[itx]</span>
            <span class="k">print</span> <span class="s">&quot;Rx : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
            <span class="k">print</span> <span class="s">&quot;Delay (ns) :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&quot;Distance (m) :&quot;</span><span class="p">,</span> <span class="mf">0.3</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">)</span>
            <span class="k">print</span> <span class="s">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">itx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot;Launching &quot;</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot;Tracing &quot;</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="n">gr</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
                <span class="n">gr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
                <span class="n">gr</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot;Tud parameters &quot;</span>
                <span class="k">print</span> <span class="s">&quot;-----&quot;</span>
                <span class="k">print</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="k">print</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="k">print</span> <span class="s">&quot; &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="n">gt</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="o">.</span><span class="n">GrRayTud</span><span class="p">()</span>
                <span class="n">gt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
                <span class="n">VC</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">VC</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Simul.info2"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.info2.html#pylayers.simul.simulem.Simul.info2">[docs]</a>    <span class="k">def</span> <span class="nf">info2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="k">print</span> <span class="n">j</span><span class="p">,</span> <span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="Simul.filtray"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.filtray.html#pylayers.simul.simulem.Simul.filtray">[docs]</a>    <span class="k">def</span> <span class="nf">filtray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span> <span class="n">tau0</span><span class="p">,</span> <span class="n">tau1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; filter rays</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        itx :</span>
<span class="sd">        irx :</span>
<span class="sd">        tau0 :</span>
<span class="sd">        tau1 :</span>
<span class="sd">        col :</span>

<span class="sd">        Display ray and nstr</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gr</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Thin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;NodeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;EdgeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;scaled&#39;</span><span class="p">)</span>
        <span class="c">#self.L.show(fig,ax,nodelist,seglist)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">()</span>
        <span class="n">delays</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">delay</span><span class="p">()</span>
        <span class="n">rayset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">((</span><span class="n">delays</span> <span class="o">&gt;=</span> <span class="n">tau0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">delays</span> <span class="o">&lt;=</span> <span class="n">tau1</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_axes</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">rayset</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;-Rx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span>
            <span class="n">tau0</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39; &lt; tau &lt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tau1</span><span class="p">))</span>
</div>
<div class="viewcode-block" id="Simul.showray"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.showray.html#pylayers.simul.simulem.Simul.showray">[docs]</a>    <span class="k">def</span> <span class="nf">showray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span> <span class="n">iray</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">fig</span><span class="o">=</span><span class="p">[],</span> <span class="n">ax</span><span class="o">=</span><span class="p">[]):</span>
        <span class="sd">&quot;&quot;&quot; show layout and rays for a radio link</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        itx  : tx index</span>
<span class="sd">        irx  : rx index</span>
<span class="sd">        iray : list of rays to be displayed ndarray</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c">#if ax==[]:</span>
        <span class="c">#    fig = plt.figure()</span>
        <span class="c">#    ax  = fig.add_subplot(&#39;111&#39;)</span>

        <span class="n">gr</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iray</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">ray</span> <span class="o">=</span> <span class="n">gr</span><span class="o">.</span><span class="n">ray3d</span><span class="p">[</span><span class="n">iray</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">nstr</span> <span class="o">=</span> <span class="n">ray</span><span class="o">.</span><span class="n">nstr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">uneg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">nstr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">upos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">((</span><span class="n">nstr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">nstr</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Ne</span><span class="p">))</span>
            <span class="n">uceil</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">nstr</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Ne</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">ufloor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">nstr</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Ne</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c">#seglist  = nstr[upos[0]]-1</span>
        <span class="c">#nodelist = -nstr[uneg[0]]-1</span>
        <span class="c">#seglist2 = S.L.segpt(nodelist)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Thin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;NodeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;EdgeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c">#self.L.show(fig,ax)</span>
        <span class="c">#print ray.nn</span>
        <span class="c">#print len(ray.nstr)</span>
        <span class="c">#print ray.nstr</span>
        <span class="c">#print nodelist</span>
        <span class="c">#print seglist</span>
        <span class="c">#print seglist2</span>
        <span class="c">#seglist = hstack((seglist,seglist2))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;Thin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;NodeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">display</span><span class="p">[</span><span class="s">&#39;EdgeNum&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s">&#39;scaled&#39;</span><span class="p">)</span>
        <span class="c">#self.L.show(fig,ax,nodelist,seglist)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showGs</span><span class="p">(</span><span class="n">show</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">iray</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iray</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nstr</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&#39;Tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;-Rx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span> <span class="o">+</span>
                      <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">iray</span><span class="p">))</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">iray</span><span class="p">)))</span>
</div>
<div class="viewcode-block" id="Simul.show3l"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.show3l.html#pylayers.simul.simulem.Simul.show3l">[docs]</a>    <span class="k">def</span> <span class="nf">show3l</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; geomview display of a specific link</span>

<span class="sd">        g = S.show3l(itx,irx)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        itx</span>
<span class="sd">            transmitter index</span>
<span class="sd">        irx</span>
<span class="sd">            receiver index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filetra</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
        <span class="n">gr</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filetra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">show3</span><span class="p">()</span>

        <span class="k">return</span><span class="p">(</span><span class="n">gr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul._show3"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul._show3.html#pylayers.simul.simulem.Simul._show3">[docs]</a>    <span class="k">def</span> <span class="nf">_show3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rays</span><span class="o">=</span><span class="p">[],</span><span class="n">newfig</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display of the simulation configuration</span>
<span class="sd">            using Mayavi</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        rays: Ray3d object :</span>
<span class="sd">            display the rays of the simulation</span>
<span class="sd">        newfig : boolean (default : False)</span>
<span class="sd">        kwargs of Rays.show3()</span>


<span class="sd">        see also</span>
<span class="sd">        --------</span>

<span class="sd">        pylayers.gis.layout</span>
<span class="sd">        pylayers.antprop.antenna</span>
<span class="sd">        pylayers.antprop.rays</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Atx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span>
        <span class="n">Arx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span>
        <span class="n">Ttx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">orientation</span>
        <span class="n">Trx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">orientation</span>
        <span class="n">ptx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">position</span>
        <span class="n">prx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">position</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">_show3</span><span class="p">(</span><span class="n">newfig</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">Atx</span><span class="o">.</span><span class="n">_show3</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Ttx</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">po</span><span class="o">=</span><span class="n">ptx</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">newfig</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">Arx</span><span class="o">.</span><span class="n">_show3</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Trx</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">po</span><span class="o">=</span><span class="n">prx</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">colorbar</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">newfig</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rays</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">rays</span><span class="o">.</span><span class="n">_show3</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


</div>
<div class="viewcode-block" id="Simul.show3"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.show3.html#pylayers.simul.simulem.Simul.show3">[docs]</a>    <span class="k">def</span> <span class="nf">show3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">rays</span><span class="o">=</span><span class="p">[],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; geomview display of the simulation configuration</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        centered : boolean</span>
<span class="sd">            center the scene if True</span>
<span class="sd">        bdis  : boolean</span>
<span class="sd">            display local basis</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;tx set is no defined&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&#39;rx set is no defined&#39;</span><span class="p">)</span>
        <span class="n">_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span> <span class="s">&#39;.off&#39;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRGEOM&#39;</span><span class="p">])</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;LIST</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sttx</span> <span class="o">=</span> <span class="s">&quot;{&lt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">filegeom</span> <span class="o">+</span> <span class="s">&quot;}</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">sttx</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">strx</span> <span class="o">=</span> <span class="s">&quot;{&lt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">filegeom</span> <span class="o">+</span> <span class="s">&quot;}</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">strx</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">stst</span> <span class="o">=</span> <span class="s">&quot;{&lt;&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">filegeom</span> <span class="o">+</span> <span class="s">&quot;}</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">stst</span> <span class="o">=</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sttx</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">strx</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">stst</span><span class="p">)</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;{&lt;/usr/share/geomview/geom/xyz.vect}</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rays</span> <span class="o">!=</span><span class="p">[]:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;bdis&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;L&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s">&#39;centered&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">False</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;{&lt;&quot;</span> <span class="o">+</span> <span class="n">rays</span><span class="o">.</span><span class="n">show3</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;}&quot;</span><span class="p">)</span>

        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


        <span class="n">command</span> <span class="o">=</span> <span class="s">&quot;geomview -nopanel -b 1 1 1 &quot;</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s">&quot; 2&gt;/dev/null &amp;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.freq"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.freq.html#pylayers.simul.simulem.Simul.freq">[docs]</a>    <span class="k">def</span> <span class="nf">freq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GUI</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            return the frequency base from the content of filefreq</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        GUI</span>
<span class="sd">            Boolean</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filefreq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span>
        <span class="n">filefreq</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">filefreq</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTUD&#39;</span><span class="p">])</span>
        <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filefreq</span><span class="p">)</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">fo</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">fmin</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">fmax</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Nf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">GUI</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s">&#39;Enter frequency (GHz)&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                               <span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">,</span> <span class="s">&#39;stop&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">),</span>
                               <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">Nf</span><span class="p">)))</span>
            <span class="n">fmin</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">fmax</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">Nf</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">fo</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filefreq</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">val</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39; &#39;</span> <span class="o">+</span> <span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">fo</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">fGHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">Nf</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.getlaunch"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.getlaunch.html#pylayers.simul.simulem.Simul.getlaunch">[docs]</a>    <span class="k">def</span> <span class="nf">getlaunch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         get the kth launch</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        k :  int</span>
<span class="sd">            launching index (default 1)</span>

<span class="sd">        Launching index starts at 1</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">L</span> <span class="o">=</span> <span class="n">Launch</span><span class="p">()</span>
            <span class="n">L</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">return</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">&quot;Tx not available&quot;</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.gettra"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.gettra.html#pylayers.simul.simulem.Simul.gettra">[docs]</a>    <span class="k">def</span> <span class="nf">gettra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Gtra = S.gettra(itx,irx)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">itx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">irx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">Gtra</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
            <span class="n">Gtra</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">indoor</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Gtra</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;gettra warning : wrong tx or rx index&quot;</span>
</div>
<div class="viewcode-block" id="Simul.gettud"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.gettud.html#pylayers.simul.simulem.Simul.gettud">[docs]</a>    <span class="k">def</span> <span class="nf">gettud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">         Gtud = S.gettud(itx,irx)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">itx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">N</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">irx</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">N</span><span class="p">):</span>
            <span class="n">Gtud</span> <span class="o">=</span> <span class="n">GrRayTud</span><span class="p">()</span>
            <span class="n">Gtud</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Gtud</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;gettud warning : wrong tx or rx index&quot;</span>
    <span class="c">#def gettud(self,k,l):</span>
    <span class="c">#def getfield(self,k,l):</span>
</div>
<div class="viewcode-block" id="Simul.launching"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.launching.html#pylayers.simul.simulem.Simul.launching">[docs]</a>    <span class="k">def</span> <span class="nf">launching</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; start the launching program and get the results files</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        itx : int</span>
<span class="sd">            transmiter index</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">filestr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filestr</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s">&#39;.str&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">filestr</span><span class="p">,</span><span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRSTRUC&#39;</span><span class="p">])):</span>
            <span class="n">chaine</span> <span class="o">=</span> <span class="s">&#39;newstruc -str2 &#39;</span> <span class="o">+</span> <span class="n">filestr</span> <span class="o">+</span><span class="s">&#39;2 &#39;</span> <span class="o">+</span> <span class="n">filestr</span> <span class="o">+</span> <span class="s">&#39; -conf &#39;</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>


        <span class="n">chaine</span> <span class="o">=</span> <span class="s">&quot;launching -str  &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filestr</span> <span class="o">+</span> \
            <span class="s">&quot; -slab &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslab</span> <span class="o">+</span> \
            <span class="s">&quot; -palch &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepalch</span> <span class="o">+</span> \
            <span class="s">&quot; -spa &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">filespa</span> <span class="o">+</span> \
            <span class="s">&quot; -conf &quot;</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">chaine</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">claunching</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">chaine</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">recup</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">recup</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">recup</span> <span class="o">=</span> <span class="n">recup</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">len_aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>

        <span class="n">filelch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_aux</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filelchout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filelchout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">fshort</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">filelch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fshort</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="n">fshort</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filelch</span> <span class="o">=</span> <span class="n">filelch</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nTx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelch</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c"># create a configuration file for Tx itx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;launch&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;trace&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;rang&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;tang&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;field&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;tauk&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;launch&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="n">itx</span><span class="p">])</span>
        <span class="c">#</span>
        <span class="c"># append output filename in section output</span>
        <span class="c">#</span>
        <span class="n">_outfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;.ini&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">=</span> <span class="n">_outfilename</span>
        <span class="n">outfilename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_outfilename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;output&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dout</span><span class="p">[</span><span class="n">itx</span><span class="p">])</span>

        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfilename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">filesimul</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="p">,</span><span class="s">&#39;ini&#39;</span><span class="p">)</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filesimul</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Simul.tracing"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.tracing.html#pylayers.simul.simulem.Simul.tracing">[docs]</a>    <span class="k">def</span> <span class="nf">tracing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; exec tracing</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        itx  : tx index</span>
<span class="sd">        irx  : rx index</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function should not be used for more than one rx.</span>
<span class="sd">        .. todo extend properly this function in order to handle properly</span>
<span class="sd">            multi-nodes in irx. The problem is to keep the association</span>
<span class="sd">            between the index number of the rx in the ini file and the </span>
<span class="sd">            rx in dtra. </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#</span>
        <span class="c"># Verify </span>
        <span class="c">#</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">chaine</span> <span class="o">=</span> <span class="s">&quot;tracing -lch &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span> <span class="o">+</span> \
                <span class="s">&quot; -patra &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filepatra</span> <span class="o">+</span> \
                <span class="s">&quot;  -spa &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">filespa</span> <span class="o">+</span> \
                <span class="s">&quot; -conf &quot;</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">chaine</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ctracing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">chaine</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">recup</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="c">#if verbose:</span>
                <span class="c">#print recup</span>
            <span class="n">aux</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recup</span> <span class="o">=</span> <span class="n">recup</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
            <span class="n">len_aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
            <span class="c">#</span>
            <span class="c"># set list of .tra files empty </span>
            <span class="c">#filetra = []</span>
            <span class="c">#for i in range(len_aux):</span>
            <span class="c">#    if aux[i].find(&quot;filetraout&quot;) != -1:</span>
            <span class="c">#        aux[i] = aux[i].replace(&#39;filetraout : &#39;, &#39;&#39;)</span>
            <span class="c">#        filetra.append(pyu.getshort(aux[i]))</span>
            <span class="c">#</span>
            <span class="c"># Warning : this is a bad fix  </span>
            <span class="c">#</span>
            <span class="c">#for filename in filetra:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_aux</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filetraout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filetraout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c">#if verbose:</span>
                <span class="c">#print filetra</span>
            <span class="c">#self.filetra.insert(ntx,filetra)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">progress</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&quot;No launching available&quot;</span>

        <span class="n">_outfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">))</span>
        <span class="n">outfilename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_outfilename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;trace&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfilename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
            <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Simul.tratotud"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.tratotud.html#pylayers.simul.simulem.Simul.tratotud">[docs]</a>    <span class="k">def</span> <span class="nf">tratotud</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert tracing in .tud</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">         itx : integer</span>
<span class="sd">            transmitter index</span>
<span class="sd">         irx : integer</span>
<span class="sd">            receiver index</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#</span>
        <span class="c"># .. todo:: take value from the simulation class</span>
        <span class="c">#</span>
        <span class="n">nrmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;nrmax&quot;</span><span class="p">)</span>
        <span class="n">num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;num&quot;</span><span class="p">)</span>
        <span class="n">purc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="s">&quot;purc&quot;</span><span class="p">)</span>
        <span class="n">chaine</span> <span class="o">=</span> <span class="s">&quot;tratotud -tra &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">+</span> \
            <span class="s">&quot; -min &quot;</span> <span class="o">+</span> <span class="n">nrmin</span> <span class="o">+</span> \
            <span class="s">&quot; -purc &quot;</span> <span class="o">+</span> <span class="n">purc</span> <span class="o">+</span> \
            <span class="s">&quot; -num &quot;</span> <span class="o">+</span> <span class="n">num</span> <span class="o">+</span>  \
            <span class="s">&quot; -conf &quot;</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span>
        <span class="k">print</span> <span class="s">&#39;DEBUG &#39;</span><span class="o">+</span><span class="n">chaine</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ctratotud</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">chaine</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">chaine</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s">&#39;echo $?&#39;</span><span class="p">)</span>
        <span class="n">recup</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">aux</span>
        <span class="n">len_aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_aux</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filetudout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filetudout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># fix</span>
                <span class="c">#filename = rename(filename,itx,irx,&#39;output&#39;)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">elif</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filetangout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filetangout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># fix</span>
                <span class="c">#filename = rename(filename,itx,irx,&#39;output&#39;)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">elif</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filerangout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filerangout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="c"># fix</span>
                <span class="c">#filename = rename(filename,itx,irx,&#39;output&#39;)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="n">filename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="n">_outfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">))</span>
        <span class="n">outfilename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_outfilename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tud&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tang&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;rang&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfilename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;error writing output ini file&#39;</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Simul.field"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.field.html#pylayers.simul.simulem.Simul.field">[docs]</a>    <span class="k">def</span> <span class="nf">field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; field calculation for Tx Rx using evalfield command</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ntx : integer</span>
<span class="sd">                 launching index</span>
<span class="sd">        nrx : integer</span>
<span class="sd">                 tracing index</span>
<span class="sd">        verbose : Boolean</span>
<span class="sd">            </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">chaine</span> <span class="o">=</span> <span class="s">&quot;evalfield -tud &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">+</span> \
                 <span class="s">&quot; -slab &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileslab</span> <span class="o">+</span> \
                 <span class="s">&quot; -mat &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filemat</span> <span class="o">+</span> \
                 <span class="s">&quot; -freq &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">filefreq</span> <span class="o">+</span> \
                 <span class="s">&quot; -conf &quot;</span> <span class="o">+</span> <span class="n">basename</span> <span class="o">+</span> <span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">fileconf</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cfield</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">chaine</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="n">chaine</span><span class="p">,</span> <span class="s">&quot;r&quot;</span><span class="p">)</span>
        <span class="n">recup</span> <span class="o">=</span> <span class="n">aux</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">aux</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">len_aux</span> <span class="o">=</span> <span class="n">recup</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_aux</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filefieldout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filefieldout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="c"># fix</span>
                <span class="c"># filename = rename(filename,itx,irx,&#39;output&#39;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">elif</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;filetaukout&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;filetaukout : &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">aux</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="c"># fix</span>
                <span class="c"># filename = rename(filename,itx,irx,&#39;output&#39;)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">_outfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">))</span>
        <span class="n">outfilename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_outfilename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;tauk&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtauk</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">irx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;field&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">])</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfilename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s">&#39;error writing output ini file&#39;</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="Simul.run2"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.run2.html#pylayers.simul.simulem.Simul.run2">[docs]</a>    <span class="k">def</span> <span class="nf">run2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">link</span><span class="p">,</span> <span class="n">cirforce</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">cutoff</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; run the simulation for 1 tx and a set of rx</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>

<span class="sd">            itx      : tx index</span>
<span class="sd">            srx      : list of rx index</span>
<span class="sd">            cirforce : boolean</span>

<span class="sd">            Warnings</span>
<span class="sd">            --------</span>

<span class="sd">            index point start with 1</span>

<span class="sd">            Example</span>
<span class="sd">            -------</span>

<span class="sd">            &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">            &gt;&gt;&gt; itx = 1</span>
<span class="sd">            &gt;&gt;&gt; srx = [1,2,3]</span>
<span class="sd">            &gt;&gt;&gt; S   = Simul()</span>
<span class="sd">            &gt;&gt;&gt; S.load(&#39;where2.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; out = S.run(itx,srx)</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">prefix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> 
        <span class="c">#</span>
        <span class="c">#</span>
        <span class="c">#</span>
        <span class="n">lsig</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">il</span>  <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">link</span><span class="p">):</span>
            <span class="n">tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">il</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">rx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">il</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

            <span class="n">ctx</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
            <span class="n">crx</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2cy</span><span class="p">(</span><span class="n">rx</span><span class="p">)</span>
            
            <span class="n">_filecir</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span><span class="s">&#39;-cir-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">link</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">))</span>
            <span class="n">D</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">D</span><span class="p">[</span><span class="s">&#39;Tx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tx</span>
            <span class="n">D</span><span class="p">[</span><span class="s">&#39;Rx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rx</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">lsig</span><span class="p">:</span>
                <span class="n">Si</span>  <span class="o">=</span> <span class="n">signature</span><span class="o">.</span><span class="n">Signatures</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">)</span>
                <span class="c">#</span>
                <span class="c"># Change the run number depending on</span>
                <span class="c"># the algorithm used for signature determination</span>
                <span class="c">#</span>
                <span class="n">Si</span><span class="o">.</span><span class="n">run4</span><span class="p">(</span><span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>
                <span class="c"># keep track and save signature</span>
                <span class="n">_filesir</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="s">&#39;-sig-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">((</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">))</span>
                <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filesig</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
                <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">Si</span><span class="p">,</span><span class="n">filesig</span><span class="p">)</span>
                <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">lsig</span><span class="o">.</span><span class="n">appeng</span><span class="p">((</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">))</span>
                <span class="n">Si</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">,(</span><span class="n">ctx</span><span class="p">,</span><span class="n">crx</span><span class="p">))</span>



            <span class="n">r2d</span> <span class="o">=</span> <span class="n">Si</span><span class="o">.</span><span class="n">rays</span><span class="p">(</span><span class="n">tx</span><span class="p">,</span><span class="n">rx</span><span class="p">)</span>
            <span class="n">r2d</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
    
            <span class="n">r3d</span> <span class="o">=</span> <span class="n">r2d</span><span class="o">.</span><span class="n">to3D</span><span class="p">()</span>
            <span class="n">r3d</span><span class="o">.</span><span class="n">locbas</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
            <span class="n">r3d</span><span class="o">.</span><span class="n">fillinter</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>

            <span class="n">Ct</span>  <span class="o">=</span> <span class="n">r3d</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">freq</span><span class="p">)</span>
            <span class="n">sco</span> <span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s">&#39;phi&#39;</span><span class="p">)</span>
            <span class="n">sca</span> <span class="o">=</span> <span class="n">Ct</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>

            <span class="n">ciro</span> <span class="o">=</span> <span class="n">sco</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
            <span class="n">cira</span> <span class="o">=</span> <span class="n">sca</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>

            <span class="n">D</span><span class="p">[</span><span class="s">&#39;to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ciro</span><span class="o">.</span><span class="n">x</span>
            <span class="n">D</span><span class="p">[</span><span class="s">&#39;ciro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ciro</span><span class="o">.</span><span class="n">y</span>
            <span class="n">D</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">x</span>
            <span class="n">D</span><span class="p">[</span><span class="s">&#39;cir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">y</span>

            <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="n">cirdir</span><span class="p">)</span>
            <span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
            </div>
<div class="viewcode-block" id="Simul.run"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.run.html#pylayers.simul.simulem.Simul.run">[docs]</a>    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">srx</span><span class="o">=</span><span class="p">[],</span> <span class="n">cirforce</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; run the simulation for 1 tx and a set of rx</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>

<span class="sd">            itx      : tx index</span>
<span class="sd">            srx      : list of rx index</span>
<span class="sd">            cirforce : boolean</span>

<span class="sd">            Warnings</span>
<span class="sd">            --------</span>

<span class="sd">            index point start with 1</span>

<span class="sd">            Example</span>
<span class="sd">            -------</span>

<span class="sd">            &gt;&gt;&gt; from pylayers.simul.simulem import *</span>
<span class="sd">            &gt;&gt;&gt; itx = 1</span>
<span class="sd">            &gt;&gt;&gt; srx = [1,2,3]</span>
<span class="sd">            &gt;&gt;&gt; S   = Simul()</span>
<span class="sd">            &gt;&gt;&gt; S.load(&#39;where2.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; out = S.run(itx,srx)</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">updcfg</span><span class="p">()</span>
        <span class="c">#t0 = time.clock()</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">srx</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">srx</span> <span class="o">=</span> <span class="p">[</span><span class="n">srx</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">srx</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">srx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">itx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlch</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c"># launching itx does not exist</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">filespa</span> <span class="o">=</span> <span class="s">&#39;tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.spa&#39;</span>
            <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
            <span class="n">spafile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">filespa</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                <span class="k">print</span> <span class="s">&quot;Start Launching Tx : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span>
                <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">launching</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span>

        <span class="c">#</span>
        <span class="c"># Loop over a set of rx</span>
        <span class="c">#</span>
        <span class="c">#pdb.set_trace()</span>
        <span class="k">for</span> <span class="n">irx</span> <span class="ow">in</span> <span class="n">srx</span><span class="p">:</span>
            <span class="n">tracingabort</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="n">irx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">filespa</span> <span class="o">=</span> <span class="s">&#39;rx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;.spa&#39;</span>
                <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
                <span class="n">spafile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">filespa</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRTRA&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s">&quot;--------------------&quot;</span>
                    <span class="k">print</span> <span class="s">&quot;Start tracing  Rx : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span>
                    <span class="k">print</span> <span class="s">&quot;--------------------&quot;</span>
                <span class="n">tracingabort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tracing</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">tracingabort</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">irx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                        <span class="k">print</span> <span class="s">&quot;Start tratotud &quot;</span><span class="p">,</span> <span class="n">irx</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">tratotud</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">irx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfield</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                        <span class="k">print</span> <span class="s">&quot;Start field  &quot;</span><span class="p">,</span> <span class="n">irx</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span><span class="n">verbose</span><span class="p">)</span>

                <span class="k">if</span> <span class="p">((</span><span class="n">irx</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">|</span> <span class="n">cirforce</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                        <span class="k">print</span> <span class="s">&quot;Start cir      &quot;</span><span class="p">,</span> <span class="n">irx</span>
                        <span class="k">print</span> <span class="s">&quot;---------------&quot;</span>
                    <span class="k">if</span> <span class="s">&quot;waveform&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
                        <span class="n">par</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s">&quot;waveform&quot;</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">par</span><span class="p">)):</span>
                            <span class="n">key</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                            <span class="n">val</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;band&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;fcGHz&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;feGHz&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;threshdB&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;twns&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">&quot;typ&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">wav</span> <span class="o">=</span> <span class="n">wvf</span><span class="o">.</span><span class="n">Waveform</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">wparam</span><span class="p">)</span>
                        <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">30.0</span><span class="p">)</span>
                        <span class="k">print</span> <span class="s">&quot;run debug &quot;</span><span class="p">,</span><span class="n">itx</span><span class="p">,</span><span class="n">irx</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cir</span><span class="p">([</span><span class="n">itx</span><span class="p">],</span> <span class="p">[</span><span class="n">irx</span><span class="p">],</span>
                                 <span class="n">store_level</span><span class="o">=</span><span class="mi">16</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span><span class="p">(</span><span class="s">&quot;Error no waveform in the config file &quot;</span><span class="p">)</span>
                        <span class="k">return</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">return</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span></div>
<div class="viewcode-block" id="Simul.gt"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.gt.html#pylayers.simul.simulem.Simul.gt">[docs]</a>    <span class="k">def</span> <span class="nf">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; gtud</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gt</span> <span class="o">=</span> <span class="n">GrRayTud</span><span class="p">()</span>
        <span class="n">filetud</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtud</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
        <span class="n">filetang</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
        <span class="n">filerang</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">drang</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">]</span>
        <span class="n">gt</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filetud</span><span class="p">,</span> <span class="n">filetang</span><span class="p">,</span> <span class="n">filerang</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sl</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">gt</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.delay"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.delay.html#pylayers.simul.simulem.Simul.delay">[docs]</a>    <span class="k">def</span> <span class="nf">delay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            calculate LOS link delay</span>

<span class="sd">            Parameters</span>
<span class="sd">            ----------</span>

<span class="sd">            itx</span>
<span class="sd">            irx</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">itx</span><span class="p">]</span>
        <span class="n">rx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">irx</span><span class="p">]</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">tx</span> <span class="o">-</span> <span class="n">rx</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="n">dist</span> <span class="o">/</span> <span class="mf">0.3</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.gr"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.gr.html#pylayers.simul.simulem.Simul.gr">[docs]</a>    <span class="k">def</span> <span class="nf">gr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">           return a  cluster or fays from link itx-irx</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">gr</span> <span class="o">=</span> <span class="n">GrRay3D</span><span class="p">()</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtra</span><span class="p">[</span><span class="n">itx</span><span class="p">][</span><span class="n">irx</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">gr</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.VC"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.VC.html#pylayers.simul.simulem.Simul.VC">[docs]</a>    <span class="k">def</span> <span class="nf">VC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            return Vect Channel for link itx irx</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">VCl</span> <span class="o">=</span> <span class="n">channelc</span><span class="o">.</span><span class="n">VectChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">VCl</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="Simul.cir"><a class="viewcode-back" href="../../../modules/generated/pylayers.simul.simulem.Simul.cir.html#pylayers.simul.simulem.Simul.cir">[docs]</a>    <span class="k">def</span> <span class="nf">cir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itx</span><span class="p">,</span> <span class="n">irx</span><span class="p">,</span> <span class="n">store_level</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRCIR&#39;</span><span class="p">],</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;a&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate a set of channel impulse responses</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">            itx : transmitter index iterable set</span>
<span class="sd">            irx : receiver index iterable set</span>
<span class="sd">            wav : applied waveform (st,sf,sfg)</span>
<span class="sd">                this waveform includes the gamma factor</span>
<span class="sd">            store_level : binary mask</span>
<span class="sd">                             bit  0 : save CVC</span>
<span class="sd">                             bit  1 : save CVCO</span>
<span class="sd">                             bit  2 : save CSCA</span>
<span class="sd">                             bit  3 : save CIRo</span>
<span class="sd">                             bit  4 : save CIRa</span>
<span class="sd">            alpha : normalization factor</span>
<span class="sd">            ext :</span>
<span class="sd">            rep :</span>
<span class="sd">            format : string</span>
<span class="sd">                a : with antenna</span>
<span class="sd">                o : omnidirectionnal</span>
<span class="sd">         Notes</span>
<span class="sd">         -----</span>
<span class="sd">         A factor ::math`\\sqrt{1}{30}` is necessary when applying the antenna</span>

<span class="sd">         Examples</span>
<span class="sd">         --------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">itx</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">itx</span> <span class="o">=</span> <span class="p">[</span><span class="n">itx</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">irx</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">irx</span> <span class="o">=</span> <span class="p">[</span><span class="n">irx</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CVC</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CSCO</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CSCA</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIRo</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CIRa</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">racine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filesimul</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39;.ini&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;cir-&#39;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">itx</span><span class="p">:</span>
            <span class="c"># create cir entry in outputTx if required</span>
            <span class="n">_outfilename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;output&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">))</span>
            <span class="n">outfilename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_outfilename</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s">&#39;DIRLCH&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="s">&quot;cir&quot;</span> <span class="ow">not</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s">&quot;cir&quot;</span><span class="p">)</span>

            <span class="n">CVC</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">CSCO</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">CSCA</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">CIRo</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">CIRa</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">irx</span><span class="p">:</span>
                <span class="n">D</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">D</span><span class="p">[</span><span class="s">&#39;Tx&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="n">l</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">):</span>
                        <span class="n">txrx</span> <span class="o">=</span> <span class="s">&#39;tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.3d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s">&#39;-rx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.3d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="n">txrx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span><span class="s">&#39;-&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;-p</span><span class="si">%0.3d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">k</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">txrx</span> <span class="o">=</span> <span class="n">ext</span>

                <span class="n">_filename</span> <span class="o">=</span> <span class="n">racine</span> <span class="o">+</span> <span class="n">txrx</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_filename</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;&#39;</span><span class="p">:</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span> <span class="o">+</span> <span class="s">&#39;/Tx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%0.3d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">l</span><span class="p">)</span>
                <span class="k">else</span> <span class="p">:</span>
                    <span class="n">rep</span> <span class="o">=</span> <span class="n">rep</span> <span class="o">+</span><span class="s">&#39;/&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">name</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">basename</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">rep</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">basename</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">rep</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="n">basename</span><span class="o">+</span><span class="s">&#39;/&#39;</span><span class="o">+</span><span class="n">rep</span><span class="p">)</span>


                <span class="n">filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_filename</span><span class="p">,</span> <span class="n">rep</span><span class="p">)</span>
                <span class="n">VCl</span> <span class="o">=</span> <span class="n">channelc</span><span class="o">.</span><span class="n">VectChannel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
                <span class="n">CVC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">VCl</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">VCl</span><span class="o">.</span><span class="n">fail</span><span class="p">:</span>
                    <span class="c">#SCO = VCl.vec2scal()</span>
                    <span class="n">SCO</span> <span class="o">=</span> <span class="n">VCl</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
                    <span class="n">CSCO</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SCO</span><span class="p">)</span>
                    <span class="c">#SCA = VCl.vec2scalA(self.tx.A, self.rx.A, alpha=alpha)</span>
                    <span class="c">#</span>
                    <span class="c">#  Apply the apha factor on waveform </span>
                    <span class="c">#</span>
                    <span class="n">SCA</span> <span class="o">=</span> <span class="n">VCl</span><span class="o">.</span><span class="n">prop2tran</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">)</span>
                    <span class="n">CSCA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SCA</span><span class="p">)</span>
                    <span class="n">ciro</span> <span class="o">=</span> <span class="n">SCO</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
                    <span class="n">CIRo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ciro</span><span class="p">)</span>
                    <span class="n">cira</span> <span class="o">=</span> <span class="n">SCA</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
                    <span class="n">CIRa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cira</span><span class="p">)</span>
                    <span class="n">D</span><span class="p">[</span><span class="s">&#39;Rx&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="s">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
                        <span class="n">D</span><span class="p">[</span><span class="s">&#39;to&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ciro</span><span class="o">.</span><span class="n">x</span>
                        <span class="n">D</span><span class="p">[</span><span class="s">&#39;ciro&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ciro</span><span class="o">.</span><span class="n">y</span>
                    <span class="k">if</span> <span class="s">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">format</span><span class="p">:</span>
                        <span class="n">D</span><span class="p">[</span><span class="s">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">x</span>
                        <span class="n">D</span><span class="p">[</span><span class="s">&#39;cir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cira</span><span class="o">.</span><span class="n">y</span>
                    <span class="n">spio</span><span class="o">.</span><span class="n">savemat</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;cir&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcir</span><span class="p">[</span><span class="n">l</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">outfilename</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
                    <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">CSCO</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">CSCA</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">CIRo</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">CIRa</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CVC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CVC</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CSCO</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CSCO</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CSCA</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CSCA</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CIRo</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CIRo</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">store_level</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">16</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">CIRa</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CIRa</span><span class="p">)</span>

</div>
<span class="k">if</span> <span class="p">(</span><span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="c">#plt.ion()</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../../../notebook/index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>

          <li><a href="../../index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2014, PyLayers developer team.
      Last updated on déc. 02, 2014.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_setDomainName', 'pylayers.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })(); 
</script> 
 
  </body>
</html>