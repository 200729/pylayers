
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pylayers.mobility.transit.Person &mdash; Python 1 documentation</title>
    
    <link rel="stylesheet" href="../../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="top" title="Python 1 documentation" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body role="document">

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../../../index.html">
            <img src="../../../../_static/pylayers.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../../../../download.html">Download</a></li>
            <li><a href="../../../../notebook/TOC.html">User Guide</a></li>
            <li><a href="../../../../modules/pylayers.html">Reference</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script>
  (function() {
       var cx = '004820205189002234612:sa15qzuf2ca';
           var gcse = document.createElement('script');
               gcse.type = 'text/javascript';
                   gcse.async = true;
                       gcse.src = (document.location.protocol == 'https:' ?
                           'https:' : 'http:') +
                               '//cse.google.com/cse.js?cx=' + cx;
                                   var s =
                                   document.getElementsByTagName('script')[0];
                                       s.parentNode.insertBefore(gcse, s);
                                         })();
</script>
<gcse:search></gcse:search>
</div>
</div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	  <div class="rel">
	   
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="../../../../py-modindex.html" title="Python Module Index"
	    >Modules
	    <br>
	    <span class="smallrellink">
	    Python Module Index
	    </span>
	    <span class="hiddenrellink">
	    Python Module Index
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
	<div class="spacer">
	&nbsp;
	</div>
	<div class="rellink">
	<a href="../../../index.html" title="Module code" >
	Up
	<br>
	<span class="smallrellink">
	Module code
	</span>
	<span class="hiddenrellink">
	Module code
	</span>
	
	</a>
	</div>
    </div>
    <p style="text-align: center; background-color: #BFFFFF">This documentation is

    for Python <strong>version 1</strong>
    &mdash; <a href="https://github.com/pylayers/pylayers/archive/master.zip">Other versions</a></p>
    
    <h3>Citing</h3>
    <p>If you use the software, please consider
    <a href="../../../../about.html#citing-pylayers">citing pylayers</a>.</p>
    <h3>This page</h3>
	
    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pylayers.mobility.transit.Person</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. currentmodule:: pylayers.mobility.transit.Person</span>

<span class="sd">Utility Functions</span>
<span class="sd">=================</span>

<span class="sd">.. autosummary;; </span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    scale</span>
<span class="sd">    copy</span>

<span class="sd">Person Class</span>
<span class="sd">=================</span>

<span class="sd">.. autosummary;; </span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Person.__init__</span>
<span class="sd">    Person.__repr__</span>
<span class="sd">    Person.move</span>
<span class="sd">    Person.delete</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">SimPy.SimulationRT</span> <span class="kn">import</span> <span class="n">Process</span><span class="p">,</span><span class="n">Simulation</span><span class="p">,</span><span class="n">hold</span>
<span class="kn">import</span> <span class="nn">ConfigParser</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="c1">#from math import *</span>
<span class="c1">#from random import normalvariate,uniform</span>
<span class="kn">from</span> <span class="nn">pylayers.mobility.transit.vec3</span> <span class="kn">import</span> <span class="n">vec3</span>
<span class="kn">from</span> <span class="nn">pylayers.mobility.transit.World</span> <span class="kn">import</span> <span class="n">world</span>
<span class="kn">from</span> <span class="nn">pylayers.mobility.transit.SteeringBehavior</span> <span class="kn">import</span> <span class="n">default_steering_mind</span>
<span class="c1"># from random import uniform,gauss,sample,seed</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pylayers.network.network</span> <span class="kn">import</span> <span class="n">Network</span>
<span class="kn">from</span> <span class="nn">pylayers.util.utilnet</span> <span class="kn">import</span> <span class="n">conv_vecarr</span>

<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="c1">#from pylayers.util.pymysqldb import Database </span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">import</span> <span class="nn">pylayers.util.plotutil</span> <span class="kn">as</span> <span class="nn">plu</span>

<span class="kn">import</span> <span class="nn">pdb</span>

<div class="viewcode-block" id="truncate"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.truncate">[docs]</a><span class="k">def</span> <span class="nf">truncate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>

<span class="sd">    max</span>

<span class="sd">    References </span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;near collision avoidance&quot; inspired from</span>
<span class="sd">    http://people.revoledu.com/kardi/publication/Kouchi2001.pdf</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="o">*</span> <span class="nb">max</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">vec3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<span class="n">vec3</span><span class="o">.</span><span class="n">truncate</span> <span class="o">=</span> <span class="n">truncate</span>

<div class="viewcode-block" id="scale"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.scale">[docs]</a><span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    size : float </span>
<span class="sd">        scaling factor</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    scaled version of self</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span> <span class="o">*</span> <span class="n">size</span></div>


<span class="n">vec3</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

<div class="viewcode-block" id="copy"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.copy">[docs]</a><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">vec3</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<span class="n">vec3</span><span class="o">.</span><span class="n">copy</span> <span class="o">=</span> <span class="n">copy</span>

<div class="viewcode-block" id="Person"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.Person">[docs]</a><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">Process</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Person Process</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    ID    : float/hex/str/...</span>
<span class="sd">            agent Id</span>
<span class="sd">    interval : float</span>
<span class="sd">            refresh interval of agent mobility</span>
<span class="sd">    roomId : int</span>
<span class="sd">            room ID where agent start when simulation is launched</span>
<span class="sd">    L : pylayers.gis.layout.Layout()</span>
<span class="sd">        Layout instance, in which the agent is moving</span>
<span class="sd">    net : pylayers.network.Network()</span>
<span class="sd">        Network instance, in which network agent are communicating.</span>
<span class="sd">        This is used for fill the true position filed of the graph</span>
<span class="sd">        It must be removed in a further version ( when a proper save instance</span>
<span class="sd">        would be created)</span>
<span class="sd">    wld : pylayers.mobility.transit.world.world()</span>
<span class="sd">        world instance. equivalent to layout but in the pytk framework. </span>
<span class="sd">        TODO : remove in a further version</span>
<span class="sd">    sim : SimPy.Simulation.Simulation.RT()</span>
<span class="sd">        Simulation instance share by all the pylayer project. </span>
<span class="sd">    moving : bool </span>
<span class="sd">        indicate if the agent is moving or not ( relevant for acces poitns)</span>
<span class="sd">    froom : list</span>
<span class="sd">        list of forbiden rooms. </span>
<span class="sd">    wait : float</span>
<span class="sd">        wait time of the agent when he has reach teh desitaion</span>
<span class="sd">    cdest : str</span>
<span class="sd">        method for choosing setination &#39;random &#39; of file read</span>
<span class="sd">    save : list</span>
<span class="sd">        list of save option type .</span>
<span class="sd">        It will be removed in a further version ( when a proper save instance</span>
<span class="sd">        would be created)</span>


<span class="sd">    Methods</span>
<span class="sd">    -------</span>

<span class="sd">    Move : make the agent move</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_acceleration</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># m/s/s</span>
    <span class="n">max_speed</span>    <span class="o">=</span> <span class="mf">1.2</span> <span class="c1"># m/s</span>
    <span class="c1">#radius = 0.2106  # if one person takes 1.5 feet^2 of space, per traffic stds</span>
    <span class="c1"># 2r = 0.5 to 0.7 for &quot;sports fans&quot;, per the Helbing, Farkas, Vicsek paper</span>
    <span class="n">radius</span>       <span class="o">=</span> <span class="mf">2.85</span>   <span class="c1"># per the Teknomo, et al, paper</span>
    <span class="n">mass</span>         <span class="o">=</span> <span class="mi">80</span> <span class="c1"># kg</span>
    <span class="n">average_radius</span>   <span class="o">=</span> <span class="mf">0.8</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="c1"># Radius = Perimeter / 2pi </span>
    <span class="n">npers</span>        <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#GeomNet      = np.array((0,0,[[1,2,3]],[[1,0,0]],[[0,0,1]]),dtype=GeomNetType)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ID</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span><span class="n">roomId</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="o">=</span><span class="p">[],</span> <span class="n">net</span><span class="o">=</span><span class="n">Network</span><span class="p">(),</span>
        <span class="n">wld</span> <span class="o">=</span> <span class="n">world</span><span class="p">(),</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">moving</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">froom</span><span class="o">=</span><span class="p">[],</span><span class="n">wait</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">cdest</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span>
        <span class="n">save</span><span class="o">=</span><span class="p">[],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">pdshow</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Class Person</span>
<span class="sd">            inherits of Simpy.SimulationRT</span>
<span class="sd">            &quot;&quot;&quot;</span>
        <span class="c1">#GeomNetType = np.dtype([(&#39;Id&#39;,int), </span>
        <span class="c1">#        (&#39;time&#39;,int), </span>
        <span class="c1">#           (&#39;p&#39;,float,(1,3)),</span>
        <span class="c1">#           (&#39;v&#39;,float,(1,3)),</span>
        <span class="c1">#           (&#39;a&#39;,float,(1,3))])</span>
        <span class="n">Person</span><span class="o">.</span><span class="n">npers</span> <span class="o">+=</span><span class="mi">1</span>
        <span class="n">Process</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Person_ID&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ID</span><span class="p">),</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="o">=</span><span class="n">ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="o">=</span><span class="n">color</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdshow</span><span class="o">=</span><span class="n">pdshow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L</span> <span class="o">=</span> <span class="n">L</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span> <span class="o">=</span> <span class="n">wld</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">manager_args</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="o">=</span><span class="n">moving</span>
        <span class="c1"># random.seed(seed)</span>
        
        <span class="k">if</span> <span class="n">roomId</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span>   <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span> 
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s1">&#39;This error is due to the lack of Gr graph in the Layout argument passed to Person(Object)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span>    <span class="o">=</span> <span class="n">roomId</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidroomId</span> <span class="o">=</span> <span class="n">froom</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">cdest</span> <span class="o">=</span> <span class="n">cdest</span> <span class="c1"># choose tdestination type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdest</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="c1"># self.nextroomId   = int(np.floor(random.uniform(0,self.L.Gr.size())))</span>
            <span class="k">try</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span>   <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span> 
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="s1">&#39;This error is due to the lack of Gr graph in the Layout argument passed to Person(Object)&#39;</span><span class="p">)</span>
            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidroomId</span><span class="p">):</span> <span class="c1"># or (self.nextroomId in self.sim.roomlist): # test destination different de l&#39;arrive</span>
                <span class="c1"># self.nextroomId   = int(np.floor(random.uniform(0,self.L.Gr.size())))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span>   <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#self.sim.roomlist.append(self.nextroomId) # list of all destiantion of all nodes in object sim</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdest</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
           <span class="n">cfg</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
           <span class="n">cfg</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s1">&#39;nodes_destination.ini&#39;</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">))</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">room_seq</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">))[</span><span class="s1">&#39;room_seq&#39;</span><span class="p">])</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">room_wait</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">))[</span><span class="s1">&#39;room_wait&#39;</span><span class="p">])</span>
           <span class="k">print</span> <span class="s1">&#39;WARNING: when nodes_destination ini file is read:&#39;</span>
           <span class="k">print</span> <span class="s1">&#39;1) the room initialization starts in the first room of the list, not in the room configured in agent.ini&#39;</span>
           <span class="k">print</span> <span class="s1">&#39;2) forbiden rooms are neglected&#39;</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="o">=</span><span class="mi">1</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">nb_room</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">room_seq</span><span class="p">)</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_seq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_seq</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="p">]</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_wait</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="p">]</span>
        <span class="c1">#self.sim.roomlist.append(self.nextroomId) # list of all destiantion of all nodes in object sim</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wp</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">waypointGw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span><span class="p">)</span>
        <span class="c1"># self.dlist =  [i in self.L.Gw.ldo for i in self.rooms]</span>
        <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec3</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">pos</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>     
            <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">()</span>
<span class="c1">#           self.old_pos = vec3()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stuck</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrived_in</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acceleration</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localx</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">localy</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">add_boid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># from Helbing, et al &quot;Self-organizing pedestrian movement&quot;</span>
        <span class="n">maxspeed</span> <span class="o">=</span> <span class="mf">0.8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span> <span class="o">=</span> <span class="n">maxspeed</span><span class="c1">#random.normalvariate(maxspeed, 0.1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desired_speed</span> <span class="o">=</span> <span class="n">maxspeed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">average_radius</span><span class="c1">#random.normalvariate(self.average_radius, 0.025) / 2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intersection</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrived</span> <span class="o">=</span> <span class="bp">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span> <span class="o">=</span> <span class="bp">False</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">behaviors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">steering_mind</span> <span class="o">=</span> <span class="n">default_steering_mind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">=</span><span class="n">net</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">=</span><span class="n">wait</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;vx&#39;</span><span class="p">,</span><span class="s1">&#39;vy&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;ay&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">_metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="o">=</span><span class="n">save</span>



        <span class="k">if</span> <span class="s1">&#39;mysql&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">:</span>
           <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
           <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s1">&#39;simulnet.ini&#39;</span><span class="p">,</span><span class="s1">&#39;ini&#39;</span><span class="p">))</span>
           <span class="n">sql_opt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">(</span><span class="s1">&#39;Mysql&#39;</span><span class="p">))</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">db</span> <span class="o">=</span> <span class="n">Database</span><span class="p">(</span><span class="n">sql_opt</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">],</span><span class="n">sql_opt</span><span class="p">[</span><span class="s1">&#39;user&#39;</span><span class="p">],</span><span class="n">sql_opt</span><span class="p">[</span><span class="s1">&#39;passwd&#39;</span><span class="p">],</span><span class="n">sql_opt</span><span class="p">[</span><span class="s1">&#39;dbname&#39;</span><span class="p">])</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;Mechanical information</span><span class="se">\n</span><span class="s1">***********************</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;agent ID: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;color: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">position: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;velocity: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;acceleration: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acceleration</span><span class="p">))</span> <span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Original room ID ---&gt;&#39;</span> <span class="o">+</span> <span class="s1">&#39; Current room ID &#39;</span> <span class="o">+</span><span class="s1">&#39;---&gt; Destination room ID</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="p">)</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; ---&gt; &#39;</span><span class="o">+</span>\
              <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2ro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">))</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;---&gt; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">current waypoint ID :&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">remaining waypoint ID :&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">pos destination room ID: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">destination</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">forbiden room list: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">forbidroomId</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">s</span>





<div class="viewcode-block" id="Person.move"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.Person.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Move the Person</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdshow</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">showG</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">alphacy</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span><span class="n">edges</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ion</span><span class="p">()</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                    <span class="k">print</span> <span class="s1">&#39;meca: updt ag &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">+</span> <span class="s1">&#39; @ &#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
                
                <span class="c1"># if np.allclose(conv_vecarr(self.destination)[:2],self.L.Gw.pos[47]):</span>
                <span class="c1">#     import ipdb</span>
                <span class="c1">#     ipdb.set_trace()</span>


                <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">passivate</span><span class="p">,</span> <span class="bp">self</span>
                    <span class="k">print</span> <span class="s2">&quot;Person.move: activated after being cancelled&quot;</span> 
                <span class="n">checked</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">zones</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">zone</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">checked</span><span class="p">:</span>
                        <span class="n">checked</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">zone</span><span class="p">)</span>
                        <span class="n">zone</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

                <span class="c1"># updating acceleration</span>
                <span class="n">acceleration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">steering_mind</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">acceleration</span> <span class="o">=</span> <span class="n">acceleration</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_acceleration</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">acceleration</span> <span class="o">=</span> <span class="n">acceleration</span>

                <span class="c1"># updating velocity</span>
                <span class="n">velocity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">+</span> <span class="n">acceleration</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">=</span> <span class="n">velocity</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_speed</span><span class="p">)</span>


                <span class="k">if</span> <span class="n">velocity</span><span class="o">.</span><span class="n">length</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.2</span><span class="p">:</span>
                    <span class="c1"># record direction only when we&#39;ve really had some</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">localy</span> <span class="o">=</span> <span class="n">velocity</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">localx</span> <span class="o">=</span> <span class="n">vec3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">localy</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">localy</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>

                <span class="c1"># updating position</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">velocity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
<span class="c1">#                self.update()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="o">.</span><span class="n">z</span><span class="o">=</span><span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">update_boid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">update_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>
                <span class="n">p</span><span class="o">=</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">v</span><span class="o">=</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">velocity</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">a</span><span class="o">=</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acceleration</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

                <span class="c1"># fill panda dataframe 2D trajectory</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span><span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">),</span>
                <span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;vx&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;vy&#39;</span><span class="p">:</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="s1">&#39;ax&#39;</span><span class="p">:</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="s1">&#39;ay&#39;</span><span class="p">:</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]},</span>
                <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;vx&#39;</span><span class="p">,</span><span class="s1">&#39;vy&#39;</span><span class="p">,</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span><span class="s1">&#39;ay&#39;</span><span class="p">]))</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdshow</span><span class="p">:</span>
                    <span class="n">ptmp</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">p</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">v</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>

                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;pl&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pla</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">ptmp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ptmp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">circle</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
                    <span class="k">else</span> <span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">color</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="o">*</span><span class="mi">10</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">pla</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ptmp</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">ptmp</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
                        <span class="n">circle</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
                        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
                    <span class="c1"># try:</span>
                    <span class="c1">#     fig,ax=plu.displot(p[:2],p[:2]+v[:2],&#39;r&#39;)</span>
                    <span class="c1"># except:</span>
                    <span class="c1">#     pass</span>
                    <span class="c1"># import ipdb</span>
                    <span class="c1"># ipdb.set_trace()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">pause</span><span class="p">(</span><span class="mf">0.0001</span><span class="p">)</span> 
                <span class="k">if</span> <span class="s1">&#39;mysql&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">writemeca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span><span class="n">p</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;txt&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">save</span><span class="p">:</span>
                    <span class="n">pyu</span><span class="o">.</span><span class="n">writemeca</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span><span class="n">p</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>

                <span class="c1"># new target when arrived in poi</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arrived</span> <span class="ow">and</span>\
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">pt2ro</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">)</span> <span class="o">==</span>\
                        <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gw</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;room&#39;</span><span class="p">]):</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">arrived</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span>
                        <span class="c1"># remove the remaining waypoint which correspond </span>
                        <span class="c1"># to current room position</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="c1"># del self.dlist[0]</span>
                    <span class="c1">#</span>
                    <span class="c1"># If door lets continue </span>
                    <span class="c1">#</span>
                    <span class="c1">#</span>
                    <span class="c1"># ig destination --&gt; next room</span>
                    <span class="c1">#</span>
                    <span class="c1">#adjroom  = self.L.Gr.neighbors(self.roomId)</span>
                    <span class="c1">#Nadjroom = len(adjroom)</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdest</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
                            <span class="c1"># self.nextroomId   = int(np.floor(random.uniform(0,self.L.Gr.size())))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span>   <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="c1"># test 1 ) next != actualroom</span>
                            <span class="c1">#      2 ) nextroom != fordiden room</span>
                            <span class="c1">#      3 ) room not share without another agent</span>
                            <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">roomId</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidroomId</span><span class="p">):</span><span class="c1"># or (self.nextroomId in self.sim.roomlist):</span>
                                <span class="c1"># self.nextroomId   = int(np.floor(random.uniform(0,self.L.Gr.size())))</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span>   <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">Gr</span><span class="o">.</span><span class="n">nodes</span><span class="p">(),</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cdest</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="o">+</span><span class="mi">1</span>
                           <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_room</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="o">=</span><span class="mi">0</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_seq</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="p">]</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">room_wait</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">room_counter</span><span class="p">]</span>
                        <span class="c1">#self.sim.roomlist.append(self.nextroomId) # list of all destiantion of all nodes in object sim</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">,</span> <span class="n">wp</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">waypointGw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roomId</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nextroomId</span><span class="p">)</span>
                        <span class="c1"># self.dlist =  [i in self.L.Gw.ldo for i in self.rooms]</span>
                        <span class="k">for</span> <span class="n">tup</span> <span class="ow">in</span> <span class="n">wp</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vec3</span><span class="p">(</span><span class="n">tup</span><span class="p">))</span> 
                    <span class="c1">#nextroom = adjroom[k]</span>
                    <span class="c1">#    print &quot;room : &quot;,self.roomId</span>
                    <span class="c1">#    print &quot;nextroom : &quot;,self.nextroomId</span>
                    <span class="c1">#p_nextroom = self.L.Gr.pos[self.nextroomId]</span>
                    <span class="c1">#setdoors1  = self.L.Gr.node[self.roomId][&#39;doors&#39;]</span>
                    <span class="c1">#setdoors2  = self.L.Gr.node[nextroom][&#39;doors&#39;]</span>
                    <span class="c1">#doorId     = np.intersect1d(setdoors1,setdoors2)[0]</span>
                    <span class="c1">#</span>
                    <span class="c1"># coord door</span>
                    <span class="c1">#</span>
                    <span class="c1">#unode = self.L.Gs.neighbors(doorId)    </span>
                    <span class="c1">#p1    = self.L.Gs.pos[unode[0]]</span>
                    <span class="c1">#p2    = self.L.Gs.pos[unode[1]]</span>
                    <span class="c1">#print p1</span>
                    <span class="c1">#print p2</span>
                    <span class="c1">#pdoor = (np.array(p1)+np.array(p2))/2</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                            <span class="k">print</span> <span class="s1">&#39;meca: ag &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ID</span> <span class="o">+</span> <span class="s1">&#39; wait &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wait</span><span class="p">)</span><span class="c1">#*self.interval) </span>
                        <span class="k">yield</span> <span class="n">hold</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wait</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rooms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="c1"># del self.dlist[0]</span>
                    <span class="c1">#print &quot;wp : &quot;, self.waypoints</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">endpoint</span><span class="o">=</span><span class="bp">True</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">destination</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">waypoints</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="c1">#print &quot;dest : &quot;, self.destination</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">hold</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span>
            <span class="k">else</span><span class="p">:</span>
<span class="c1">#                self.update()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">update_boid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">update_pos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span><span class="n">conv_vecarr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">position</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">now</span><span class="p">())</span>

                <span class="k">yield</span> <span class="n">hold</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span></div>

<div class="viewcode-block" id="Person.delete"><a class="viewcode-back" href="../../../../modules/pylayers.mobility.transit.Person.html#pylayers.mobility.transit.Person.Person.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            delete boid from world.tk</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">tk</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graphic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">world</span><span class="o">.</span><span class="n">remove_boid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cancelled</span> <span class="o">=</span> <span class="mi">1</span></div></div>

<span class="c1">#    def update(self):</span>
<span class="c1">#        tk = self.world.tk</span>
<span class="c1">#        if tk is None: return</span>
<span class="c1">#        if not hasattr(self, &#39;graphic&#39;):</span>
<span class="c1">#            self.graphic = tk.canvas.create_polygon(0, 0, 0, 1, 1, 1, 1, 0, smooth=True, fill=&#39;red&#39;, outline=&#39;black&#39;, tag=&#39;person&#39;)</span>
<span class="c1">#            if tk.collision_vectors:</span>
<span class="c1">#                self.graphic_front_collision = tk.canvas.create_line(0, 0, 1, 0, fill=&#39;white&#39;)</span>
<span class="c1">#                self.graphic_left_collision = tk.canvas.create_line(0, 0, 1, 0, fill=&#39;white&#39;)</span>
<span class="c1">#                self.graphic_right_collision = tk.canvas.create_line(0, 0, 1, 0, fill=&#39;white&#39;)</span>
<span class="c1">#                self.graphic_intersection = tk.canvas.create_oval(0, 0, 1, 1, fill=&#39;red&#39;)</span>
<span class="c1">#                self.graphic_intersection_normal = tk.canvas.create_line(0, 0, 1, 1, fill=&#39;red&#39;)</span>
<span class="c1">#            if tk.vectors:</span>
<span class="c1">#                self.graphic_velocity = tk.canvas.create_line(0, 0, 1, 0, fill=&#39;green&#39;)</span>
<span class="c1">#                self.graphic_acceleration = tk.canvas.create_line(0, 0, 1, 0, fill=&#39;blue&#39;)</span>
<span class="c1">#        x_, y_ = tk.x_, tk.y_</span>
<span class="c1">#        position = self.position</span>
<span class="c1">#        width, depth = self.localx * (self.radius), self.localy * (self.radius * 0.65)</span>
<span class="c1">#        ul = position - depth + width</span>
<span class="c1">#        ur = position + depth + width</span>
<span class="c1">#        lr = position + depth - width</span>
<span class="c1">#        ll = position - depth - width</span>
<span class="c1">#        tk.canvas.coords(self.graphic,</span>
<span class="c1">#                 x_(ul.x), y_(ul.y), x_(ur.x), y_(ur.y),</span>
<span class="c1">#                 x_(lr.x), y_(lr.y), x_(ll.x), y_(ll.y))</span>
<span class="c1">#        tk.canvas.create_line(x_(ur.x),y_(ur.y),x_(ul.x),y_(ul.y))</span>




<span class="c1">#        if tk.vectors:</span>
<span class="c1">#            xx, yy, unused_z = position</span>
<span class="c1">#            velocity = self.velocity</span>
<span class="c1">#            tk.canvas.coords(self.graphic_velocity,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + velocity.x), y_(yy + velocity.y))</span>
<span class="c1">#            acceleration = self.acceleration</span>
<span class="c1">#            tk.canvas.coords(self.graphic_acceleration,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + acceleration.x), y_(yy + acceleration.y))</span>
<span class="c1">#        if tk.collision_vectors:</span>
<span class="c1">#            xx, yy, unused_z = position</span>
<span class="c1">#            speed = self.velocity.length()</span>
<span class="c1">#            front_check = 0.5 + speed * 1.5</span>
<span class="c1">#            side_check = 0.5 + speed * 0.5</span>
<span class="c1">#            point = self.localy.scale(front_check)</span>
<span class="c1">#            tk.canvas.coords(self.graphic_front_collision,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + point.x), y_(yy + point.y))</span>
<span class="c1">#            point = (self.localy + self.localx).scale(side_check)</span>
<span class="c1">#            tk.canvas.coords(self.graphic_left_collision,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + point.x), y_(yy + point.y))</span>
<span class="c1">#            point = (self.localy - self.localx).scale(side_check)</span>
<span class="c1">#            tk.canvas.coords(self.graphic_right_collision,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + point.x), y_(yy + point.y))</span>
<span class="c1">#            if self.intersection:</span>
<span class="c1">#            xx, yy, unused_z = self.intersection</span>
<span class="c1">#            tk.canvas.coords(self.graphic_intersection,</span>
<span class="c1">#                     x_(xx-0.2), y_(yy-0.2), x_(xx + 0.2), y_(yy + 0.2))</span>
<span class="c1">#            point = self.intersection_normal</span>
<span class="c1">#            tk.canvas.coords(self.graphic_intersection_normal,</span>
<span class="c1">#                     x_(xx), y_(yy), x_(xx + point.x), y_(yy + point.y))</span>
<span class="c1">#            else:</span>
<span class="c1">#            tk.canvas.coords(self.graphic_intersection,</span>
<span class="c1">#                     0, 0, 0, 0)</span>
<span class="c1">#            tk.canvas.coords(self.graphic_intersection_normal,</span>
<span class="c1">#                     0, 0, 0, 0)</span>
<span class="c1">#        tk.canvas.lower(self.graphic, &#39;vehicle&#39;)</span>




</pre></div>

          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; 2016, PyLayers developer team.
      Last updated on Nov 06, 2017.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5a0. Design by <a href="http://desgrana.es">Desgrana</a>.
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="../../../../py-modindex.html">
        Previous
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#AFFFFF');
           },
           function () {
               $(this).css('background-color', '#AFFFFF');
           }
       );
     </script>
  </body>
</html>