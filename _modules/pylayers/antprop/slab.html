
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pylayers.antprop.slab &mdash; Python 1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/gallery.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="top" title="Python 1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body role="document">

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../../index.html">
            <img src="../../../_static/pylayers.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../../../download.html">Download</a></li>
            <li><a href="../../../notebook/TOC.html">User Guide</a></li>
            <li><a href="../../../modules/pylayers.html">Reference</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script>
  (function() {
       var cx = '004820205189002234612:sa15qzuf2ca';
           var gcse = document.createElement('script');
               gcse.type = 'text/javascript';
                   gcse.async = true;
                       gcse.src = (document.location.protocol == 'https:' ?
                           'https:' : 'http:') +
                               '//cse.google.com/cse.js?cx=' + cx;
                                   var s =
                                   document.getElementsByTagName('script')[0];
                                       s.parentNode.insertBefore(gcse, s);
                                         })();
</script>
<gcse:search></gcse:search>
</div>
</div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	  <div class="rel">
	   
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="../../../py-modindex.html" title="Python Module Index"
	    >Modules
	    <br>
	    <span class="smallrellink">
	    Python Module Index
	    </span>
	    <span class="hiddenrellink">
	    Python Module Index
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
	<div class="spacer">
	&nbsp;
	</div>
	<div class="rellink">
	<a href="../../index.html" title="Module code" >
	Up
	<br>
	<span class="smallrellink">
	Module code
	</span>
	<span class="hiddenrellink">
	Module code
	</span>
	
	</a>
	</div>
    </div>
    <p style="text-align: center; background-color: #BFFFFF">This documentation is

    for Python <strong>version 1</strong>
    &mdash; <a href="https://github.com/pylayers/pylayers/archive/master.zip">Other versions</a></p>
    
    <h3>Citing</h3>
    <p>If you use the software, please consider
    <a href="../../../about.html#citing-pylayers">citing pylayers</a>.</p>
    <h3>This page</h3>
	
    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pylayers.antprop.slab</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding: latin1 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This module implements the Material and Slab class which are used </span>
<span class="sd">in the ray tracing engine rays.py. </span>
<span class="sd">It exploits heavily numpy broadcasting mechanism :</span>


<span class="sd">The adopted axis convention is the following</span>

<span class="sd">+ nf : axis = 0 frequency axis</span>
<span class="sd">+ nt : axis = 1 angular axis</span>
<span class="sd">+ p  : axis = 2 parallel polarization axis</span>
<span class="sd">+ o  : axis = 3 orhogonal polarization axis</span>


<span class="sd">.. currentmodule:: pylayers.antprop.slab</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">Interface Class</span>
<span class="sd">===============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Interface.__init__</span>
<span class="sd">    Interface.RT</span>
<span class="sd">    Interface.pcolor</span>
<span class="sd">    Interface.tocolor</span>
<span class="sd">    Interface.loss0</span>
<span class="sd">    Interface.losst</span>
<span class="sd">    Interface.plotwrt</span>

<span class="sd">MatInterface Class</span>
<span class="sd">==================</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     MatInterface.__init__</span>


<span class="sd">Mat Class</span>
<span class="sd">=========</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Mat.__init__</span>
<span class="sd">    Mat.eval</span>
<span class="sd">    Mat.info</span>
<span class="sd">    Mat.R</span>


<span class="sd">MatDB Class</span>
<span class="sd">===========</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    MatDB.__init__</span>
<span class="sd">    MatDB.info</span>
<span class="sd">    MatDB.dass</span>
<span class="sd">    MatDB.delete</span>
<span class="sd">    MatDB.edit</span>
<span class="sd">    MatDB.add</span>
<span class="sd">    MatDB.addgui</span>
<span class="sd">    MatDB.choose</span>
<span class="sd">    MatDB.load</span>
<span class="sd">    MatDB.save</span>
<span class="sd">    MatDB.savemat</span>

<span class="sd">Slab Class</span>
<span class="sd">==========</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    Slab.__init__</span>
<span class="sd">    Slab.__repr__</span>
<span class="sd">    Slab.info</span>
<span class="sd">    Slab.conv</span>
<span class="sd">    Slab.ev</span>
<span class="sd">    Slab.filter</span>
<span class="sd">    Slab.excess_grdelay</span>
<span class="sd">    Slab.tocolor</span>
<span class="sd">    Slab.loss0</span>
<span class="sd">    Slab.losst</span>
<span class="sd">    Slab.editgui</span>
<span class="sd">    Slab.show</span>

<span class="sd">SlabDB Class</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    SlabDB.__init__</span>
<span class="sd">    SlabDB.showall</span>
<span class="sd">    SlabDB.info</span>
<span class="sd">    SlabDB.dass</span>
<span class="sd">    SlabDB.delete</span>
<span class="sd">    SlabDB.edit</span>
<span class="sd">    SlabDB.show</span>
<span class="sd">    SlabDB.add</span>
<span class="sd">    SlabDB.addgui</span>
<span class="sd">    SlabDB.load</span>
<span class="sd">    SlabDB.loadsl</span>
<span class="sd">    SlabDB.save</span>
<span class="sd">    SlabDB.savesl</span>

<span class="sd">Utility Functions</span>
<span class="sd">==================</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    calsig</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">absolute_import</span> 
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">cPickle</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">_pickle</span> <span class="kn">as</span> <span class="nn">cPickle</span>
<span class="kn">import</span> <span class="nn">doctest</span>
<span class="c1">#import objxml</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">struct</span> <span class="kn">as</span> <span class="nn">stru</span>
<span class="kn">import</span> <span class="nn">ConfigParser</span>
<span class="kn">from</span> <span class="nn">pylayers.util.project</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">import</span> <span class="nn">pylayers.util.plotutil</span> <span class="kn">as</span> <span class="nn">plu</span>
<span class="kn">from</span> <span class="nn">pylayers.util.easygui</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">interp1d</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">copy</span>


<span class="k">class</span> <span class="nc">Interface</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Interface between 2 medium</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    fGHz np.array (nf,1)</span>
<span class="sd">    theta np.array (1,nt)</span>
<span class="sd">    Ip np.array (nf,nt,2,2)</span>
<span class="sd">    Io np.array (nf,nt,2,2)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Interface.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.__init__.html#pylayers.antprop.slab.Interface.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.4</span><span class="p">]),</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span> <span class="o">+</span> <span class="mi">0</span> <span class="o">*</span> <span class="mi">1j</span><span class="p">]]),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fGHz : np.array</span>
<span class="sd">            frequency in GHz (default 2.4)</span>
<span class="sd">        theta : np.array</span>
<span class="sd">        angle taken from surface normal expressed in radians</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#</span>
        <span class="c1"># reshape theta if necessary</span>
        <span class="c1"># allows to use a ndim = 1 array</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">theta</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">theta</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># f x 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span> <span class="o">=</span> <span class="n">fGHz</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># 1 x q</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">thi</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="c1">#</span>
        <span class="c1"># Io : f x q x 2 x 2</span>
        <span class="c1"># Ip : f x q x 2 x 2</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span></div>

<div class="viewcode-block" id="Interface.RT"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.RT.html#pylayers.antprop.slab.Interface.RT">[docs]</a>    <span class="k">def</span> <span class="nf">RT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metalic</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">RT</span><span class="o">=</span><span class="s1">&#39;RT&#39;</span><span class="p">):</span>
        <span class="sd">r&quot;&quot;&quot; evaluate Reflection and Transmission matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        metalic : boolean</span>
<span class="sd">        RT : string</span>
<span class="sd">            choose R or T</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        .. math::</span>

<span class="sd">            R = \left[\begin{array}[cc](R_o &amp; 0\\0 &amp; R_p)\end{array}\right]</span>
<span class="sd">            T = \left[\begin{array}[cc](T_o &amp; 0\\0 &amp; T_p)\end{array}\right]</span>

<span class="sd">        R : np.array (f , th , 2, 2)</span>
<span class="sd">        T : np.array (f , th , 2, 2)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">)</span>
        <span class="n">nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1">#</span>
        <span class="c1"># R and T matrices are diagonal</span>
        <span class="c1">#</span>

        <span class="k">if</span> <span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">RT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nf</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">RT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">nf</span><span class="p">,</span> <span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        
        <span class="k">if</span> <span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">RT</span><span class="p">:</span>
            <span class="c1">#self.R[:, :, 0, 0] = self.Io[:, :, 0, 1] / self.Io[:, :, 0, 0]</span>
            <span class="c1">#self.R[:, :, 1, 1] = self.Ip[:, :, 0, 1] / self.Ip[:, :, 0, 0]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">metalic</span> <span class="ow">and</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">RT</span><span class="p">:</span>
            <span class="c1">#self.T[:, :, 0, 0] = 1.0 / self.Io[:, :, 0, 0]</span>
            <span class="c1">#self.T[:, :, 1, 1] = 1.0 / self.Ip[:, :, 0, 0]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span></div>



<div class="viewcode-block" id="Interface.pcolor"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.pcolor.html#pylayers.antprop.slab.Interface.pcolor">[docs]</a>    <span class="k">def</span> <span class="nf">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dB</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display of R &amp; T coefficients wrt frequency an angle</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        dB : boolean</span>
<span class="sd">        default False</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rtd</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="c1">#nom = self.m1.name+&#39;|&#39;+self.m2.name</span>
        <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
            <span class="n">modRo</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
            <span class="n">modRp</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
            <span class="n">modTo</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
            <span class="n">modTp</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">modRo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">modRp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">modTo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">modTp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hot</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modRo</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modRo</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">r&#39;$\theta$ (degrees) &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f (GHz)&#39;</span><span class="p">)</span>
        <span class="c1">#title(&#39;R _|_ &#39;+nom)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R _|_ &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modRp</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modRp</span><span class="p">)</span>
        <span class="c1">#title(&#39;R // &#39;+nom)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;R // &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">r&#39;$\theta$ (degrees) &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f (GHz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modTo</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modTo</span><span class="p">)</span>
        <span class="c1">#title(&#39;T _|_ &#39;+nom)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;T _|_ &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">r&#39;$\theta$ (degrees) &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f (GHz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modTp</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*</span> <span class="n">rtd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">modTp</span><span class="p">)</span>
        <span class="c1">#title(&#39;T // &#39;+nom)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;T // &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">r&#39;$\theta$ (degrees) &#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f (GHz)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="Interface.tocolor"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.tocolor.html#pylayers.antprop.slab.Interface.tocolor">[docs]</a>    <span class="k">def</span> <span class="nf">tocolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fGHz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert transmission into color</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fGHz : np.array</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        col : string</span>
<span class="sd">            hexadecimal color</span>


<span class="sd">        See Also</span>
<span class="sd">        ---------</span>

<span class="sd">        pylayers.gis.layout.showGs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># nf x nt x 2 x 2</span>
        <span class="n">modTo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">modTp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">N</span><span class="o">&gt;</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">N</span><span class="o">/</span><span class="mi">3</span>

            <span class="n">ared</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTo</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">])</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTp</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">)</span>
            <span class="n">agreen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTo</span><span class="p">[</span><span class="n">M</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">])</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTp</span><span class="p">[</span><span class="n">M</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">]))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">)</span>
            <span class="n">ablue</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTo</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">:])</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTp</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">:]))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">M</span><span class="p">))</span>

            <span class="c1"># hexadsecimal convert</span>
            <span class="n">vred</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">ared</span><span class="o">*</span><span class="mi">255</span><span class="p">)))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">vgreen</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">agreen</span><span class="o">*</span><span class="mi">255</span><span class="p">)))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">vblue</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">ablue</span><span class="o">*</span><span class="mi">255</span><span class="p">)))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vred</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">vred</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">vred</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vgreen</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">vgreen</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">vgreen</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vblue</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">vblue</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span><span class="o">+</span><span class="n">vblue</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span><span class="o">+</span><span class="n">vred</span><span class="o">+</span><span class="n">vgreen</span><span class="o">+</span><span class="n">vblue</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTo</span><span class="p">)</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">modTp</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">hex</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="mi">255</span><span class="p">)))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;0x&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">col</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="n">val</span><span class="o">+</span><span class="n">val</span>
        <span class="k">return</span><span class="p">(</span><span class="n">col</span><span class="p">)</span></div>


<div class="viewcode-block" id="Interface.loss0"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.loss0.html#pylayers.antprop.slab.Interface.loss0">[docs]</a>    <span class="k">def</span> <span class="nf">loss0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evaluate Loss at normal incidence theta=0</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : np.array (nf,1)</span>
<span class="sd">        display : boolean</span>
<span class="sd">        default (False)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Lo : loss in dB polarization orthogonal</span>
<span class="sd">        Lp : loss in dB polarization parallel</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">modTo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">modTp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="n">Lo</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">modTo</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">Lp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">modTp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Lo</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="c1">#plot(f,Lp,&#39;r&#39;)</span>
            <span class="c1">#legend((&#39;L0 _|_&#39;,&#39;L0 //&#39;),loc=&#39;upper right&#39;)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;L0 (dB)&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (GHz)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span><span class="p">(</span><span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Interface.losst"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.losst.html#pylayers.antprop.slab.Interface.losst">[docs]</a>    <span class="k">def</span> <span class="nf">losst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">dB</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evaluate Loss</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : np.arrray (nf)</span>
<span class="sd">        display : boolean</span>
<span class="sd">            default False</span>
<span class="sd">        dB : booean</span>
<span class="sd">            default True</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Lo : np.array</span>
<span class="sd">            Loss orthogonal polarization (dB)</span>
<span class="sd">        Lp : np.array</span>
<span class="sd">            Loss parallel polarization (dB)</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.slab import *</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        pylayers.antprop.coverage</span>
<span class="sd">        pylayers.antprop.loss</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">modTo</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">modTp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c1">#Lo = -20 * np.log10(modTo[:, 0])</span>
        <span class="c1">#Lp = -20 * np.log10(modTp[:, 0])</span>

        <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
            <span class="n">Lo</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">modTo</span><span class="p">)</span>
            <span class="n">Lp</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">modTp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Lo</span> <span class="o">=</span> <span class="n">modTo</span>
            <span class="n">Lp</span> <span class="o">=</span> <span class="n">modTp</span>

        <span class="k">if</span> <span class="n">display</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">Lo</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;L0 (dB)&#39;</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;frequency (GHz)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">return</span><span class="p">(</span><span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Interface.plotwrt"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Interface.plotwrt.html#pylayers.antprop.slab.Interface.plotwrt">[docs]</a>    <span class="k">def</span> <span class="nf">plotwrt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="n">kv</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; plot R &amp; T coefficients with respect to angle or frequency</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        kv : int</span>
<span class="sd">        variable index</span>
<span class="sd">        polar: string</span>
<span class="sd">        &#39;po&#39;, # po | p | o (parallel+ortho | parallel | ortogonal)</span>
<span class="sd">        coeff: string</span>
<span class="sd">        &#39;RT&#39;, # RT | R | T (Reflexion &amp; Transmission ) | Reflexion | Transmission</span>
<span class="sd">        var: string</span>
<span class="sd">        &#39;a&#39;, # a | f angle | frequency</span>
<span class="sd">        typ : string</span>
<span class="sd">        &#39;m&#39; | &#39;r&#39; | &#39;d&#39; | &#39;l20&#39;</span>
<span class="sd">        mod rad deg dB</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">            &gt;&gt;&gt; import matplotlib.pylab as plt</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; theta = np.arange(0,np.pi/2,0.01)</span>
<span class="sd">            &gt;&gt;&gt; fGHz = np.arange(0.1,10,0.2)</span>
<span class="sd">            &gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; mat = sl.mat</span>
<span class="sd">            &gt;&gt;&gt; lmatname = [mat[&#39;AIR&#39;],mat[&#39;WOOD&#39;]]</span>
<span class="sd">            &gt;&gt;&gt; II = MatInterface(lmatname,0,fGHz,theta)</span>
<span class="sd">            &gt;&gt;&gt; II.RT()</span>
<span class="sd">            &gt;&gt;&gt; fig,ax = II.plotwrt(var=&#39;a&#39;,kv=10,typ=[&#39;m&#39;])</span>
<span class="sd">            &gt;&gt;&gt; air = mat[&#39;AIR&#39;]</span>
<span class="sd">            &gt;&gt;&gt; brick = mat[&#39;BRICK&#39;]</span>
<span class="sd">            &gt;&gt;&gt; II = MatInterface([air,brick],0,fGHz,theta)</span>
<span class="sd">            &gt;&gt;&gt; II.RT()</span>
<span class="sd">            &gt;&gt;&gt; fig,ax = II.plotwrt(var=&#39;f&#39;,color=&#39;k&#39;,typ=[&#39;m&#39;])</span>
<span class="sd">            &gt;&gt;&gt; plt.ion()</span>
<span class="sd">            &gt;&gt;&gt; plt.show()</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;typ&#39;</span><span class="p">:[</span><span class="s1">&#39;l20&#39;</span><span class="p">],</span>
                <span class="s1">&#39;polar&#39;</span><span class="p">:</span><span class="s1">&#39;po&#39;</span><span class="p">,</span> <span class="c1"># po | p | o</span>
                <span class="s1">&#39;coeff&#39;</span><span class="p">:</span><span class="s1">&#39;RT&#39;</span><span class="p">,</span> <span class="c1"># RT | R | T</span>
                <span class="s1">&#39;att&#39;</span><span class="p">:</span><span class="bp">False</span>
               <span class="p">}</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1">#fGHz = self.fGHz[k]</span>
        <span class="n">rtd</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

        <span class="c1"># filtering kwargs argument for mulplot function</span>
        <span class="n">args</span> <span class="o">=</span><span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">args</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;nlin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="s1">&#39;labels&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>

        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;titles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span>
        <span class="n">args</span><span class="p">[</span><span class="s1">&#39;att&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;att&#39;</span><span class="p">]</span>

        <span class="c1"># Reflexion</span>
        <span class="k">if</span> <span class="s1">&#39;R&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">]:</span>
                <span class="n">args</span><span class="p">[</span><span class="s1">&#39;titles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;$R_{\perp}$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="c1"># wrt frequency</span>
                    <span class="n">Ro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="n">kv</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">Ro</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="c1"># wrt angle</span>
                    <span class="n">Ro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">kv</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">Ro</span>
            <span class="k">if</span> <span class="s1">&#39;p&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">]:</span>
                <span class="n">args</span><span class="p">[</span><span class="s1">&#39;titles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;$R_{//}$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="c1"># wrt frequency</span>
                    <span class="n">Rp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[:,</span> <span class="n">kv</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">Rp</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">Rp</span>
                <span class="k">if</span> <span class="n">var</span> <span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="c1"># wrt angle</span>
                    <span class="n">Rp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">kv</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">Rp</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">Rp</span>
        <span class="c1"># Transmission</span>
        <span class="k">if</span> <span class="s1">&#39;T&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="s1">&#39;o&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">]:</span>
                <span class="n">args</span><span class="p">[</span><span class="s1">&#39;titles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;$T_{\perp}$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="c1"># wrt frequency</span>
                    <span class="n">To</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="n">kv</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">To</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">To</span>
                <span class="k">if</span> <span class="n">var</span> <span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="c1"># wrt angle</span>
                    <span class="n">To</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">kv</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">To</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">To</span>
            <span class="k">if</span> <span class="s1">&#39;p&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;polar&#39;</span><span class="p">]:</span>
                <span class="n">args</span><span class="p">[</span><span class="s1">&#39;titles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">u&#39;$T_{//}$&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="c1"># wrt frequency</span>
                    <span class="n">Tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[:,</span> <span class="n">kv</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">Tp</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">To</span>
                <span class="k">if</span> <span class="n">var</span> <span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="c1"># wrt angle</span>
                    <span class="n">Tp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">kv</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">y</span><span class="p">,</span><span class="n">Tp</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">To</span>

        <span class="c1"># setting the x axis</span>
        <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="c1"># wrt frequency</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1">#x = self.fGHz[np.newaxis,:]</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:]</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># f x a</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;xlabels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">var</span><span class="o">==</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="c1"># wrt angle</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thi</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thi</span><span class="p">[</span><span class="mi">0</span><span class="p">,:][:]</span><span class="o">*</span><span class="n">rtd</span>
                <span class="c1">#x = self.thi[0,:][np.newaxis,:]*rtd</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># f x a</span>
                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">thi</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">*</span><span class="n">rtd</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;xlabels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Angle (deg)&#39;</span><span class="p">]</span>

        <span class="n">nplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">nplot</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;nlin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">nplot</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;nlin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">nplot</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;ncol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;nlin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plu</span><span class="o">.</span><span class="n">mulcplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span></div>


<span class="k">class</span> <span class="nc">MatInterface</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot; MatInterface : Class for Interface between two materials</span>

<span class="sd">    l distance from the next Interface</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This is required for recursive utilization of this function when the</span>
<span class="sd">    output angle of an interface happens to be the input angle of the</span>
<span class="sd">    next interface. As this angle depends on materials which themselves</span>
<span class="sd">    depends on frequency THETA is becoming a full matrix without redundancy</span>
<span class="sd">    between lines.</span>

<span class="sd">    &gt;&gt;&gt; theta = np.arange(0,np.pi/2,0.01)</span>
<span class="sd">    &gt;&gt;&gt; fGHz = np.arange(3.1,10.6,0.2)</span>
<span class="sd">    &gt;&gt;&gt; Nf = len(fGHz)</span>
<span class="sd">    &gt;&gt;&gt; Nt = len(theta)</span>
<span class="sd">    &gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">    &gt;&gt;&gt; mat = sl.mat</span>
<span class="sd">    &gt;&gt;&gt; m1 = mat[&#39;AIR&#39;]</span>
<span class="sd">    &gt;&gt;&gt; m2 = mat[&#39;PLASTER&#39;]</span>
<span class="sd">    &gt;&gt;&gt; II = MatInterface([m1,m2],0,fGHz,theta)</span>

<span class="sd">    .. math::</span>

<span class="sd">    I_p = \left| \begin{array}{cc} \frac{1}{T_p} &amp; \frac{R_p}{T_p} \\ \frac{R_p}{T_p} &amp; \frac{1}{T_p} \end{array}\right|</span>

<span class="sd">    I_o = \left| \begin{array}{cc} \frac{1}{T_o} &amp; \frac{R_o}{T_o} \\ \frac{R_o}{T_o} &amp; \frac{1}{T_o} \end{array}\right|</span>


<span class="sd">    .. todo::</span>
<span class="sd">    MatIinterface fix the np.pi/2 NaN problem</span>


<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MatInterface.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatInterface.__init__.html#pylayers.antprop.slab.MatInterface.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lmat</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Fresnel reflection coefficients</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        lmat : [ m1 , m2] list of materials</span>
<span class="sd">        l : distance between interfaces</span>
<span class="sd">        fGHz : frequency (GHz)</span>
<span class="sd">        theta : angle with respect to the reflective surface normal</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#if not isinstance(fGHz,np.ndarray):</span>
        <span class="c1"># fGHz=np.array([fGHz])</span>
        <span class="c1">#if not isinstance(theta,np.ndarray):</span>
        <span class="c1"># theta=np.array([theta])</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mat</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">lmat</span><span class="p">)</span>
        <span class="c1"># Interface.__init__(self, fGHz, theta, name=name)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MatInterface</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m1</span> <span class="o">=</span> <span class="n">lmat</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">m2</span> <span class="o">=</span> <span class="n">lmat</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># 2*np.pi* f(GHz)*eps0 = f(Ghz)/17.98</span>

        <span class="c1">#epr1 = self.m1[&#39;epr&#39;] - 1j * abs(self.m1[&#39;sigma&#39;]) * 17.98 / self.fGHz</span>
        <span class="c1">#epr2 = self.m2[&#39;epr&#39;] - 1j * abs(self.m2[&#39;sigma&#39;]) * 17.98 / self.fGHz</span>
        <span class="c1">#pdb.set_trace()</span>
        <span class="n">epr1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span>
        <span class="n">epr2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span>

        <span class="n">mur1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m1</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span>
        <span class="n">mur2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">m2</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span>

        <span class="c1">#n1 = sqrte(epr1/mur1)</span>

        <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">epr1</span> <span class="o">/</span> <span class="n">mur1</span><span class="p">)</span>
        <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">epr2</span> <span class="o">/</span> <span class="n">mur2</span><span class="p">)</span>

        <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
        <span class="c1"># // TM polarization 8.1.4 http://www.ece.rutgers.edu/~orfanidi/ewa/ch08.pdf</span>
        <span class="n">nT1p</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">/</span> <span class="n">ct</span>
        <span class="c1"># _|_ TE polarization 8.1.4 http://www.ece.rutgers.edu/~orfanidi/ewa/ch08.pdf</span>
        <span class="n">nT1o</span> <span class="o">=</span> <span class="n">n1</span> <span class="o">*</span> <span class="n">ct</span>

        <span class="c1">#print np.shape(n1)</span>
        <span class="c1">#print np.shape(ct)</span>
        <span class="c1">#print &quot;Slab cst n1 et ct &quot;,n1[15,0],ct[0,31]</span>
        <span class="c1">#print &quot;Slab cst nT1p &quot;,nT1p[15,31]</span>
        <span class="c1">#print &quot;Slab cst nT1o &quot;,nT1o[15,31]</span>

        <span class="c1">#cti = pyu.sqrte(1-((n1/n2)*np.sin(self.theta))**2)</span>
        <span class="n">cti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="n">n1</span> <span class="o">/</span> <span class="n">n2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="c1">#CTI = np.sqrt(1-((n1/n2)*np.sin(THETA))**2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">cti</span><span class="p">)</span>
        <span class="c1">#print np.shape(cti)</span>
        <span class="c1">#print &quot;cti &quot;,cti[15,31]</span>
        <span class="c1">#print &quot;arcos(cti) &quot;,self.theta[15,31]</span>
        <span class="c1">#print &#39;-------------------------&#39;</span>

        <span class="k">if</span> <span class="n">l</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">deltai</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">l</span> <span class="o">*</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">cti</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span> <span class="o">/</span> <span class="mf">0.3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">deltai</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">nT2p</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">/</span> <span class="n">cti</span>
        <span class="n">nT2o</span> <span class="o">=</span> <span class="n">n2</span> <span class="o">*</span> <span class="n">cti</span>

        <span class="n">Rp</span> <span class="o">=</span> <span class="p">(</span><span class="n">nT1p</span> <span class="o">-</span> <span class="n">nT2p</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nT1p</span> <span class="o">+</span> <span class="n">nT2p</span><span class="p">)</span>
        <span class="c1">#Ro = (nT1o-nT2o)/(nT1o+nT2o)</span>
        <span class="n">Ro</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">nT1o</span> <span class="o">-</span> <span class="n">nT2o</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nT1o</span> <span class="o">+</span> <span class="n">nT2o</span><span class="p">)</span> <span class="c1"># modif Eric</span>
        <span class="n">Tp</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">Rp</span>
        <span class="n">To</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">Ro</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ro</span> <span class="o">=</span> <span class="n">Ro</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Rp</span> <span class="o">=</span> <span class="n">Rp</span>

        <span class="n">jdeltai</span> <span class="o">=</span> <span class="mi">1j</span><span class="o">*</span><span class="n">deltai</span>
        <span class="n">epd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">jdeltai</span><span class="p">)</span>
        <span class="n">emd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">jdeltai</span><span class="p">)</span>

        <span class="n">epdoTp</span> <span class="o">=</span> <span class="n">epd</span><span class="o">/</span><span class="n">Tp</span>
        <span class="n">emdoTp</span> <span class="o">=</span> <span class="n">emd</span><span class="o">/</span><span class="n">Tp</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">epdoTp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rp</span> <span class="o">*</span> <span class="n">emdoTp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Rp</span> <span class="o">*</span> <span class="n">epdoTp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">emdoTp</span>

        <span class="n">epdoTo</span> <span class="o">=</span> <span class="n">epd</span><span class="o">/</span><span class="n">To</span>
        <span class="n">emdoTo</span> <span class="o">=</span> <span class="n">emd</span><span class="o">/</span><span class="n">To</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">epdoTo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ro</span> <span class="o">*</span> <span class="n">emdoTo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ro</span> <span class="o">*</span> <span class="n">epdoTo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">emdoTo</span></div>

        <span class="c1">#print &#39;Slab MatInterface Ip00&#39;,self.Ip[15,31,0,0]</span>
        <span class="c1">#print &#39;Slab MatInterface Ip01&#39;,self.Ip[15,31,0,1]</span>
        <span class="c1">#print &#39;Slab MatInterface Ip10&#39;,self.Ip[15,31,1,0]</span>
        <span class="c1">#print &#39;Slab MatInterface Ip11&#39;,self.Ip[15,31,1,1]</span>

        <span class="c1">#print &#39;Slab MatInterface Io00&#39;,self.Io[15,31,0,0]</span>
        <span class="c1">#print &#39;Slab MatInterface Io01&#39;,self.Io[15,31,0,1]</span>
        <span class="c1">#print &#39;Slab MatInterface Io10&#39;,self.Io[15,31,1,0]</span>
        <span class="c1">#print &#39;Slab MatInterface Io11&#39;,self.Io[15,31,1,1]</span>


<span class="k">class</span> <span class="nc">Mat</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Handle constitutive materials dictionnary</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    name : string</span>
<span class="sd">    name character string (default &#39;AIR&#39;)</span>
<span class="sd">    index : int</span>
<span class="sd">    default 1</span>
<span class="sd">    er : complex</span>
<span class="sd">    relative permittivity (w.d) (1+0j)</span>
<span class="sd">    mur : complex</span>
<span class="sd">    relative permeability (w.d) (1+0j)</span>
<span class="sd">    sigma : float</span>
<span class="sd">    conductivity (S/m) 0</span>
<span class="sd">    roughness : float</span>
<span class="sd">    (meter) 0</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Mat.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Mat.__init__.html#pylayers.antprop.slab.Mat.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="o">**</span><span class="n">dm</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>
<span class="sd">        index : int</span>
<span class="sd">        epr : complex</span>
<span class="sd">        mur : complex</span>
<span class="sd">        sigma : float</span>
<span class="sd">        roughness : float</span>

<span class="sd">        a : ITU permittivity parameter </span>
<span class="sd">        b : ITU permittivty exponent parameter </span>
<span class="sd">        c : ITU conductivity parameter</span>
<span class="sd">        d : ITU conductivity exponent parameter</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">        &gt;&gt;&gt; M = Mat(name=&#39;Phantom&#39;,index=17,epr=2+0.15j,mur=1,sigma=4,roughness=0)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;epr&#39;</span><span class="p">:</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.0j</span><span class="p">,</span> 
                 <span class="s1">&#39;mur&#39;</span><span class="p">:</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">0.0j</span><span class="p">,</span> 
                 <span class="s1">&#39;sigma&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
                 <span class="s1">&#39;roughness&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span>
                 <span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;c&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">,</span>
                 <span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="bp">None</span><span class="p">}</span>

        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dm</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dm</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>


        <span class="c1">#MATERIAL ;  a  ; b ;   c  ;  d  ;  fmin ; fmax </span>
        <span class="c1"># ITU-R P2040 Table 3</span>
        <span class="n">ITU_P2040_T3</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;ITU_CONCRETE&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>  <span class="mf">5.31</span>  <span class="p">,</span>  <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0326</span> <span class="p">,</span> <span class="mf">0.8095</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_BRICK&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.75</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.038</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">10</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_PLASTERBOARD&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">2.94</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0116</span> <span class="p">,</span> <span class="mf">0.7076</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_WOOD&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.99</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0047</span> <span class="p">,</span> <span class="mf">1.0718</span> <span class="p">,</span> <span class="mf">0.001</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_GLASS&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">6.27</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0043</span> <span class="p">,</span> <span class="mf">1.1925</span> <span class="p">,</span> <span class="mf">0.1</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_CEILINGBOARD&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">1.50</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0005</span> <span class="p">,</span> <span class="mf">1.1634</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_CHIPBOARD&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">2.58</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0217</span> <span class="p">,</span> <span class="mf">0.7800</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_FLOORBOARD&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">3.66</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.0044</span> <span class="p">,</span> <span class="mf">1.3515</span> <span class="p">,</span> <span class="mi">50</span> <span class="p">,</span> <span class="mi">100</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_VERYDRYGROUND&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">3</span> <span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mf">0.00015</span> <span class="p">,</span> <span class="mf">2.52</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">10</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_MEDIUMDRYGROUND&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">15</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span> <span class="p">,</span> <span class="mf">0.035</span> <span class="p">,</span> <span class="mf">1.63</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">10</span><span class="p">]),</span>
        <span class="s1">&#39;ITU_WETGROUND&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mi">30</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.4</span> <span class="p">,</span> <span class="mf">0.15</span> <span class="p">,</span> <span class="mf">1.30</span> <span class="p">,</span> <span class="mi">1</span> <span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
        <span class="p">}</span>
        <span class="c1"># Parameters a,b,c,d </span>
        <span class="c1"># Table 3 Rec ITU-R P.2040.1</span>
        <span class="c1">#</span>
        <span class="c1"># epsrp  = a * fGHZ ** b </span>
        <span class="c1"># sigma  = c * fGHZ ** d </span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">name</span> <span class="ow">in</span> <span class="n">ITU_P2040_T3</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">abcd</span> <span class="o">=</span> <span class="n">ITU_P2040_T3</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abcd</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abcd</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abcd</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">abcd</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span></div>

<div class="viewcode-block" id="Mat.eval"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Mat.eval.html#pylayers.antprop.slab.Mat.eval">[docs]</a>    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evaluate Mat at given frequencies</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : np.array()</span>
<span class="sd">            frequency (GHz)</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        w = 2*np.pi*f*1e-9</span>
<span class="sd">        eps0 = 8.854e-12</span>

<span class="sd">        100 MHz = 0.1 GHz</span>
<span class="sd">        10 MHz = 0.01 GHz</span>

<span class="sd">        sigma/(w*eps0) = sigma/(2*pi*fGHz*1e9*eps0)</span>
<span class="sd">        sigma/(w*eps0) = sigma/(2*pi*fGHz*1e9*8.854e-12)</span>
<span class="sd">        sigma/(w*eps0) = sigma/(2*pi*fGHz*1e-3*8.854)</span>
<span class="sd">        sigma/(w*eps0) = 17.98 * sigma/fGHz</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#self[&#39;fGHz&#39;] = fGHz</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">epsc</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1j</span> <span class="o">*</span> <span class="mf">17.98</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">])</span> <span class="o">/</span>  <span class="n">fGHz</span>
        <span class="k">else</span><span class="p">:</span> <span class="c1"># from P.2040</span>
            <span class="n">epsr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">fGHz</span><span class="o">**</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
            <span class="n">sigma</span>  <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">fGHz</span><span class="o">**</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
            <span class="n">epsc</span> <span class="o">=</span> <span class="n">epsr</span> <span class="o">-</span> <span class="mi">1j</span> <span class="o">*</span> <span class="mf">17.98</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">/</span>  <span class="n">fGHz</span>

        <span class="k">return</span><span class="p">(</span><span class="n">epsc</span><span class="p">)</span></div>

<div class="viewcode-block" id="Mat.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Mat.info.html#pylayers.antprop.slab.Mat.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display material properties</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;---------------------------------&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">])</span></div>
        <span class="c1">#print &quot; &quot;</span>
        <span class="c1">#print &quot;name : &quot;,self.name</span>
        <span class="c1">#print &quot;index :&quot;,self.index</span>
        <span class="c1">#print &quot;epr :&quot;,self.epr</span>
        <span class="c1">#print &quot;mur : &quot;,self.mur</span>
        <span class="c1">#print &quot;sigma :&quot;,self.sigma</span>
        <span class="c1">#print &quot;roughness : &quot;,self.roughness</span>

<div class="viewcode-block" id="Mat.R"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Mat.R.html#pylayers.antprop.slab.Mat.R">[docs]</a>    <span class="k">def</span> <span class="nf">R</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate Reflection coefficient on the air|mat interface</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : frequency GHz</span>
<span class="sd">        theta : incidence angle referenced from interface normal</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Ro,Rp : orthogonal and parallel Reflexion coefficient</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">air</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="s1">&#39;AIR&#39;</span><span class="p">)</span>
        <span class="n">lmat</span> <span class="o">=</span> <span class="p">[</span><span class="n">air</span><span class="p">,</span> <span class="bp">self</span><span class="p">]</span>

        <span class="n">Nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span>
        <span class="n">Nt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">theta</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">fGHz</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nf</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">theta</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nt</span><span class="p">)</span>
        <span class="n">II</span> <span class="o">=</span> <span class="n">MatInterface</span><span class="p">(</span><span class="n">lmat</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">II</span><span class="o">.</span><span class="n">RT</span><span class="p">()</span>
        <span class="n">Ro</span> <span class="o">=</span> <span class="n">II</span><span class="o">.</span><span class="n">Ro</span>
        <span class="n">Rp</span> <span class="o">=</span> <span class="n">II</span><span class="o">.</span><span class="n">Rp</span>

        <span class="k">return</span> <span class="n">Ro</span><span class="p">,</span> <span class="n">Rp</span></div>


<span class="k">class</span> <span class="nc">MatDB</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; MatDB Class : Material database</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    di : dict</span>
<span class="sd">    associate numeric and alphanumeric keys</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MatDB.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.__init__.html#pylayers.antprop.slab.MatDB.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">_fileini</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">dm</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _fileini : string</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        There are 2 ways to load a MatDB either from a file or a dict.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_fileini</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fileini</span> <span class="o">=</span> <span class="n">_fileini</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_fileini</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">matname</span> <span class="ow">in</span> <span class="n">dm</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="s1">&#39;name&#39;</span> <span class="ow">in</span> <span class="n">dm</span><span class="p">[</span><span class="n">matname</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">dm</span><span class="p">[</span><span class="n">matname</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
                <span class="n">M</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">matname</span><span class="p">,</span><span class="o">**</span><span class="n">dm</span><span class="p">[</span><span class="n">matname</span><span class="p">])</span>
                <span class="c1">#ddm = dm[matname]</span>
                <span class="c1"># fill each field of the dict </span>
                <span class="c1">#for k in ddm:</span>
                <span class="c1">#    M[k] = dm[matname][k]</span>
                <span class="c1"># update the MatDB with M</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">matname</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span></div>


    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;List of Materials&#39;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;_fileini&#39;</span><span class="p">):</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">+</span> <span class="s1">&#39;from &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_fileini</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">+</span><span class="s1">&#39;-------------------</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">epsr</span>  <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;epr&#39;</span><span class="p">])</span>
            <span class="n">sigma</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="s1">&#39;sigma&#39;</span><span class="p">])</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="s1">&#39;|epsr|=&#39;</span><span class="o">+</span> <span class="n">epsr</span> <span class="o">+</span><span class="s1">&#39; sigma (S/m)=&#39;</span><span class="o">+</span><span class="n">sigma</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>


<div class="viewcode-block" id="MatDB.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.info.html#pylayers.antprop.slab.MatDB.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; get MatDB info</span>

<span class="sd">        TODO : make a __repr__</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">S</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">S</span><span class="o">.</span><span class="n">info</span><span class="p">()</span></div>

<div class="viewcode-block" id="MatDB.delete"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.delete.html#pylayers.antprop.slab.MatDB.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Delete a material in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="MatDB.edit"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.edit.html#pylayers.antprop.slab.MatDB.edit">[docs]</a>    <span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Edit a material in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : vstring</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">,</span> <span class="s1">&#39;Enter&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;epr&#39;</span><span class="p">,</span> <span class="s1">&#39;mur&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;roughness&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">epr</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">mur</span><span class="p">),</span> <span class="n">M</span><span class="o">.</span><span class="n">sigma</span><span class="p">,</span> <span class="n">M</span><span class="o">.</span><span class="n">roughness</span><span class="p">))</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span></div>
        <span class="c1"># update keys association dictionnary</span>

<div class="viewcode-block" id="MatDB.add"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.add.html#pylayers.antprop.slab.MatDB.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add a material in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>
<span class="sd">            material name</span>
<span class="sd">        cval : float or complex</span>
<span class="sd">            epsilon or index</span>
<span class="sd">        sigma : float or complex</span>
<span class="sd">            conductivity</span>
<span class="sd">        mur : float</span>
<span class="sd">            relative permeability</span>
<span class="sd">        typ : string</span>
<span class="sd">            {&#39;epsr&#39;|&#39;ind&#39;|,&#39;reim&#39;,|&#39;THz&#39;|&#39;itu&#39;}</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        Different ways to enter a material are :</span>

<span class="sd">        i) &#39;epsr&#39; : epsr and sigma</span>

<span class="sd">        cval = epsr</span>
<span class="sd">        sigma = sigma</span>

<span class="sd">        ii) &#39;ind&#39; : indice @ fGHz</span>

<span class="sd">        cval = indice</span>

<span class="sd">        iii) &#39;reim&#39; : real(epsr) and imag(epsr) @fGHz</span>

<span class="sd">        iv) &#39;THz&#39;</span>

<span class="sd">        v) ITU parameter (a,b,c,d)</span>
<span class="sd">            </span>



<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">        &gt;&gt;&gt; m = MatDB()</span>
<span class="sd">        &gt;&gt;&gt; m.load(&#39;matDB.ini&#39;)</span>
<span class="sd">        &gt;&gt;&gt; m.add(name=&#39;ConcreteJcB&#39;,cval=3.5+0*1j,alpha_cmm1=1.9,fGHz=120,typ=&#39;THz&#39;)</span>
<span class="sd">        &gt;&gt;&gt; m.add(name=&#39;GlassJcB&#39;,cval=3.5+0*1j,alpha_cmm1=1.9,fGHz=120,typ=&#39;THz&#39;)</span>
<span class="sd">        &gt;&gt;&gt; out = m.save(&#39;Jacob.ini&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span><span class="s1">&#39;MAT&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;cval&#39;</span><span class="p">:</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="o">*</span><span class="mi">1j</span><span class="p">,</span>
                    <span class="s1">&#39;sigma&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
                    <span class="s1">&#39;alpha_cmm1&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;mur&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;fGHz&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                    <span class="s1">&#39;typ&#39;</span><span class="p">:</span><span class="s1">&#39;epsr&#39;</span>
                   <span class="p">}</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">defaults</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="n">defaults</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="c1"># get the next available index</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;epsr&#39;</span><span class="p">:</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cval&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;reim&#39;</span><span class="p">:</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cval&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">])</span> <span class="c1"># warning check causality</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">17.98</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span>  <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cval&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cval&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epsr&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">17.98</span>
        <span class="c1">#</span>
        <span class="c1"># Terahertz Dielectric Properties of Polymers Yun-Sik Jin</span>
        <span class="c1"># Terahertz characterization of building materials (R.Piesiewicz) El.Jou Jan 2005 Vol 41 N18</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;THz&#39;</span><span class="p">:</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cval&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;alpha_cmm1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;alpha_cmm1&#39;</span><span class="p">]</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;alpha_cmm1&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;kappa&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">])</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;fGHz&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">17.98</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1j</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr2&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;typ&#39;</span><span class="p">]</span>  <span class="o">==</span> <span class="s1">&#39;itu&#39;</span><span class="p">:</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">d</span>

        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">M</span></div>
        <span class="c1"># updating dictionnary</span>

<div class="viewcode-block" id="MatDB.addgui"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.addgui.html#pylayers.antprop.slab.MatDB.addgui">[docs]</a>    <span class="k">def</span> <span class="nf">addgui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;MAT&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Add a material in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>
<span class="sd">        default &#39;MAT&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#max = self.maxindex()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">multenterbox</span><span class="p">(</span><span class="s1">&#39;Material&#39;</span><span class="p">,</span> <span class="s1">&#39;Enter&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;epr&#39;</span><span class="p">,</span> <span class="s1">&#39;mur&#39;</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">,</span> <span class="s1">&#39;roughness&#39;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;(1+0j)&#39;</span><span class="p">,</span> <span class="s1">&#39;(1+0j)&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
        <span class="n">M</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span></div>


<div class="viewcode-block" id="MatDB.choose"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.choose.html#pylayers.antprop.slab.MatDB.choose">[docs]</a>    <span class="k">def</span> <span class="nf">choose</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Choose a mat from matdir</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">tkFileDialog</span>
        <span class="n">FD</span> <span class="o">=</span> <span class="n">tkFileDialog</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">FD</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">(</span><span class="n">filetypes</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;Mat file &quot;</span><span class="p">,</span> <span class="s2">&quot;*.ini&quot;</span><span class="p">),</span>
                                                 <span class="p">(</span><span class="s2">&quot;All&quot;</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">)],</span>
                                      <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Please choose a Material .ini file&quot;</span><span class="p">,</span>
                                      <span class="n">initialdir</span><span class="o">=</span><span class="n">matdir</span><span class="p">)</span>
        <span class="n">_filename</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getshort</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">_filename</span><span class="p">)</span></div>



<div class="viewcode-block" id="MatDB.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.load.html#pylayers.antprop.slab.MatDB.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">_fileini</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a Material from a .ini file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _fileini : string</span>
<span class="sd">            name of the matDB file (usually matDB.ini)</span>

<span class="sd">        TODO</span>
<span class="sd">        ----</span>

<span class="sd">        add ITU format (abcd)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fileini</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_fileini</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRMAT&#39;</span><span class="p">])</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="n">materials</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fileini</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">matname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">sections</span><span class="p">()):</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">matname</span><span class="p">)</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">matname</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">))</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;roughness&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">matname</span><span class="p">,</span><span class="s1">&#39;roughness&#39;</span><span class="p">))</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">matname</span><span class="p">,</span><span class="s1">&#39;epr&#39;</span><span class="p">))</span>
            <span class="n">M</span><span class="p">[</span><span class="s1">&#39;mur&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">materials</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">matname</span><span class="p">,</span><span class="s1">&#39;mur&#39;</span><span class="p">))</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">matname</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span></div>

<div class="viewcode-block" id="MatDB.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.MatDB.save.html#pylayers.antprop.slab.MatDB.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">_fileini</span><span class="o">=</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; save MatDB in an ini file</span>

<span class="sd">        [dict]</span>
<span class="sd">        id1 = name1</span>
<span class="sd">        [name1]</span>
<span class="sd">        epsr =</span>
<span class="sd">        mur =</span>
<span class="sd">        sigma = </span>
<span class="sd">        roughness =</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fileini</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_fileini</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRMAT&#39;</span><span class="p">])</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileini</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># config names</span>
        <span class="c1">#</span>
        <span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;epr&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;epr&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;epr&quot;</span><span class="p">,</span> <span class="s1">&#39;(9+0j)&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;mur&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;mur&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;mur&quot;</span><span class="p">,</span> <span class="s1">&#39;(1+0j)&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;sigma&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="s1">&#39;(0+0j)&#39;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;roughness&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;roughness&#39;</span><span class="p">]))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;roughness&quot;</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>

        <span class="n">config</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<span class="k">class</span> <span class="nc">Slab</span><span class="p">(</span><span class="n">Interface</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Handle a Slab</span>

<span class="sd">    Summary</span>
<span class="sd">    -------</span>

<span class="sd">    A Slab is a sequence of layers which have</span>

<span class="sd">    - a given width</span>
<span class="sd">    - a given material from the material DB</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    name :</span>
<span class="sd">        Slab name</span>
<span class="sd">    nbmat :</span>
<span class="sd">        Number of layers</span>
<span class="sd">    index :</span>
<span class="sd">        Slab Index</span>
<span class="sd">    lmatname :</span>
<span class="sd">        list of material name</span>
<span class="sd">    lthick :</span>
<span class="sd">        list of thickness of layers</span>
<span class="sd">    color :</span>
<span class="sd">        color of slab dor display</span>
<span class="sd">    linewidth :</span>
<span class="sd">        linewidth for structure display</span>
<span class="sd">    mat : Associated Material Database</span>

<span class="sd">    evaluated : Boolean</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="Slab.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.__init__.html#pylayers.antprop.slab.Slab.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">matDB</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>
<span class="sd">            slab name</span>
<span class="sd">        matDB : MatDB</span>
<span class="sd">            material database</span>
<span class="sd">        ds  : dict </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if not specified choose default material database</span>
        <span class="c1">#super(Slab,self).__init__()</span>
        <span class="n">Interface</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1">#if mat==[]:</span>
        <span class="c1">#    self.mat = MatDB()</span>
        <span class="c1">#else:</span>
        <span class="c1">#    self.mat = mat</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">ds</span><span class="o">==</span><span class="p">{}:</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AIR&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="n">matDB</span><span class="o">!=</span><span class="p">[]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="n">matDB</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; dictionnary setter</span>

<span class="sd">        lmatname can be changed and lthick is imposed @ 5cm per layer</span>
<span class="sd">        lthick   can be changed provided the number of layer is correct</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;lmatname&quot;</span><span class="p">:</span>
            <span class="n">nbmat</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="c1">#for na in value:</span>
            <span class="c1">#    if na not in self.mat:</span>
            <span class="c1">#        print(self.mat.__repr__())</span>
            <span class="c1">#        raise ValueError(na+ &#39; not in material Database&#39;)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;lmatname&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="c1">#dict.__setitem__(self,&quot;nbmat&quot;,nbmat)</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;lthick&quot;</span><span class="p">,[</span><span class="mf">0.05</span><span class="p">]</span><span class="o">*</span><span class="n">nbmat</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;lthick&quot;</span><span class="p">:</span>
            <span class="c1">#pdb.set_trace()</span>
            <span class="c1">#if len(value)!=len(self[&#39;lmatname&#39;]):</span>
            <span class="c1">#    raise ValueError(&quot;wrong number of material layers&quot;)</span>
            <span class="c1">#else:</span>
            <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s2">&quot;lthick&quot;</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>        
            <span class="nb">dict</span><span class="o">.</span><span class="n">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">u</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This function makes the addition between 2 Slabs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        u : Slab </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">Slab</span><span class="p">(</span><span class="n">name</span><span class="p">,[])</span>
        <span class="c1"># lmatname should be modified before lthick</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]</span> 
        <span class="c1">#for i in range(len(U[&#39;lmatname&#39;])):</span>
        <span class="c1">#    namem = U[&#39;lmatname&#39;][i]</span>
        <span class="c1">#U.conv(matDB)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>

<div class="viewcode-block" id="Slab.__repr__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.__repr__.html#pylayers.antprop.slab.Slab.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">st</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39; : &#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="s1">&#39; | &#39;</span><span class="o">+</span><span class="n">y</span><span class="p">,</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39; | &#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s1">&#39;       &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39; &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span>  <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s1">&#39;       epr :&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="s1">&#39;epr&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;    sigma : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]:</span>
            <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span>
            <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;f(GHz) : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nf</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>

                <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;f(GHz) : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

            <span class="k">if</span> <span class="n">nt</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">st</span><span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;theta (rad) : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nt</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;theta (rad) : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slab.info"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.info.html#pylayers.antprop.slab.Slab.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; display Slab Info</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">            &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">            &gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; lmatname = [&#39;PLATRE-57GHz&#39;,&#39;AIR&#39;,&#39;PLATRE-57GHz&#39;]</span>
<span class="sd">            &gt;&gt;&gt; lthick = [0.018,0.03,0.018]</span>
<span class="sd">            &gt;&gt;&gt; sl.add(&#39;placo&#39;,lmatname,lthick)</span>
<span class="sd">            &gt;&gt;&gt; theta = np.arange(0,np.pi/2,0.01)</span>
<span class="sd">            &gt;&gt;&gt; fGHz = np.array([57.5])</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;placo&#39;].eval(fGHz,theta)</span>
<span class="sd">            &gt;&gt;&gt; fig,ax=sl[&#39;placo&#39;].plotwrt(var=&#39;a&#39;,typ=[&#39;m&#39;])</span>
<span class="sd">            &gt;&gt;&gt; plt.ion()</span>
<span class="sd">            &gt;&gt;&gt; plt.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;------------&quot;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;name : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;nbmat : &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]))</span>
        <span class="n">chaine</span> <span class="o">=</span> <span class="s2">&quot;[ &quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]:</span>
                <span class="n">epsrc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;epsrc : &quot;</span><span class="p">,</span> <span class="n">epsrc</span><span class="p">)</span>
            <span class="n">chaine</span> <span class="o">=</span> <span class="n">chaine</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
            <span class="n">chaine</span> <span class="o">=</span> <span class="n">chaine</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;color : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">])</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;linewidth :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&quot;---------------------&quot;</span><span class="p">)</span>
                <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">)</span>
                <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">nf</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;f (GHz) : &quot;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nf</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;f (GHz) : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">nt</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;theta : &quot;</span><span class="p">,</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">nt</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;th (rad) : &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<div class="viewcode-block" id="Slab.conv"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.conv.html#pylayers.antprop.slab.Slab.conv">[docs]</a>    <span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">matDB</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; build the Slab list of materials lmat</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">matname</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]:</span>
            <span class="n">mi</span> <span class="o">=</span> <span class="n">matDB</span><span class="p">[</span><span class="n">matname</span><span class="p">]</span> 
            <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mi</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">]),</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span><span class="n">compensate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">RT</span><span class="o">=</span><span class="s1">&#39;RT&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; evaluation of the Slab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : frequency GHz ( np.array([1.0]) )</span>
<span class="sd">        theta : np.array</span>
<span class="sd">            incidence angle (from normal) radians</span>
<span class="sd">        compensate : boolean</span>
<span class="sd">        RT : string </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">fGHz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">fGHz</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">])</span>
        <span class="n">theta_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fGHz</span> <span class="o">=</span> <span class="n">fGHz</span>
        <span class="n">theta_in</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">nf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span>
        <span class="n">nt</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="c1">#thetai = theta[0]</span>
        <span class="c1">#thetaf = theta[-1]</span>
        <span class="c1">### WARNING thetas can be NOT sorted.</span>
        <span class="c1">### thetai should be min(theta)</span>
        <span class="c1">### thetaf should be max(theta)</span>
        <span class="c1">#th1 = np.linspace(thetai,thetaf,nt)</span>

        <span class="n">metalic</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">name1</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mat</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">])</span>
        <span class="n">name2</span> <span class="o">=</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">thick</span><span class="p">)</span> <span class="k">for</span> <span class="n">thick</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">])</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">name1</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="o">+</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">name2</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
        <span class="c1">#super(Slab,self).__init__(fGHz=fGHz, theta=theta, name=name)</span>
        <span class="n">Interface</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="c1">#self.lmat = lmat</span>
        <span class="c1">#self.lthick = lthick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">2</span>

        <span class="c1">#nf = len(fGHz)</span>
        <span class="c1">#nt = np.shape(self.theta)[1]</span>

        <span class="n">Co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">Co</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Co</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># _Co= np.eye(2,dtype=complex)</span>



        <span class="n">Cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">Cp</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">Cp</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1"># _Cp = np.eye(2,dtype=complex)</span>
        <span class="c1">#</span>
        <span class="c1"># loop over the s n-1 materials </span>
        <span class="c1"># lmat[0] est toujours l&#39;air ( modifier)</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># first material is AIR</span>
                <span class="n">ml</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="s1">&#39;AIR&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ml</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">][</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">mr</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="s1">&#39;AIR&#39;</span><span class="p">)</span> <span class="c1"># last material is AIR</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mr</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">mr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;METAL&#39;</span><span class="p">:</span>
                <span class="n">Io</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
                <span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">Io</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="c1"># _Io=np.eye(2,dtype=complex)+np.eye(2)-1</span>
                <span class="n">Ip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nf</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nt</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
                <span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">Ip</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># _Ip=np.eye(2,dtype=complex)+np.eye(2)-1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">II</span> <span class="o">=</span> <span class="n">MatInterface</span><span class="p">([</span><span class="n">ml</span><span class="p">,</span> <span class="n">mr</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">II</span> <span class="o">=</span> <span class="n">MatInterface</span><span class="p">([</span><span class="n">ml</span><span class="p">,</span> <span class="n">mr</span><span class="p">],</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
            <span class="c1">#</span>
            <span class="c1"># chains the angle, theta can be complex</span>
            <span class="c1">#</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">II</span><span class="o">.</span><span class="n">theta</span>
            <span class="c1">#</span>
            <span class="c1"># theta depends on frequency f x th</span>
            <span class="c1">#</span>
            <span class="c1"># THETA = II.THETA</span>

                <span class="n">Io</span> <span class="o">=</span> <span class="n">II</span><span class="o">.</span><span class="n">Io</span>
                <span class="n">Ip</span> <span class="o">=</span> <span class="n">II</span><span class="o">.</span><span class="n">Ip</span>

            <span class="c1">#</span>
            <span class="c1"># dot product Co.Io and Cp.Ip</span>
            <span class="c1">#</span>
            <span class="c1"># old version (keep it for demonstation)</span>
            <span class="c1"># -----------</span>
            <span class="c1">#for kf in range(nf):</span>
            <span class="c1"># for kt in range(nt):</span>
            <span class="c1"># T = np.dot(Co[kf,kt,:,:],Io[kf,kt,:,:])</span>
            <span class="c1"># Co[kf,kt,:,:] = T</span>
            <span class="c1"># U = np.dot(Cp[kf,kt,:,:],Ip[kf,kt,:,:])</span>
            <span class="c1"># Cp[kf,kt,:,:] = U</span>
            <span class="c1">#</span>
            <span class="c1"># Using Einstein summation instead of a for loop increases speed by an order of magnitude</span>
            <span class="c1">#</span>

            <span class="c1"># Co = np.einsum(&#39;ijkl,ijln-&gt;ijkn&#39;, Co, Io)</span>
            <span class="c1"># Cp = np.einsum(&#39;ijkl,ijln-&gt;ijkn&#39;, Cp, Ip)</span>


            <span class="c1">### array broadcasing version , new increased speed in regard of einsum</span>
            <span class="n">Co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Co</span><span class="p">[</span><span class="o">...</span><span class="p">,:,:,</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">Io</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="bp">None</span><span class="p">,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">Cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Cp</span><span class="p">[</span><span class="o">...</span><span class="p">,:,:,</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">Ip</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="bp">None</span><span class="p">,:,:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>


            <span class="k">if</span> <span class="n">mr</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;METAL&#39;</span><span class="p">:</span>
                <span class="n">metalic</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Io</span> <span class="o">=</span> <span class="n">Co</span>
        <span class="c1"># attempt to fix bug </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ip</span> <span class="o">=</span> <span class="n">Cp</span>
        <span class="c1">#self.Ip = -Cp</span>
        
        <span class="c1"># evaluate reflection and transmission matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RT</span><span class="p">(</span><span class="n">metalic</span><span class="p">,</span><span class="n">RT</span><span class="o">=</span><span class="n">RT</span><span class="p">)</span>
<span class="c1"># if compensate:</span>
<span class="c1"># fGHz = fGHz.reshape(nf,1,1,1)</span>
<span class="c1"># th1 = th1.reshape(1,nt,1,1)</span>
<span class="c1"># thickness = sum(self[&#39;lthick&#39;])</span>
<span class="c1"># d = thickness*np.cos(th1)</span>
<span class="c1"># self.T = self.T*np.exp(1j*2*np.pi*fGHz*d/0.3)</span>


        <span class="c1"># Modification probably not compliant with coverage !!!!</span>
        <span class="c1"># TODO !!!</span>
        <span class="k">if</span> <span class="n">compensate</span><span class="p">:</span>
            <span class="n">thickness</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">])</span>
            <span class="c1">#pdb.set_trace()</span>
            <span class="c1">#d = thickness*np.cos(theta)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">thickness</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta_in</span><span class="p">[</span><span class="bp">None</span><span class="p">,:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span>
                                    <span class="n">fGHz</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                                    <span class="o">*</span><span class="n">d</span><span class="p">[:,:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
                                    <span class="o">/</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c1"># if &#39;T&#39; in RT:</span>
<span class="c1"># epr = [m[&#39;epr&#39;] for m in self[&#39;lmat&#39;]]</span>
<span class="c1"># epr = sum(epr)</span>
<span class="c1"># # theta[0] just for 1 freq</span>
<span class="c1"># self.costt = np.sqrt((epr-1+np.cos(theta[0])**2)/epr)</span>
<span class="c1"># self.sm = sum(self[&#39;lthick&#39;])/self.costt</span>
<span class="c1"># self.gamma = np.cos(theta[0])/self.costt</span>
<span class="c1"># self.alpha = np.array(([1./epr]),dtype=complex)</span>



        <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

<div class="viewcode-block" id="Slab.filter"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.filter.html#pylayers.antprop.slab.Slab.filter">[docs]</a>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">win</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; filtering waveform</span>

<span class="sd">        Warning</span>
<span class="sd">        -------</span>

<span class="sd">        Not implemented yet</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        win : Waveform</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        wout : Waveform</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get frequency base of the waveform</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">win</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span>
        <span class="n">wout</span> <span class="o">=</span> <span class="n">Wafeform</span><span class="p">()</span>
        <span class="k">return</span><span class="p">(</span><span class="n">wout</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slab.excess_grdelay"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.excess_grdelay.html#pylayers.antprop.slab.Slab.excess_grdelay">[docs]</a>    <span class="k">def</span> <span class="nf">excess_grdelay</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">2.4</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot; calculate transmission excess delay in ns</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : array</span>
<span class="sd">        default arange(2.4,4,0.1)</span>
<span class="sd">        theta : default 0</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        delayo : excess delay polarization o</span>
<span class="sd">        delayp : excess delay polarization p</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        #&gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">        #&gt;&gt;&gt; from matplotlib.pylab import *</span>
<span class="sd">        #&gt;&gt;&gt; import numpy as np</span>
<span class="sd">        #&gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">        #&gt;&gt;&gt; s1 = sl[&#39;PARTITION&#39;]</span>
<span class="sd">        #&gt;&gt;&gt; fGHz = np.arange(3.1,10.6,0.1)</span>
<span class="sd">        #&gt;&gt;&gt; delayo,delayp = s1.excess_grdelay(fGHz,0)</span>
<span class="sd">        #&gt;&gt;&gt; lineo = plt.plot(fGHz[0:-1],delayo)</span>
<span class="sd">        #&gt;&gt;&gt; linep = plt.plot(fGHz[0:-1],delayp)</span>
<span class="sd">        #&gt;&gt;&gt; plt.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fGHz</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span> <span class="p">,</span> <span class="s2">&quot;fGHz too short needs more than one frequency point&quot;</span>

        <span class="n">df</span> <span class="o">=</span> <span class="n">fGHz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">fGHz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span><span class="n">compensate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c1"># f x th x p x q</span>
        <span class="n">T</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T</span>

        <span class="n">To</span> <span class="o">=</span> <span class="n">T</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Tp</span> <span class="o">=</span> <span class="n">T</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">ao</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">To</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">Tp</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">delayo</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ao</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">df</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">delayp</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ap</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">df</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">delayo</span><span class="p">,</span><span class="n">delayp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slab.tocolor"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.tocolor.html#pylayers.antprop.slab.Slab.tocolor">[docs]</a>    <span class="k">def</span> <span class="nf">tocolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.4</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot;  convert slab properrties into a color</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : np.array</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s1 = sl[&#39;PARTITION&#39;]</span>
<span class="sd">        &gt;&gt;&gt; col24 = s1.tocolor(np.array([2.4]))</span>
<span class="sd">        &gt;&gt;&gt; fGHz = np.arange(0.5,8,100)</span>
<span class="sd">        &gt;&gt;&gt; col8 = s1.tocolor(fGHz)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span><span class="n">compensate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">Interface</span><span class="o">.</span><span class="n">tocolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">color</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slab.loss0"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.loss0.html#pylayers.antprop.slab.Slab.loss0">[docs]</a>    <span class="k">def</span> <span class="nf">loss0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="mf">2.4</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; calculate loss for theta=0 at frequency (fGHz)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : frequency (GHz) np.array()</span>
<span class="sd">        default 2.4</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Lo : np.array</span>
<span class="sd">        Loss at 0 deg polarization ortho</span>
<span class="sd">        Lp : np.array</span>
<span class="sd">        Loss at 0 deg polarization para</span>



<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">        &gt;&gt;&gt; sl = SlabDB(&#39;matDB.ini&#39;,&#39;slabDB.ini&#39;)</span>
<span class="sd">        &gt;&gt;&gt; s1 = sl[&#39;AIR&#39;]</span>
<span class="sd">        &gt;&gt;&gt; Lo,Lp = s1.loss0(2.4)</span>
<span class="sd">        &gt;&gt;&gt; assert (np.allclose(Lo[0],0)),&#39;Problem with AIR slab loss&#39;</span>
<span class="sd">        &gt;&gt;&gt; assert (np.allclose(Lo[0],Lp[0])),&#39;something wrong with polarization&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">]),</span><span class="n">compensate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span> <span class="o">=</span> <span class="n">Interface</span><span class="o">.</span><span class="n">loss0</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span><span class="p">)</span></div>

<div class="viewcode-block" id="Slab.losst"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.losst.html#pylayers.antprop.slab.Slab.losst">[docs]</a>    <span class="k">def</span> <span class="nf">losst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Calculate loss w.r.t angle and frequency</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : np.array()</span>
<span class="sd">        frequency (GHz)</span>

<span class="sd">        theta : np.array</span>
<span class="sd">        theta angle (radians)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        Lo : np.array</span>
<span class="sd">        Loss orthogonal</span>

<span class="sd">        Lp : np.array</span>
<span class="sd">        Loss paralell</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># for backward compatibility</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">==</span><span class="nb">float</span><span class="p">:</span>
            <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span> <span class="o">=</span> <span class="n">Interface</span><span class="o">.</span><span class="n">losst</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">Lo</span><span class="p">,</span> <span class="n">Lp</span><span class="p">)</span></div>


<div class="viewcode-block" id="Slab.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.Slab.show.html#pylayers.antprop.slab.Slab.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="mf">2.4</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="n">dB</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show slab Reflection and Transmission coefficient</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        fGHz : float</span>
<span class="sd">        theta : np.array</span>
<span class="sd">        dtype :</span>
<span class="sd">        display : string</span>
<span class="sd">        {&#39;modulus&#39;}</span>
<span class="sd">        dB : boolean</span>
<span class="sd">        False</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]:</span>
            <span class="n">fig</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">plotwrt</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="n">typ</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;l20&#39;</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span></div>


<span class="k">class</span> <span class="nc">SlabDB</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Slab data base</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    DB : slab dictionnary</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SlabDB.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.__init__.html#pylayers.antprop.slab.SlabDB.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fileslab</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">filemat</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="p">{},</span><span class="n">dm</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        filemat : string</span>
<span class="sd">        fileslab : string</span>
<span class="sd">        ds : dict </span>
<span class="sd">            slab dict read from layout file. if ds == {}   load from files</span>
<span class="sd">        dm : dict </span>
<span class="sd">            mat dict read from layout file. </span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        There are two ways to initialize a SlabDB either from dict ds and dm usually read </span>
<span class="sd">        in  the </span>
<span class="sd">        Layout file .ini or from 2 specified file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="c1"># Load from file</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">fileslab</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fileslab</span> <span class="o">=</span> <span class="n">fileslab</span>
            <span class="k">if</span> <span class="n">filemat</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filemat</span> <span class="o">=</span> <span class="n">filemat</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">(</span><span class="n">filemat</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">(</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fileslab</span><span class="p">)</span>
        <span class="c1"># Load from dict </span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">assert</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dm</span><span class="p">)</span><span class="o">==</span><span class="nb">dict</span><span class="p">)</span>
            <span class="k">assert</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span><span class="o">==</span><span class="nb">dict</span><span class="p">)</span>
            <span class="c1"># copier le contenu du load ici </span>
            <span class="c1">#self.update(ds)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">(</span><span class="n">dm</span><span class="o">=</span><span class="n">dm</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">slabname</span> <span class="ow">in</span> <span class="n">ds</span><span class="p">:</span>
                <span class="c1"># create slab slabname from ds</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">Slab</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">,</span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="n">slabname</span><span class="p">])</span>
                <span class="c1"># </span>
                <span class="c1">#for k in ds[slabname]:</span>
                <span class="c1">#    S[k] = ds[slabname][k]</span>
                <span class="c1">#S[&#39;nmat&#39;]=len(ds[slabname][&#39;lmatname&#39;])</span>
                <span class="c1">#S.conv()</span>
                <span class="c1"># add slab to SlabDB</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">slabname</span><span class="p">]</span><span class="o">=</span><span class="n">S</span></div>


    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s1">&#39;List of Slabs</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s1">&#39;-----------------------------&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="bp">self</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
        <span class="c1">#    S.info()</span>
        <span class="c1">#st =      &quot;Slab file name     : &quot; + self.fileslab+ &#39;\n&#39;</span>
        <span class="c1">#st = st + &quot;Material file name : &quot; +  self.mat.fileini+&#39;\n&#39;</span>
        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; slabDB contains slab</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;str&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;Slab&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sl</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add new slab to a slabDB or new slabDB to slabDB</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># defaults = {&#39;name&#39;:&#39;MAT&#39;,</span>
        <span class="c1">#             &#39;cval&#39;:1+0*1j,</span>
        <span class="c1">#             &#39;sigma&#39;:0,</span>
        <span class="c1">#             &#39;alpha_cmm1&#39;:1,</span>
        <span class="c1">#             &#39;mur&#39;:1,</span>
        <span class="c1">#             &#39;fGHz&#39;:1,</span>
        <span class="c1">#             &#39;typ&#39;:&#39;epsr&#39;</span>
        <span class="c1">#            }</span>


        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="n">Slab</span><span class="o">.</span><span class="n">__name__</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">sl</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
                <span class="c1">#Â check if material is in the self.mat</span>
                <span class="c1">#Â otherwise add it</span>
                <span class="n">lmatname</span> <span class="o">=</span> <span class="n">sl</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span>
                <span class="n">mat_exist</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">lmatname</span><span class="p">]</span>
                <span class="c1">#Â add material if not exist in MatDB</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="o">**</span><span class="n">sl</span><span class="p">[</span><span class="s1">&#39;lmat&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> 
                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lmatname</span><span class="p">))</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">mat_exist</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="bp">self</span><span class="p">[</span><span class="n">sl</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]]</span><span class="o">=</span><span class="n">sl</span>

        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="o">==</span> <span class="n">SlabDB</span><span class="o">.</span><span class="n">__name__</span><span class="p">:</span>
            <span class="k">pass</span>

<div class="viewcode-block" id="SlabDB.showall"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.showall.html#pylayers.antprop.slab.SlabDB.showall">[docs]</a>    <span class="k">def</span> <span class="nf">showall</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show all slabs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lsl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lsl</span><span class="p">)</span>
        <span class="n">nl</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">cpt</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">lsl</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


<div class="viewcode-block" id="SlabDB.delete"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.delete.html#pylayers.antprop.slab.SlabDB.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete an element from the database</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__delitem__</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="SlabDB.edit"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.edit.html#pylayers.antprop.slab.SlabDB.edit">[docs]</a>    <span class="k">def</span> <span class="nf">edit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; edit a Slab in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">edit</span><span class="p">()</span></div>

<div class="viewcode-block" id="SlabDB.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.show.html#pylayers.antprop.slab.SlabDB.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;WOOD&#39;</span><span class="p">,</span> <span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.4</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot; evaluate and show a given slab</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name : string</span>
<span class="sd">        fGHz : np.array</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="n">slab</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="o">=</span><span class="n">fGHz</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">slab</span><span class="o">.</span><span class="n">M</span><span class="o">.</span><span class="n">plotwrt</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax</span></div>


<div class="viewcode-block" id="SlabDB.add"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.add.html#pylayers.antprop.slab.SlabDB.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">lmatname</span><span class="p">,</span> <span class="n">lthick</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add a slab from its properties</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        name       : string</span>
<span class="sd">        lmatname   : list of mat name</span>
<span class="sd">        lthick     : list ot float</span>
<span class="sd">           list of layer thickness in meters</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        Examples from the paper:</span>

<span class="sd">        &quot;Reflection and Transmission Properties of Building Materials in D-Band</span>
<span class="sd">        for Modeling Future mm-Wave Communication Systems &quot;</span>
<span class="sd">        Martin Jacob and Thomas Kurner and Robert Geise and Radoslaw Piesiewicz</span>
<span class="sd">        EUCAP 2010</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>


<span class="sd">            &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; import matplotlib.pylab as plt</span>
<span class="sd">            &gt;&gt;&gt; sl = SlabDB(filemat=&#39;matDB.ini&#39;,fileslab=&#39;slabDB.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.mat.add(name=&#39;ConcreteJc&#39;,cval=3.5,alpha_cmm1=1.9,fGHz=120,typ=&#39;THz&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.mat.add(name=&#39;GlassJc&#39;,cval=2.55,alpha_cmm1=2.4,fGHz=120,typ=&#39;THz&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.add(&#39;ConcreteJc&#39;,[&#39;ConcreteJc&#39;],[0.049])</span>
<span class="sd">            &gt;&gt;&gt; sl.add(&#39;DoubleGlass&#39;,[&#39;GlassJc&#39;,&#39;AIR&#39;,&#39;GlassJc&#39;],[0.0029,0.0102,0.0029])</span>
<span class="sd">            &gt;&gt;&gt; theta = np.linspace(20,60,100)*np.pi/180</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;ConcreteJc&#39;].eval(120,theta)</span>
<span class="sd">            &gt;&gt;&gt; f,a=sl[&#39;ConcreteJc&#39;].plotwrt(var=&#39;a&#39;,typ=[&#39;l20&#39;])</span>
<span class="sd">            &gt;&gt;&gt; fig = plt.figure()</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;DoubleGlass&#39;].eval(120,theta)</span>
<span class="sd">            &gt;&gt;&gt; f,a = sl[&#39;DoubleGlass&#39;].plotwrt(var=&#39;a&#39;,typ=[&#39;l20&#39;])</span>
<span class="sd">            &gt;&gt;&gt; freq = np.linspace(110,135,50)</span>
<span class="sd">            &gt;&gt;&gt; fig = plt.figure()</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;DoubleGlass&#39;].eval(freq,theta)</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;DoubleGlass&#39;].pcolor(dB=True)</span>

<span class="sd">        Exemple from paper `&quot;[Kiani2007] Glass Characterization for Designing</span>
<span class="sd">        Frequency Selective Surfaces to Improve Transmission through Energy saving</span>
<span class="sd">        glass windows  Kiani 2007&quot;</span>
<span class="sd">        &lt;http://ieeexplore.ieee.org/xpl/login.jsp?tp=&amp;arnumber=4554974&amp;url=http%3A%2F%2Fieeexplore.ieee.org%2Fxpls%2Fabs_all.jsp%3Farnumber%3D4554974&gt;`_</span>
<span class="sd">        The surface impedance is :math:`R = 4 \Omega`, the thicknesss is :math:`d = 100 nm`</span>

<span class="sd">        `Pilkington Spectrum OnLine applet &lt;http://www.pilkington.com/spectrum2/default.aspx?country_code=FR&gt;`_</span>

<span class="sd">        `Design of Energy Saving Windows with high Transmission at 900MHz and 1800 MHz</span>
<span class="sd">        &lt;http://lup.lub.lu.se/luur/download?func=downloadFile&amp;recordOId=530536&amp;fileOId=624944&gt;`_</span>

<span class="sd">        .. math::</span>

<span class="sd">            \sigma =  \\frac{1}{Rd} = 2.5 10^{6} S/m</span>

<span class="sd">        .. plot::</span>
<span class="sd">            :include-source:</span>

<span class="sd">            &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; import matplotlib.pylab as plt</span>
<span class="sd">            &gt;&gt;&gt; sl = SlabDB(filemat=&#39;matDB.ini&#39;,fileslab=&#39;slabDB.ini&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.mat.add(name=&#39;CoatingPilkington&#39;,cval=1,sigma=2.5e6,typ=&#39;epsr&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.mat.add(name=&#39;GlassPilkington&#39;,cval = 6.9,sigma = 5e-4,typ=&#39;epsr&#39;)</span>
<span class="sd">            &gt;&gt;&gt; sl.add(&#39;Optitherm382&#39;,[&#39;CoatingPilkington&#39;,&#39;GlassPilkington&#39;],[100e-9,0.00382])</span>
<span class="sd">            &gt;&gt;&gt; fGHz  = np.linspace(0.9,2.2,50)</span>
<span class="sd">            &gt;&gt;&gt; theta = np.linspace(0,np.pi/2,100)</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;Optitherm382&#39;].eval(fGHz,theta)</span>
<span class="sd">            &gt;&gt;&gt; sl[&#39;Optitherm382&#39;].pcolor(dB=True)</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">U</span> <span class="o">=</span> <span class="n">Slab</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lmatname</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lthick</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">U</span><span class="p">[</span><span class="s1">&#39;evaluated&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">U</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span></div>

<div class="viewcode-block" id="SlabDB.addgui"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.addgui.html#pylayers.antprop.slab.SlabDB.addgui">[docs]</a>    <span class="k">def</span> <span class="nf">addgui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; add a slab in the DB</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">U</span> <span class="o">=</span> <span class="n">Slab</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
        <span class="n">U</span><span class="o">.</span><span class="n">edit</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="n">U</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">U</span></div>


<div class="viewcode-block" id="SlabDB.load"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.load.html#pylayers.antprop.slab.SlabDB.load">[docs]</a>    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">_fileini</span><span class="o">=</span><span class="s1">&#39;slabDB.ini&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a Material from a .ini file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _fileini : string </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fileini</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_fileini</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRMAT&#39;</span><span class="p">])</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="n">config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">fileini</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s1">&#39;mat&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">(</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span> 
        <span class="k">else</span><span class="p">:</span>    
            <span class="n">mat</span> <span class="o">=</span> <span class="n">MatDB</span><span class="p">(</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">mat</span> 
        
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">slabname</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sections</span><span class="p">()):</span>
            <span class="c1"># warning the Slab takes the whole Material Database</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">Slab</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
            <span class="n">S</span><span class="p">[</span><span class="s1">&#39;lmatname&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="s1">&#39;lmatname&#39;</span><span class="p">))</span>
            <span class="c1">#S[&#39;nbmat&#39;]=len(S[&#39;lmatname&#39;])</span>
            <span class="n">S</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="s1">&#39;color&#39;</span><span class="p">)</span>
            <span class="n">S</span><span class="p">[</span><span class="s1">&#39;lthick&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="s1">&#39;lthick&#39;</span><span class="p">))</span>
            <span class="n">S</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">eval</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">slabname</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">))</span>
            <span class="n">S</span><span class="o">.</span><span class="n">conv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">slabname</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span></div>

<div class="viewcode-block" id="SlabDB.save"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.SlabDB.save.html#pylayers.antprop.slab.SlabDB.save">[docs]</a>    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">_fileini</span><span class="o">=</span><span class="s1">&#39;slabDB.ini&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; save SlabDB in a .ini file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        _fileini : string </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fileini</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="n">_fileini</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRSLAB&#39;</span><span class="p">])</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileini</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigParser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># config names</span>
        <span class="c1">#</span>
        <span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="s2">&quot;dict&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">config</span><span class="o">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]))</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;linewidth&#39;</span><span class="p">])</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;lthick&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;lthick&#39;</span><span class="p">])</span>
            <span class="n">config</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;lmatname&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s1">&#39;lmatname&#39;</span><span class="p">])</span>

        <span class="n">config</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>



<span class="c1"># class Wedge(Interface,dict):</span>
<span class="c1">#     &quot;&quot;&quot; Handle a Wedge</span>

<span class="c1">#     Summary</span>
<span class="c1">#     -------</span>

<span class="c1">#     A Wedge is a cone with, on its 2 faces :</span>

<span class="c1">#     - a Material/Slab s0</span>
<span class="c1">#     - a Material/slab sn</span>


<span class="c1">#     Attributes</span>
<span class="c1">#     ----------</span>


<span class="c1">#     mat : MatDB</span>
<span class="c1">#         Associated Material Database </span>

<span class="c1">#     s0 : string |Mat | Slab</span>
<span class="c1">#         Material name |Material |Slab on face 0</span>
<span class="c1">#     sn : string |Mat | Slab</span>
<span class="c1">#         Material name |Material |Slab on face n</span>
 

<span class="c1">#     evaluated : Boolean</span>

<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     def __init__(self, mat=[], s0=&#39;WOOD&#39;, sn=&#39;WOOD&#39;,alpha=np.array([])):</span>
<span class="c1">#         &quot;&quot;&quot; class constructor</span>

<span class="c1">#         Parameters</span>
<span class="c1">#         ----------</span>

<span class="c1">#         mat :</span>
<span class="c1">#         name : string</span>
<span class="c1">#         Wedge name</span>


<span class="c1">#         Example</span>
<span class="c1">#         -------</span>
<span class="c1">#         &gt;&gt;&gt; from pylayers.antprop.slab import *</span>
<span class="c1">#         &gt;&gt;&gt; SDB=SlabDB()</span>
<span class="c1">#         &gt;&gt;&gt; s0 = SDB[&#39;3D_WINDOW_GLASS&#39;]</span>
<span class="c1">#         &gt;&gt;&gt; sn = SDB[&#39;PARTITION&#39;]</span>
<span class="c1">#         &gt;&gt;&gt; W=Wedge(s0=s0,sn=sn)</span>
        
<span class="c1">#         &quot;&quot;&quot;</span>
<span class="c1">#         # if not specified choose default material database</span>

<span class="c1">#         super(Wedge,self).__init__()</span>

<span class="c1">#         if mat==[]:</span>
<span class="c1">#             self.mat = MatDB()</span>
<span class="c1">#         else:</span>
<span class="c1">#             self.mat = mat</span>


<span class="c1">#         # slab 0 is a string name</span>
<span class="c1">#         if isinstance(s0,str):</span>
<span class="c1">#             self[&#39;name0&#39;]= s0</span>
<span class="c1">#             try:</span>
<span class="c1">#                 self[&#39;mat0&#39;]=self.mat[s0]</span>
<span class="c1">#             except:</span>
<span class="c1">#                 raise AttributeError(&#39;s0 is not a material from MatDB&#39;)</span>
<span class="c1">#         else: </span>
<span class="c1">#             if isinstance(s0,Mat):</span>
<span class="c1">#                 self[&#39;mat0&#39;]=s0</span>
<span class="c1">#                 self[&#39;name0&#39;]=s0[&#39;name&#39;]</span>
<span class="c1">#             elif isinstance(s0,Slab):</span>
<span class="c1">#                 self[&#39;mat0&#39;]=s0[&#39;lmat&#39;][0]</span>
<span class="c1">#                 self[&#39;name0&#39;]=s0[&#39;lmatname&#39;][0]</span>

<span class="c1">#         # slab n is a string name</span>
<span class="c1">#         if isinstance(sn,str):</span>
<span class="c1">#             self[&#39;namen&#39;]= sn</span>
<span class="c1">#             try:</span>
<span class="c1">#                 self[&#39;matn&#39;]=self.mat[sn]</span>
<span class="c1">#             except:</span>
<span class="c1">#                 raise AttributeError(&#39;sn is not a material from MatDB&#39;)</span>
<span class="c1">#         else: </span>
<span class="c1">#             if isinstance(sn,Mat):</span>
<span class="c1">#                 self[&#39;matn&#39;]=sn</span>
<span class="c1">#                 self[&#39;namen&#39;]=sn[&#39;name&#39;]</span>
<span class="c1">#             elif isinstance(sn,Slab):</span>
<span class="c1">#                 self[&#39;matn&#39;]=sn[&#39;lmat&#39;][0]</span>
<span class="c1">#                 self[&#39;namen&#39;]=sn[&#39;lmatname&#39;][0]</span>
<span class="c1">#         self[&#39;color&#39;] = &#39;black&#39;</span>
<span class="c1">#         self[&#39;linewidth&#39;] = 1.0</span>
<span class="c1">#         self[&#39;evaluated&#39;] = False</span>
<span class="c1">#         self[&#39;alpha&#39;]=alpha</span>
<span class="c1">#         self[&#39;N&#39;]=alpha/np.pi</span>


<span class="c1">#     # def phi0phin(self,u0,si,so):</span>
<span class="c1">#     #     &quot;&quot;&quot;</span>
<span class="c1">#     #     Compute angle phi_0 and phi_nfrom face 0 regarding</span>
<span class="c1">#     #     to unit vectors u0 and un along face 0 and n respectively</span>

<span class="c1">#     #     Attributes</span>
<span class="c1">#     #     ----------</span>

<span class="c1">#     #     u0 : ndarray (2|3xNp)</span>
<span class="c1">#     #         unit vector along Np faces 0</span>
<span class="c1">#     #     si : ndarray (2|3x)</span>
<span class="c1">#     #         unit vector along incidence ray</span>
<span class="c1">#     #     un : ndarray (2|3xNp)</span>
<span class="c1">#     #         unit vector along Np faces n</span>
<span class="c1">#     #     &quot;&quot;&quot;</span>

<span class="c1">#     #     geu.</span>


<div class="viewcode-block" id="calsig"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.slab.calsig.html#pylayers.antprop.slab.calsig">[docs]</a><span class="k">def</span> <span class="nf">calsig</span><span class="p">(</span><span class="n">cval</span><span class="p">,</span> <span class="n">fGHz</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;epsr&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; evaluate sigma from epsr or index at a given frequency</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    cval : complex value</span>
<span class="sd">    {epsr | epsr ^2 }</span>
<span class="sd">    fGHz : frequency GHz</span>
<span class="sd">    type :</span>
<span class="sd">    {&#39;epsr&#39; | &#39;ind&#39;}</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    epr1 : ..math::</span>
<span class="sd">    sigma : float</span>
<span class="sd">    conductivity (S/m)</span>
<span class="sd">    delta :</span>



<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;epsr&#39;</span><span class="p">:</span>
        <span class="n">epsr</span> <span class="o">=</span> <span class="n">cval</span>
    <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;ind&#39;</span><span class="p">:</span>
        <span class="n">epsr</span> <span class="o">=</span> <span class="n">cval</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="n">epr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">epsr</span><span class="p">)</span>
    <span class="n">epr2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">epsr</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="o">-</span><span class="n">epr2</span> <span class="o">*</span> <span class="n">fGHz</span> <span class="o">/</span> <span class="mf">17.98</span>

    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">epsr</span><span class="p">)</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.3</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">fGHz</span> <span class="o">*</span> <span class="n">n2</span><span class="p">))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">epr1</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span></div>

<span class="k">def</span> <span class="nf">calRT_homogeneous_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">epsr</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">fGHz</span><span class="p">,</span><span class="n">theta</span><span class="p">):</span>
    
    <span class="sd">&quot;&quot;&quot; calculate R and T for an homogeneous Slab</span>

<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>

<span class="sd">    x : np.array()</span>
<span class="sd">        conductivity </span>
<span class="sd">    epsr : complex </span>
<span class="sd">        permittivity </span>
<span class="sd">    d : thickness </span>

<span class="sd">    The model is a slab of thickness d with a known epsr and variable conductivity sigma </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Rpara , Rortho , Tpara , Tortho </span>
<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">dm</span> <span class="o">=</span><span class="p">{}</span>
    <span class="n">dm</span><span class="p">[</span><span class="s1">&#39;ukn&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;epr&#39;</span><span class="p">:</span><span class="n">epsr</span><span class="p">,</span><span class="s1">&#39;mur&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;roughness&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lthick&#39;</span><span class="p">:[</span><span class="n">d</span><span class="p">],</span><span class="s1">&#39;lmatname&#39;</span><span class="p">:[</span><span class="s1">&#39;ukn&#39;</span><span class="p">],</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
    <span class="n">S</span><span class="o">=</span><span class="n">Slab</span><span class="p">(</span><span class="s1">&#39;void&#39;</span><span class="p">,</span><span class="n">MatDB</span><span class="p">(</span><span class="n">dm</span><span class="o">=</span><span class="n">dm</span><span class="p">),</span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">S</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="o">=</span><span class="n">fGHz</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="n">ang</span><span class="p">)</span>
    <span class="n">Rpara</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">R</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Rortho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">R</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">Tpara</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Tortho</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Rpara</span><span class="p">,</span><span class="n">Rortho</span><span class="p">,</span><span class="n">Tpara</span><span class="p">,</span><span class="n">Tortho</span>


<span class="k">def</span> <span class="nf">calRT_3layers_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">epsr</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">fGHz</span><span class="p">,</span><span class="n">theta</span><span class="p">):</span>

    <span class="sd">&quot;&quot;&quot; calculate R and T for an homogeneous Slab</span>

<span class="sd">    Parameters </span>
<span class="sd">    ----------</span>

<span class="sd">    x : np.array()</span>
<span class="sd">        conductivity (S/m) </span>
<span class="sd">        delta (m) </span>
<span class="sd">    epsr : complex </span>
<span class="sd">        permittivity </span>
<span class="sd">    d : thickness </span>

<span class="sd">    The model is a 3 layer slab of thickness d </span>
<span class="sd">        d - delta/2    epsr , sigma </span>
<span class="sd">        delta          epsr = 1 sigma = 0 (AIR) </span>
<span class="sd">        d - delta/2    epsr , sigma </span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Rpara , Rortho , Tpara , Tortho </span>

<span class="sd">    &quot;&quot;&quot;</span> 
    <span class="n">dm</span> <span class="o">=</span><span class="p">{}</span>
    <span class="n">dm</span><span class="p">[</span><span class="s1">&#39;ukn&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;epr&#39;</span><span class="p">:</span><span class="n">epsr</span><span class="p">,</span><span class="s1">&#39;mur&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;roughness&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;lthick&#39;</span><span class="p">:[</span><span class="n">d</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">d</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">],</span><span class="s1">&#39;lmatname&#39;</span><span class="p">:[</span><span class="s1">&#39;ukn&#39;</span><span class="p">,</span><span class="s1">&#39;AIR&#39;</span><span class="p">,</span><span class="s1">&#39;ukn&#39;</span><span class="p">],</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;linewidth&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">}</span>
    <span class="n">S</span><span class="o">=</span><span class="n">Slab</span><span class="p">(</span><span class="s1">&#39;void&#39;</span><span class="p">,</span><span class="n">MatDB</span><span class="p">(</span><span class="n">dm</span><span class="o">=</span><span class="n">dm</span><span class="p">),</span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">)</span>
    <span class="n">S</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">fGHz</span><span class="o">=</span><span class="n">fGHz</span><span class="p">,</span><span class="n">theta</span><span class="o">=</span><span class="n">ang</span><span class="p">)</span>
    <span class="n">Rpara</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">R</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Rortho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">R</span><span class="p">[:,:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">Tpara</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Tortho</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">T</span><span class="p">[:,:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">Rpara</span><span class="p">,</span><span class="n">Rortho</span><span class="p">,</span><span class="n">Tpara</span><span class="p">,</span><span class="n">Tortho</span>

<span class="k">if</span> <span class="p">(</span><span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="c1">#plt.ion()</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
    <span class="n">sl</span> <span class="o">=</span> <span class="n">SlabDB</span><span class="p">(</span><span class="s1">&#39;matDB.ini&#39;</span><span class="p">,</span><span class="s1">&#39;slabDB.ini&#39;</span><span class="p">)</span>
    <span class="n">s1</span> <span class="o">=</span> <span class="n">sl</span><span class="p">[</span><span class="s1">&#39;PILLAR&#39;</span><span class="p">]</span>
    <span class="n">fGHz</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">0.1</span><span class="p">)</span>


</pre></div>

          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; 2016, PyLayers developer team.
      Last updated on Nov 06, 2017.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.5a0. Design by <a href="http://desgrana.es">Desgrana</a>.
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="../../../py-modindex.html">
        Previous
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#AFFFFF');
           },
           function () {
               $(this).css('background-color', '#AFFFFF');
           }
       );
     </script>
  </body>
</html>