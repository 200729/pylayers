
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pylayers.antprop.spharm &mdash; Python 1 documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="top" title="Python 1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body role="document">

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../../index.html">
            <img src="../../../_static/pylayers.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../../../download.html">Download</a></li>
            <li><a href="../../../notebook/TOC.html">User Guide</a></li>
            <li><a href="../../../modules/pylayers.html">Reference</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">
  google.load('search', '1', {language : 'en'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    var options = new google.search.DrawOptions();
    options.setAutoComplete(true);
    customSearchControl.draw('cse', options);
  }, true);
</script>

</div>
</div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	  <div class="rel">
	   
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="../../../py-modindex.html" title="Python Module Index"
	    >Modules
	    <br>
	    <span class="smallrellink">
	    Python Module...
	    </span>
	    <span class="hiddenrellink">
	    Python Module Index
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
	<div class="spacer">
	&nbsp;
	</div>
	<div class="rellink">
	<a href="../../index.html" title="Module code" >
	Up
	<br>
	<span class="smallrellink">
	Module code
	</span>
	<span class="hiddenrellink">
	Module code
	</span>
	
	</a>
	</div>
    </div>
    <p style="text-align: center; background-color: #BFFFFF">This documentation is

    for Python <strong>version 1</strong>
    &mdash; <a href="https://github.com/pylayers/pylayers/archive/master.zip">Other versions</a></p>
    
    <h3>Citing</h3>
    <p>If you use the software, please consider
    <a href="../../../about.html#citing-pylayers">citing pylayers</a>.</p>
    <h3>This page</h3>
	
    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pylayers.antprop.spharm</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding:Utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">This module handles Scalar and Vector Spherical Harmonics in PyLayers</span>

<span class="sd">Class VectorCoeff</span>
<span class="sd">==================</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">    VectorCoeff.__init__</span>
<span class="sd">    VectorCoeff.inits1</span>

<span class="sd">class SSHCoeff</span>
<span class="sd">==============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     SSHCoeff.__init__</span>
<span class="sd">     SSHCoeff.s2tos3</span>
<span class="sd">     SSHCoeff.sets3</span>


<span class="sd">class SCoeff</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     SCoeff.__init__</span>
<span class="sd">     SCoeff.__repr__</span>
<span class="sd">     SCoeff.inits2</span>
<span class="sd">     SCoeff.inits3</span>
<span class="sd">     SCoeff.delete</span>
<span class="sd">     SCoeff.put</span>
<span class="sd">     SCoeff.delete3</span>
<span class="sd">     SCoeff.put3</span>
<span class="sd">     SCoeff.s3tos2</span>
<span class="sd">     SCoeff.plot</span>
<span class="sd">     SCoeff.show</span>

<span class="sd">class VCoeff</span>
<span class="sd">============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     VCoeff.__init__</span>
<span class="sd">     VCoeff.__repr__</span>
<span class="sd">     VCoeff.inits1</span>
<span class="sd">     VCoeff.inits2</span>
<span class="sd">     VCoeff.inits3</span>
<span class="sd">     VCoeff.s1tos2</span>
<span class="sd">     VCoeff.delete</span>
<span class="sd">     VCoeff.put</span>
<span class="sd">     VCoeff.delete3</span>
<span class="sd">     VCoeff.put3</span>
<span class="sd">     VCoeff.s3tos2</span>
<span class="sd">     VCoeff.plot</span>
<span class="sd">     VCoeff.show</span>

<span class="sd">class VSHCoeff</span>
<span class="sd">==============</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     VSHCoeff.__init__</span>
<span class="sd">     VSHCoeff.__repr__</span>
<span class="sd">     VSHCoeff.plot</span>
<span class="sd">     VSHCoeff.show</span>
<span class="sd">     VSHCoeff.s1tos2</span>
<span class="sd">     VSHCoeff.s2tos3_new</span>
<span class="sd">     VSHCoeff.s2tos3</span>
<span class="sd">     VSHCoeff.s3tos2</span>
<span class="sd">     VSHCoeff.strip3</span>
<span class="sd">     VSHCoeff.ens3</span>
<span class="sd">     VSHCoeff.drag3</span>
<span class="sd">     VSHCoeff.put3</span>


<span class="sd">Utility Functions</span>
<span class="sd">=================</span>

<span class="sd">.. autosummary::</span>
<span class="sd">    :toctree: generated/</span>

<span class="sd">     indexssh</span>
<span class="sd">     indexvsh</span>
<span class="sd">     index_vsh</span>
<span class="sd">     AFLegendre3</span>
<span class="sd">     AFLegendre2</span>
<span class="sd">     AFLegendre</span>
<span class="sd">     VW2</span>
<span class="sd">     VW</span>
<span class="sd">     VW0</span>
<span class="sd">     plotVW</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">doctest</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">pdb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="kn">import</span> <span class="nn">scipy.special</span> <span class="kn">as</span> <span class="nn">special</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">io</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">factorial</span>
<span class="kn">import</span> <span class="nn">pylayers.util.pyutil</span> <span class="kn">as</span> <span class="nn">pyu</span>
<span class="kn">from</span> <span class="nn">pylayers.util.project</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.util.plotutil</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">axes3d</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rc</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<div class="viewcode-block" id="indexssh"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.indexssh.html#pylayers.antprop.spharm.indexssh">[docs]</a><span class="k">def</span> <span class="nf">indexssh</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">mirror</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; create [l,m] indexation from Lmax</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    L : maximum order</span>
<span class="sd">    mirror : boolean </span>
<span class="sd">        if True the output contains negative m indices</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    t : np.array</span>
<span class="sd">        [l,m]   Ncoeff x 2</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.spharm import *</span>
<span class="sd">        &gt;&gt;&gt; indexssh(2)</span>
<span class="sd">        array([[ 0.,  0.],</span>
<span class="sd">               [ 1.,  0.],</span>
<span class="sd">               [ 2.,  0.],</span>
<span class="sd">               [ 1.,  1.],</span>
<span class="sd">               [ 2.,  1.],</span>
<span class="sd">               [ 2.,  2.],</span>
<span class="sd">               [ 1., -1.],</span>
<span class="sd">               [ 2., -1.],</span>
<span class="sd">               [ 2., -2.]])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">l</span><span class="p">,</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">if</span> <span class="n">mirror</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span>  <span class="n">t</span><span class="p">[</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">:,:]</span>
        <span class="n">v</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">u</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="o">-</span><span class="n">u</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span>
        <span class="c1">#v = v[::-1,:]</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">t</span></div>

<div class="viewcode-block" id="indexvsh"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.indexvsh.html#pylayers.antprop.spharm.indexvsh">[docs]</a><span class="k">def</span> <span class="nf">indexvsh</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; calculate index of vsh</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    L : int</span>
<span class="sd">      degree max</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    t : ndarray ( (L+1)(L+2)/2 ,  2 )</span>
<span class="sd">       tab for indexing the upper triangle</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; from pylayers.antprop.antenna import *</span>
<span class="sd">    &gt;&gt;&gt; indexvsh(3)</span>
<span class="sd">    array([[1, 0],</span>
<span class="sd">           [1, 1],</span>
<span class="sd">           [2, 0],</span>
<span class="sd">           [2, 1],</span>
<span class="sd">           [2, 2],</span>
<span class="sd">           [3, 0],</span>
<span class="sd">           [3, 1],</span>
<span class="sd">           [3, 2],</span>
<span class="sd">           [3, 3]])</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Kmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1">#k = np.arange(Kmax) # old version with 0,0</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Kmax</span><span class="p">)</span>
    <span class="c1">#k = np.arange(Kmax)</span>
    <span class="c1">#k = np.arange(Kmax)</span>
    <span class="c1">#k = np.arange(1,Kmax)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="index_vsh"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.index_vsh.html#pylayers.antprop.spharm.index_vsh">[docs]</a><span class="k">def</span> <span class="nf">index_vsh</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; vector spherical harmonics indexing</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    L : int</span>
<span class="sd">        degree max   sum(1..L)   L points</span>
<span class="sd">    M : int</span>
<span class="sd">        order max    sum(0..M)   M+1 points</span>

<span class="sd">    M &lt;=L</span>

<span class="sd">    ind[0] = n</span>
<span class="sd">    ind[1] = m</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This function is more generic than indexvsh because it allows to have M&lt;&gt;L</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    indexvsh</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;indexvsh error M&gt;L&quot;</span>

    <span class="n">Kmax1</span> <span class="o">=</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="c1">#k = np.arange(Kmax1)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">Kmax1</span><span class="p">)</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">):</span>
        <span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">M</span><span class="p">)</span> <span class="o">+</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">m1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">M</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">l1</span><span class="p">))</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">m</span><span class="p">,</span> <span class="n">m1</span><span class="p">))</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></div>

<span class="k">class</span> <span class="nc">VectorCoeff</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;  class vector spherical harmonics</span>


<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="VectorCoeff.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VectorCoeff.__init__.html#pylayers.antprop.spharm.VectorCoeff.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">typ</span><span class="p">,</span>
                 <span class="n">fmin</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                 <span class="n">fmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                 <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                 <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ : string</span>
<span class="sd">        fmin : float</span>
<span class="sd">            min frequency GHz</span>
<span class="sd">        fmax : float</span>
<span class="sd">            max frequency GHz</span>
<span class="sd">        data : np.array</span>
<span class="sd">        ind : np.array</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        .. warning::</span>
<span class="sd">            seems deprecated</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span></div>

<div class="viewcode-block" id="VectorCoeff.inits1"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VectorCoeff.inits1.html#pylayers.antprop.spharm.VectorCoeff.inits1">[docs]</a>    <span class="k">def</span> <span class="nf">inits1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; init shape 1</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        data :</span>
<span class="sd">        ind :</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s1</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind_s1</span> <span class="o">=</span> <span class="n">ind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<span class="k">class</span> <span class="nc">SSHCoeff</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; scalar spherical harmonics</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    Cx : coefficient for x axis</span>
<span class="sd">    Cy : coefficient for y axis</span>
<span class="sd">    Cz : coefficient for z axis</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SSHCoeff.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SSHCoeff.__init__.html#pylayers.antprop.spharm.SSHCoeff.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Cx</span><span class="p">,</span><span class="n">Cy</span><span class="p">,</span><span class="n">Cz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; class constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Cx : SCoeff</span>
<span class="sd">        Cy : SCoeff</span>
<span class="sd">        Cz : SCoeff</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span> <span class="o">=</span> <span class="n">Cx</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span> <span class="o">=</span> <span class="n">Cy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span> <span class="o">=</span> <span class="n">Cz</span></div>



<div class="viewcode-block" id="SSHCoeff.s2tos3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SSHCoeff.s2tos3.html#pylayers.antprop.spharm.SSHCoeff.s2tos3">[docs]</a>    <span class="k">def</span> <span class="nf">s2tos3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert scalar spherical coefficients from shape 2 to shape 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        threshold : float</span>
<span class="sd">            default 1e-5</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        s3 corresponds to energy thresholded coefficients</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># integrates energy over frequency axis = 0</span>
        <span class="n">Ex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Ey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">Ez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># calculates total Energy</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">Ex</span> <span class="o">+</span> <span class="n">Ey</span> <span class="o">+</span> <span class="n">Ez</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">E</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">threshold</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span></div>

<div class="viewcode-block" id="SSHCoeff.sets3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SSHCoeff.sets3.html#pylayers.antprop.spharm.SSHCoeff.sets3">[docs]</a>    <span class="k">def</span> <span class="nf">sets3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Cx</span><span class="p">,</span><span class="n">Cy</span><span class="p">,</span><span class="n">Cz</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; set shape 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Cx : SCoeff</span>
<span class="sd">        Cy : SCoeff</span>
<span class="sd">        Cz : SCoeff</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">Cx</span><span class="o">.</span><span class="n">ind3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">Cx</span><span class="o">.</span><span class="n">s3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cx</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">Cx</span><span class="o">.</span><span class="n">k2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">Cy</span><span class="o">.</span><span class="n">ind3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">Cy</span><span class="o">.</span><span class="n">s3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cy</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">Cy</span><span class="o">.</span><span class="n">k2</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">Cz</span><span class="o">.</span><span class="n">ind3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">Cz</span><span class="o">.</span><span class="n">s3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cz</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">Cz</span><span class="o">.</span><span class="n">k2</span></div>


<span class="k">class</span> <span class="nc">SCoeff</span><span class="p">(</span><span class="n">PyLayers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; scalar Spherical Harmonics coefficients</span>

<span class="sd">    d = np.array [Nf,N+1,M+1]</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    s2  shape 2   np.array [ Nf x (N+1)*(M+1)   ]</span>
<span class="sd">    s3  shape 3   np.array [ Nf x K     ]</span>
<span class="sd">    ind [ K x 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="SCoeff.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.__init__.html#pylayers.antprop.spharm.SCoeff.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s2&#39;</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="n">lmax</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>  <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                 <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
        <span class="sd">&quot;&quot;&quot; init VCoeff</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>

<span class="sd">         typ : string</span>
<span class="sd">            &#39;s2&#39; | &#39;s3&#39;</span>
<span class="sd">         fmin : float</span>
<span class="sd">         fmax : float</span>
<span class="sd">         data : ndarray</span>
<span class="sd">         ind  : ndarray</span>
<span class="sd">         k    : ndarray</span>

<span class="sd">         s2 , s3 containers are created</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#~ defaults = { &#39;typ&#39;: &#39;s2&#39;,</span>
                    <span class="c1">#~ &#39;fmin&#39; : 0.6,</span>
                    <span class="c1">#~ &#39;fmax&#39; : 6,</span>
                    <span class="c1">#~ &#39;lmax&#39; : 20,</span>
                    <span class="c1">#~ &#39;data&#39; : [],</span>
                    <span class="c1">#~ &#39;ind&#39; : [],</span>
                    <span class="c1">#~ &#39;k&#39;   : [] }</span>
<span class="c1">#~</span>
        <span class="c1">#~ for key, value in defaults.items():</span>
            <span class="c1">#~ if key not in kwargs:</span>
                <span class="c1">#~ kwargs[key] = value</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lmax</span> <span class="o">=</span> <span class="n">lmax</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">ind</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits3</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCoeff.__repr__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.__repr__.html#pylayers.antprop.spharm.SCoeff.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">st</span> <span class="o">=</span> <span class="s2">&quot;Nf   : &quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span>  <span class="s2">&quot;fmin (GHz) : &quot;</span><span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span>  <span class="s2">&quot;fmax (GHz) : &quot;</span><span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;s2&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;NCoeff s2  : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">if</span> <span class="s1">&#39;s3&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">sh3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sh3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Ncoeff s3 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCoeff.inits2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.inits2.html#pylayers.antprop.spharm.SCoeff.inits2">[docs]</a>    <span class="k">def</span> <span class="nf">inits2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span><span class="n">ind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; initialize shape 2 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        data : shape 2 data</span>
<span class="sd">        ind  : np.array</span>
<span class="sd">            index for shape 2</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># first axis is frequency</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># second axis is the maximum number of coeff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">data</span>

        <span class="c1">#self.ind2 = indexssh(lmax)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">ind</span></div>

<div class="viewcode-block" id="SCoeff.inits3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.inits3.html#pylayers.antprop.spharm.SCoeff.inits3">[docs]</a>    <span class="k">def</span> <span class="nf">inits3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; initialize shape 3 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        data  : shape 3 data</span>
<span class="sd">        ind   : shape 3 indexing</span>
<span class="sd">        k     : k</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">ind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">k</span></div>

<div class="viewcode-block" id="SCoeff.delete"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.delete.html#pylayers.antprop.spharm.SCoeff.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ind   : int</span>
<span class="sd">        typ   : int</span>
<span class="sd">                2  shape 2  (Nf , N*M   )</span>
<span class="sd">                3  shape 3  (Nf , K )  T ( K x 2 )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">b</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="SCoeff.put"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.put.html#pylayers.antprop.spharm.SCoeff.put">[docs]</a>    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; recover last deleted coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ : int</span>
<span class="sd">                2 : shape 2  (Nf , N*M   )</span>
<span class="sd">                3 : shape 3  (Nf , K )  T ( K x 2 )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="n">file_ind</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_i2.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">aux</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

            <span class="n">file_s2</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_s2.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_s2</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">s2p</span> <span class="o">=</span> <span class="n">s2</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">b</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">file_ind</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_i3.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ind3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">aux</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="n">file_s3</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_s3.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_s3</span><span class="p">)</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">s3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span>

            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_s3</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCoeff.delete3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.delete3.html#pylayers.antprop.spharm.SCoeff.delete3">[docs]</a>    <span class="k">def</span> <span class="nf">delete3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete coeff.s3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ind : int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="SCoeff.put3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.put3.html#pylayers.antprop.spharm.SCoeff.put3">[docs]</a>    <span class="k">def</span> <span class="nf">put3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; function put3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        i  : int</span>
<span class="sd">        i3 : int</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">k2</span><span class="p">]</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="SCoeff.s3tos2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.s3tos2.html#pylayers.antprop.spharm.SCoeff.s3tos2">[docs]</a>    <span class="k">def</span> <span class="nf">s3tos2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; transform shape3 to shape 2</span>

<span class="sd">        s2  shape 2   array [ Nf x (L+1)*(M+1) ]</span>
<span class="sd">        s3  shape 3   array [ Nf x K     ] ind [ K x 2]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        The shape of s2 is (Lmax+1)*(Lmax+2)/2</span>

<span class="sd">        k2  : is the list of conserved indices in shape 3</span>
<span class="sd">        ind3 : np.array (K3, 2) are the conserved (l,m) indices</span>

<span class="sd">        ind3 and k2 have one common dimension</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># retrieve Nf and Lmax to build a void s2 structure</span>
        <span class="n">Nf</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Lmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">K2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Lmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Lmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nf</span><span class="p">,</span><span class="n">K2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="c1"># fill s2 with s3 at proper coefficient location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="n">Lmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M2</span> <span class="o">=</span> <span class="n">Lmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">indexvsh</span><span class="p">(</span><span class="n">Lmax</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCoeff.plot"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.plot.html#pylayers.antprop.spharm.SCoeff.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; plot coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ : string</span>
<span class="sd">            &#39;s3&#39;</span>
<span class="sd">        title</span>
<span class="sd">        xl</span>
<span class="sd">        yl</span>
<span class="sd">        log</span>
<span class="sd">        stem: boolean</span>
<span class="sd">        color</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typ</span><span class="o">==</span><span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span>
            <span class="n">tl</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">C</span> <span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tl</span><span class="o">==</span><span class="n">l</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span><span class="n">k</span><span class="p">])))</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
            <span class="n">Cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
                <span class="n">Cs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">Cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stem</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span><span class="n">Cs</span><span class="p">,</span><span class="n">markerfmt</span><span class="o">=</span><span class="n">color</span><span class="o">+</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span><span class="n">Cs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="c1">#plt.axis([0,max(tl),0,5])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;degree l&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Integrated Module of coeff&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SCoeff.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.SCoeff.show.html#pylayers.antprop.spharm.SCoeff.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span>
             <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">kmax</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">seuildb</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;SHC&#39;</span><span class="p">,</span>
             <span class="n">xl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">yl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">dB</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot_r</span><span class="p">,</span>
             <span class="n">anim</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ :  string</span>
<span class="sd">            default (&#39;s1&#39;)</span>
<span class="sd">            &#39;s1&#39;  shape 1  (Nf , L , M )</span>
<span class="sd">            &#39;s2&#39;  shape 2  (Nf , L*M )</span>
<span class="sd">            &#39;s3&#39;  shape 3  (Nf , K )  and  ( K x 2 )</span>

<span class="sd">        k  : integer</span>
<span class="sd">            frequency index default 0</span>

<span class="sd">        N, M = maximal value for degree, mode respectively</span>
<span class="sd">        (not to be defined if &#39;s2&#39; or &#39;s3&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L1</span>
            <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M1</span>
            <span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">anim</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">seuildb</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
                <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Level dB&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
                    <span class="n">vdB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">vdB</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">vmin</span><span class="o">=-</span><span class="n">seuildb</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">)</span>
                    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
                    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Level dB&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">)</span>
                    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
                    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Level (linear scale)&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">kmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kmax</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">))</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">db</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">seuildb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">db</span> <span class="o">+</span> <span class="n">seuildb</span><span class="p">)</span> <span class="o">/</span> <span class="n">seuildb</span>
            <span class="c1">#</span>
            <span class="c1">#gray</span>
            <span class="c1">#</span>
            <span class="c1">#pcolor(np.arange(K+1)[0:kmax],self.fa,col,cmap=cm.gray_r,vmin=0.0,vmax=1.0)</span>
            <span class="c1">#</span>
            <span class="c1">#color</span>
            <span class="c1">#</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">],</span> <span class="n">fa</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">kmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kmax</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">))</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">db</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">seuildb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">db</span> <span class="o">+</span> <span class="n">seuildb</span><span class="p">)</span> <span class="o">/</span> <span class="n">seuildb</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">],</span> <span class="n">fa</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

                <span class="c1">#echelle=[str(0), str(-10), str(-20), str(-30), str(-40), str(-50)]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">typ</span> <span class="o">==</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span> <span class="p">:</span>

            <span class="n">echelle</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">40</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">30</span><span class="p">),</span>
                       <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span><span class="p">)]</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">echelle</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span></div>

<span class="k">class</span> <span class="nc">VCoeff</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Spherical Harmonics Coefficient</span>

<span class="sd">    d = np.array [Nf,N+1,M+1]</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    s1  shape 1   np.array [ Nf x (N+1) x (M+1) ]</span>
<span class="sd">    s2  shape 2   np.array [ Nf x (N+1)*(M+1)   ]</span>
<span class="sd">    s3  shape 3   np.array [ Nf x K     ]</span>
<span class="sd">    ind [ K x 2]</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="VCoeff.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.__init__.html#pylayers.antprop.spharm.VCoeff.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span>
                 <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])):</span>
        <span class="sd">&quot;&quot;&quot; init VCoeff</span>

<span class="sd">         Parameters</span>
<span class="sd">         ----------</span>
<span class="sd">         typ : string</span>
<span class="sd">            &#39;s1&#39; | &#39;s2&#39; | &#39;s3&#39;</span>
<span class="sd">         fmin : float</span>
<span class="sd">         fmax : float</span>
<span class="sd">         data : ndarray</span>
<span class="sd">         ind  : ndarray</span>
<span class="sd">         k    : ndarray</span>

<span class="sd">         s1, s2 , s3 containers are created</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">s1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits1</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits2</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inits3</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.__repr__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.__repr__.html#pylayers.antprop.spharm.VCoeff.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">st</span> <span class="o">=</span> <span class="s2">&quot;Nf   : &quot;</span> <span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span>  <span class="s2">&quot;fmin (GHz) : &quot;</span><span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span>  <span class="s2">&quot;fmax (GHz) : &quot;</span><span class="o">+</span>  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="n">sh1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">)</span>
        <span class="n">sh2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span>
        <span class="n">sh3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sh1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span>  <span class="s2">&quot;L1  : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;M1  : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M1</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Ncoeff s1 &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">M1</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">L1</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">sh2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;NCoeff s2  : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">sh3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Ncoeff s3 : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">))</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.inits1"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.inits1.html#pylayers.antprop.spharm.VCoeff.inits1">[docs]</a>    <span class="k">def</span> <span class="nf">inits1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; initialize shape 1 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data  : shape 1 data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">L</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">&gt;</span> <span class="n">L</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;VCoeff : M&gt;N &#39;</span><span class="p">)</span>
            <span class="nb">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s1</span> <span class="o">=</span> <span class="n">data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L1</span> <span class="o">=</span> <span class="n">L</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M1</span> <span class="o">=</span> <span class="n">M</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="VCoeff.inits2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.inits2.html#pylayers.antprop.spharm.VCoeff.inits2">[docs]</a>    <span class="k">def</span> <span class="nf">inits2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; initialize shape 2 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">         data : shape 2 data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kmax</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">nmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="n">kmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">indexvsh</span><span class="p">(</span><span class="n">nmax</span><span class="p">)</span>
        <span class="n">L2</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">M2</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="n">L2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M2</span> <span class="o">=</span> <span class="n">M2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">index_vsh</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.inits3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.inits3.html#pylayers.antprop.spharm.VCoeff.inits3">[docs]</a>    <span class="k">def</span> <span class="nf">inits3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; initialize shape 3 format</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">         data  : shape 3 data</span>
<span class="sd">         ind   : ishape 3 indexing</span>
<span class="sd">         k     : k</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span> <span class="o">=</span> <span class="n">sh</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">ind</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">k</span></div>

<div class="viewcode-block" id="VCoeff.s1tos2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.s1tos2.html#pylayers.antprop.spharm.VCoeff.s1tos2">[docs]</a>    <span class="k">def</span> <span class="nf">s1tos2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L2</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert shape 1 --&gt; shape 2</span>

<span class="sd">        shape 1   array [ Nf , (L+1) , (M+1) ]</span>
<span class="sd">        shape 2   array [ Nf , (L+1) * (M+1) ]</span>

<span class="sd">        l = 0...L2</span>
<span class="sd">        m = 0...M2</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        L2 : int &lt;= L1</span>
<span class="sd">            shape 1 has 3 axis - shape 2 has 2 axis</span>
<span class="sd">            by default all s1 coefficients are kept L2=-1 means L2=min(L1,M1) because M2 must be equal to L2</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        index_vsh</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">L2</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">L2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">M1</span><span class="p">)</span>
        <span class="n">M2</span> <span class="o">=</span> <span class="n">L2</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">L2</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="n">L2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">M2</span> <span class="o">=</span> <span class="n">M2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">index_vsh</span><span class="p">(</span><span class="n">L2</span><span class="p">,</span> <span class="n">M2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;error VCoeff s1tos2: L2&gt;L1&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.delete"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.delete.html#pylayers.antprop.spharm.VCoeff.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ind   : int</span>
<span class="sd">        typ   : int</span>
<span class="sd">                2  shape 2  (Nf , N*M   )</span>
<span class="sd">                3  shape 3  (Nf , K )  T ( K x 2 )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">b</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="VCoeff.put"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.put.html#pylayers.antprop.spharm.VCoeff.put">[docs]</a>    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; recover last deleted coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typ : int</span>
<span class="sd">                2 : shape 2  (Nf , N*M   )</span>
<span class="sd">                3 : shape 3  (Nf , K )  T ( K x 2 )</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

            <span class="n">file_ind</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_i2.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ind2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">aux</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

            <span class="n">file_s2</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_s2.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">s2</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_s2</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">s2p</span> <span class="o">=</span> <span class="n">s2</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">b</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

            <span class="n">file_ind</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_i3.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">aux</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ind3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">aux</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">aux</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
            <span class="n">k2</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="n">file_s3</span> <span class="o">=</span> <span class="n">pyu</span><span class="o">.</span><span class="n">getlong</span><span class="p">(</span><span class="s2">&quot;outfile_s3.txt&quot;</span><span class="p">,</span> <span class="n">pstruc</span><span class="p">[</span><span class="s1">&#39;DIRANT&#39;</span><span class="p">])</span>
            <span class="n">s3</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">file_s3</span><span class="p">)</span>

            <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">s3</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span>

            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_ind</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file_s3</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.delete3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.delete3.html#pylayers.antprop.spharm.VCoeff.delete3">[docs]</a>    <span class="k">def</span> <span class="nf">delete3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; delete coeff.s3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        ind : int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="VCoeff.put3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.put3.html#pylayers.antprop.spharm.VCoeff.put3">[docs]</a>    <span class="k">def</span> <span class="nf">put3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; function put 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        i  : int</span>
<span class="sd">        i3 : int</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">k2</span> <span class="o">=</span> <span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">i3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">i3</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">k2</span><span class="p">]</span>
        <span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">k2</span><span class="p">]</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">ind3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k2</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">s3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="n">a</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="n">c</span></div>

<div class="viewcode-block" id="VCoeff.s3tos2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.s3tos2.html#pylayers.antprop.spharm.VCoeff.s3tos2">[docs]</a>    <span class="k">def</span> <span class="nf">s3tos2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; transform shape3 to shape 2</span>

<span class="sd">        s2  shape 2   array [ Nf x (L+1)*(M+1) ]</span>
<span class="sd">        s3  shape 3   array [ Nf x K     ] ind [ K x 2]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>

<span class="sd">        The shape of s2 is (Lmax+1)*(Lmax+2)/2</span>

<span class="sd">        k2  : is the list of conserved indices in shape 3</span>
<span class="sd">        ind3 : np.array (K3, 2) are the conserved (l,m) indices </span>

<span class="sd">        ind3 and k2 have one common dimension</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># retrieve Nf and Lmax to build a void s2 structure</span>
        <span class="n">Nf</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Lmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ind3</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">K2</span>   <span class="o">=</span> <span class="p">(</span><span class="n">Lmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">Lmax</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">Nf</span><span class="p">,</span><span class="n">K2</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>

        <span class="c1"># fill s2 with s3 at proper coefficient location</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span><span class="bp">self</span><span class="o">.</span><span class="n">k2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L2</span> <span class="o">=</span> <span class="n">Lmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">M2</span> <span class="o">=</span> <span class="n">Lmax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ind2</span> <span class="o">=</span> <span class="n">indexvsh</span><span class="p">(</span><span class="n">Lmax</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.plot"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.plot.html#pylayers.antprop.spharm.VCoeff.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typ</span><span class="o">==</span><span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="n">indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ind3</span>
            <span class="n">tl</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">C</span> <span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">):</span>
                <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tl</span><span class="o">==</span><span class="n">l</span><span class="p">)</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span><span class="n">k</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span><span class="n">k</span><span class="p">])))</span>
                <span class="n">C</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">C</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
            <span class="n">Cs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
                <span class="n">Cs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">log10</span><span class="p">(</span><span class="n">Cs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">stem</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span><span class="n">Cs</span><span class="p">,</span><span class="n">markerfmt</span><span class="o">=</span><span class="n">color</span><span class="o">+</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">tl</span><span class="p">),</span><span class="n">Cs</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
            <span class="c1">#plt.axis([0,max(tl),0,5])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;degree l&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Integrated Module of coeff&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="VCoeff.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VCoeff.show.html#pylayers.antprop.spharm.VCoeff.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
             <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span>
             <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
             <span class="n">L</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">M</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
             <span class="n">kmax</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
             <span class="n">seuildb</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
             <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;SHC&#39;</span><span class="p">,</span>
             <span class="n">xl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">yl</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">dB</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>
             <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot_r</span><span class="p">,</span>
             <span class="n">anim</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typ :  string</span>
<span class="sd">            default (&#39;s1&#39;)</span>
<span class="sd">            &#39;s1&#39;  shape 1  (Nf , N , M )</span>
<span class="sd">            &#39;s2&#39;  shape 2  (Nf , N*M   )</span>
<span class="sd">            &#39;s3&#39;  shape 3  (Nf , K )  T ( K x 2 )</span>

<span class="sd">        k  : integer</span>
<span class="sd">            frequency index default 0</span>

<span class="sd">        N, M = maximal value for degree, mode respectively</span>
<span class="sd">        (not to be defined if &#39;s2&#39; or &#39;s3&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s1&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">L</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L1</span>
            <span class="k">if</span> <span class="n">M</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">M1</span>
            <span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">anim</span><span class="p">:</span>
                <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                            <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="n">seuildb</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s1</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="n">M</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">dB</span><span class="p">:</span>
                    <span class="n">vdB</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">vdB</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">vmin</span><span class="o">=-</span><span class="n">seuildb</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">Mg</span><span class="p">,</span> <span class="n">Ng</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">v</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">)</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            
            <span class="n">kmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kmax</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">))</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">db</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">seuildb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">db</span> <span class="o">+</span> <span class="n">seuildb</span><span class="p">)</span> <span class="o">/</span> <span class="n">seuildb</span>
            <span class="c1">#</span>
            <span class="c1">#gray</span>
            <span class="c1">#</span>
            <span class="c1">#pcolor(np.arange(K+1)[0:kmax],self.fa,col,cmap=cm.gray_r,vmin=0.0,vmax=1.0)</span>
            <span class="c1">#</span>
            <span class="c1">#color</span>
            <span class="c1">#</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">],</span> <span class="n">fa</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s3&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fa</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

            <span class="n">kmax</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">kmax</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
            <span class="n">db</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s3</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1e-15</span><span class="p">))</span>
            <span class="n">col</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">db</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">seuildb</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">db</span> <span class="o">+</span> <span class="n">seuildb</span><span class="p">)</span> <span class="o">/</span> <span class="n">seuildb</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">kmax</span><span class="p">],</span> <span class="n">fa</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>
                   <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">hot</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">xl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">yl</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency (GHz)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>

                <span class="c1">#echelle=[str(0), str(-10), str(-20), str(-30), str(-40), str(-50)]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;s2&#39;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">typ</span> <span class="o">==</span><span class="s1">&#39;s3&#39;</span><span class="p">)</span> <span class="p">:</span>

            <span class="n">echelle</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">40</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">30</span><span class="p">),</span> 
                       <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">20</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="n">seuildb</span><span class="p">)]</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">echelle</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
                <span class="n">t</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">titre</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span></div>

<span class="k">class</span> <span class="nc">VSHCoeff</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Vector Spherical Harmonics Coefficients class</span>


<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>

<span class="sd">    Bi</span>
<span class="sd">    Br</span>
<span class="sd">    Ci</span>
<span class="sd">    Cr</span>


<span class="sd">    Notes</span>
<span class="sd">    ------</span>

<span class="sd">    Br = VCoeff(br)</span>
<span class="sd">    Bi = VCoeff(bi)</span>
<span class="sd">    Cr = VCoeff(cr)</span>
<span class="sd">    Ci = VCoeff(ci)</span>

<span class="sd">    C  = VSHCoeff(Br,Bi,Cr,Ci)</span>

<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="VSHCoeff.__init__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.__init__.html#pylayers.antprop.spharm.VSHCoeff.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Br</span><span class="p">,</span> <span class="n">Bi</span><span class="p">,</span> <span class="n">Cr</span><span class="p">,</span> <span class="n">Ci</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Init  VSHCoeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Br</span>
<span class="sd">        Bi</span>
<span class="sd">        Cr</span>
<span class="sd">        Ci</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span> <span class="o">=</span> <span class="n">Br</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span> <span class="o">=</span> <span class="n">Bi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span> <span class="o">=</span> <span class="n">Cr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span> <span class="o">=</span> <span class="n">Ci</span></div>

<div class="viewcode-block" id="VSHCoeff.__repr__"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.__repr__.html#pylayers.antprop.spharm.VSHCoeff.__repr__">[docs]</a>    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="s2">&quot;Br&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;-------------&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Bi&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;-------------&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Cr&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;-------------&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;Ci&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="s2">&quot;-------------&quot;</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">__repr__</span><span class="p">()</span>
        <span class="k">return</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> </div>

<div class="viewcode-block" id="VSHCoeff.plot"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.plot.html#pylayers.antprop.spharm.VSHCoeff.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s3&#39;</span><span class="p">,</span><span class="n">titre</span><span class="o">=</span><span class="s1">&#39;titre&#39;</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">subp</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; plot coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ</span>
<span class="sd">        titre</span>
<span class="sd">        log</span>
<span class="sd">        stem</span>
<span class="sd">        subp</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span>
        <span class="n">st</span> <span class="o">=</span> <span class="n">titre</span><span class="o">+</span><span class="s1">&#39;  shape : &#39;</span><span class="o">+</span><span class="n">typ</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subp</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$\sum_f \sum_m |Br_{l}^{(m)}(f)|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">titre</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subp</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$\sum_f \sum_m |Bi_{l}^{(m)}(f)|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">titrei</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subp</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$\sum_f \sum_m |Cr_{l}^{(m)}(f)|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subp</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$\sum_f \sum_m |Ci_{l}^{(m)}(f)|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">stem</span><span class="o">=</span><span class="n">stem</span><span class="p">,</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">subp</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="s1">&#39;$\sum_f \sum_m |Br_{l}^{(m)}(f)|$&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;$\sum_f \sum_m |Bi_{l}^{(m)}(f)|$&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;$\sum_f \sum_m |Cr_{l}^{(m)}(f)|$&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;$\sum_f \sum_m |Ci_{l}^{(m)}(f)|$&#39;</span><span class="p">))</span></div>

<div class="viewcode-block" id="VSHCoeff.show"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.show.html#pylayers.antprop.spharm.VSHCoeff.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">M</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">kmax</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">seuildb</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span>
             <span class="n">animate</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">titre</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; show VSH coeff</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        typ : str</span>
<span class="sd">            {&#39;s1&#39;,&#39;s2&#39;,&#39;s3&#39;}</span>
<span class="sd">        k  : int</span>
<span class="sd">            frequency index</span>
<span class="sd">        kmax : int</span>
<span class="sd">            maximum of the unfolded coefficient axes</span>
<span class="sd">        N  : int</span>
<span class="sd">        M  : int</span>
<span class="sd">        seuildB  : float</span>
<span class="sd">        animate : boolean</span>
<span class="sd">                default False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">animate</span><span class="p">:</span>
            <span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">Nf</span><span class="p">)</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">titre</span><span class="o">+</span><span class="s1">&#39;  shape : &#39;</span><span class="o">+</span><span class="n">typ</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">st</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Br_{n}^{(m)}|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">titre</span><span class="o">=</span><span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Bi_{n}^{(m)}|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">titre</span><span class="o">=</span><span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Cr_{n}^{(m)}|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span><span class="n">titre</span><span class="o">=</span><span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
            <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Ci_{n}^{(m)}|$&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="n">typ</span><span class="p">,</span> <span class="n">titre</span> <span class="o">=</span> <span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">Nf</span><span class="p">):</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
                <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Br_{n}^{(m)}|$&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">titre</span> <span class="o">=</span> <span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
                <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Bi_{n}^{(m)}|$&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">titre</span> <span class="o">=</span> <span class="n">titre</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
                <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Cr_{n}^{(m)}|$&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">titre</span> <span class="o">=</span> <span class="n">titre</span> <span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
                <span class="n">titre</span> <span class="o">=</span> <span class="s1">&#39;$|Ci_{n}^{(m)}|$&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">titre</span> <span class="o">=</span> <span class="n">titre</span> <span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></div>
    <span class="c1">#    show()</span>

<div class="viewcode-block" id="VSHCoeff.s1tos2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.s1tos2.html#pylayers.antprop.spharm.VSHCoeff.s1tos2">[docs]</a>    <span class="k">def</span> <span class="nf">s1tos2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L2</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert shape 1 to shape 2</span>

<span class="sd">        shape 1   array [ Nf x (L+1) x (M+1) ]</span>
<span class="sd">        shape 2   array [ Nf x (L+1)*(M+1)   ]</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        L2 : max level</span>
<span class="sd">            default (-1 means all values)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s1tos2</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s1tos2</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s1tos2</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s1tos2</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span></div>

<div class="viewcode-block" id="VSHCoeff.s2tos3_new"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.s2tos3_new.html#pylayers.antprop.spharm.VSHCoeff.s2tos3_new">[docs]</a>    <span class="k">def</span> <span class="nf">s2tos3_new</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert vector spherical coefficient from shape 2 to shape 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        k : number of coeff</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">EBr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">EBi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">E</span>  <span class="o">=</span> <span class="n">EBr</span> <span class="o">+</span> <span class="n">EBi</span> <span class="o">+</span> <span class="n">ECr</span> <span class="o">+</span> <span class="n">ECi</span>

        <span class="n">ib</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">E</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1">#ind = np.nonzero(E &gt; (E.max() * threshold))[0]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ib</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">ib</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span></div>

<div class="viewcode-block" id="VSHCoeff.s2tos3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.s2tos3.html#pylayers.antprop.spharm.VSHCoeff.s2tos3">[docs]</a>    <span class="k">def</span> <span class="nf">s2tos3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; convert vector spherical coefficients from shape 2 to shape 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        threshold : float</span>
<span class="sd">            default 1e-20</span>

<span class="sd">        Energy thresholded coefficients</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># integrates energy over frequency  axis = 0</span>
        <span class="n">EBr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">EBi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">EBr</span> <span class="o">+</span> <span class="n">EBi</span> <span class="o">+</span> <span class="n">ECr</span> <span class="o">+</span> <span class="n">ECi</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span><span class="n">E</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="n">threshold</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">ind2</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s2</span><span class="p">[:,</span> <span class="n">ind</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">k2</span> <span class="o">=</span> <span class="n">ind</span></div>



<div class="viewcode-block" id="VSHCoeff.s3tos2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.s3tos2.html#pylayers.antprop.spharm.VSHCoeff.s3tos2">[docs]</a>    <span class="k">def</span> <span class="nf">s3tos2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; shape 3 to shape 2</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s3tos2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s3tos2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s3tos2</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s3tos2</span><span class="p">()</span></div>

<div class="viewcode-block" id="VSHCoeff.strip3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.strip3.html#pylayers.antprop.spharm.VSHCoeff.strip3">[docs]</a>    <span class="k">def</span> <span class="nf">strip3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Thresholded coefficient conversion</span>

<span class="sd">        The s3 minimum energy coefficient is deleted</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        ind : int</span>
<span class="sd">        ind3 : int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">EBr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">EBi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">EBr</span> <span class="o">+</span> <span class="n">EBi</span> <span class="o">+</span> <span class="n">ECr</span> <span class="o">+</span> <span class="n">ECi</span>

        <span class="n">Emin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
        <span class="n">ind</span>  <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">E</span> <span class="o">==</span> <span class="n">Emin</span><span class="p">)</span>
        <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind3</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind3</span></div>

    <span class="k">def</span> <span class="nf">energy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;s1&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; returns aggregated energy over all coefficients</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        typ : string</span>
<span class="sd">            {&#39;s1&#39;|&#39;s2&#39;|&#39;s3&#39;}</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        E  : np.array in the same shape as typ</span>
<span class="sd">            s1 : (f,l,m)</span>
<span class="sd">            s2 : (f,l*m)</span>
<span class="sd">            s3 : (f,ncoeff&lt;lm)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">EBr</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="p">,</span><span class="n">typ</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">EBi</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="p">,</span><span class="n">typ</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">ECr</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="p">,</span><span class="n">typ</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">ECi</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="p">,</span><span class="n">typ</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span>

        <span class="n">E</span> <span class="o">=</span> <span class="n">EBr</span> <span class="o">+</span> <span class="n">EBi</span> <span class="o">+</span> <span class="n">ECr</span> <span class="o">+</span> <span class="n">ECi</span>

        <span class="c1">#EBr = np.sum(np.abs(self.Br.s3) ** 2, axis=0)</span>
        <span class="c1">#EBi = np.sum(np.abs(self.Bi.s3) ** 2, axis=0)</span>
        <span class="c1">#ECr = np.sum(np.abs(self.Cr.s3) ** 2, axis=0)</span>
        <span class="c1">#ECi = np.sum(np.abs(self.Ci.s3) ** 2, axis=0)</span>

        <span class="c1">#E = EBr + EBi + ECr + ECi</span>
        <span class="c1">#u = np.argsort(E)</span>
        <span class="c1">#Es = E[u]</span>

        <span class="k">return</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>

<div class="viewcode-block" id="VSHCoeff.drag3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.drag3.html#pylayers.antprop.spharm.VSHCoeff.drag3">[docs]</a>    <span class="k">def</span> <span class="nf">drag3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Emin</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; thresholded coefficient conversion</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Emin : Minimum energy</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">EBr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">EBi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ECi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">s3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">EBr</span> <span class="o">+</span> <span class="n">EBi</span> <span class="o">+</span> <span class="n">ECr</span> <span class="o">+</span> <span class="n">ECi</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="n">find</span><span class="p">(</span><span class="n">E</span> <span class="o">==</span> <span class="n">Emin</span><span class="p">)</span>

        <span class="n">ind3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">ind3</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">delete3</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ind</span><span class="p">,</span> <span class="n">ind3</span></div>

<div class="viewcode-block" id="VSHCoeff.put3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VSHCoeff.put3.html#pylayers.antprop.spharm.VSHCoeff.put3">[docs]</a>    <span class="k">def</span> <span class="nf">put3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;  put 3</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        i : int</span>
<span class="sd">        i3 : int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Br</span><span class="o">.</span><span class="n">put3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Bi</span><span class="o">.</span><span class="n">put3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Cr</span><span class="o">.</span><span class="n">put3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Ci</span><span class="o">.</span><span class="n">put3</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">i3</span><span class="p">)</span></div>

<div class="viewcode-block" id="AFLegendre3"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.AFLegendre3.html#pylayers.antprop.spharm.AFLegendre3">[docs]</a><span class="k">def</span> <span class="nf">AFLegendre3</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; calculate Pmm1l and Pmp1l</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        L : int</span>
<span class="sd">            max order  (theta)   (also called l or level )</span>
<span class="sd">        M : int</span>
<span class="sd">            max degree (phi)</span>
<span class="sd">        x : np.array</span>
<span class="sd">            function argument</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Pmm1l : ndarray (Nx , L , M )</span>
<span class="sd">        :math:`\\bar{P}_{l}^{(m-1)}(x)`</span>

<span class="sd">    Pmp1l : ndarray (Nx , L , M )</span>
<span class="sd">        :math:`\\bar{P}_{l}^{(m+1)}(x)`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This function returns :</span>
<span class="sd">        .. math::</span>

<span class="sd">            \\bar{P}_{l}^{(m-1)}(x)</span>

<span class="sd">            \\bar{P}_{l}^{(m+1)}(x)</span>

<span class="sd">     Where</span>

<span class="sd">        .. math::</span>

<span class="sd">            P_l^{(m)}(x)= \\sqrt{ \\frac{2}{2 l+1} \\frac{(l+m)!}{(l-m)!} } \\bar{P}_{l}^{(m)}(x)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>


<span class="sd">    &gt;&gt;&gt; Pmm1l,Pmp1l = AFLegendre3(5,4,np.array([0,1]))</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    L has to be greater or equal than M</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    VW</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PML</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">M</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">x</span>  <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nx</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="c1"># Warning : this is a dangerous factorial ratio</span>
    <span class="c1"># surprinsingly it works well</span>
    <span class="c1">#</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">LL</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">LL</span> <span class="o">-</span> <span class="n">MM</span><span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">LL</span> <span class="o">+</span> <span class="n">MM</span><span class="p">))</span>
    <span class="n">Pml</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">lpmv</span><span class="p">(</span><span class="n">MM</span><span class="p">,</span><span class="n">LL</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">C1</span>

    <span class="n">Pml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">Pml</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">Pml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">Pml</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">Pmp1l</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">Pmm1l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">Pmm1l</span><span class="p">,</span> <span class="n">Pmp1l</span></div>

<div class="viewcode-block" id="AFLegendre2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.AFLegendre2.html#pylayers.antprop.spharm.AFLegendre2">[docs]</a><span class="k">def</span> <span class="nf">AFLegendre2</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; calculate Pmm1l and Pmp1l</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">        L : int</span>
<span class="sd">            max order  (theta)   (also called l or level )</span>
<span class="sd">        M : int</span>
<span class="sd">            max degree (phi)</span>
<span class="sd">        x : np.array</span>
<span class="sd">            function argument</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Pmm1l : ndarray (Nx , L , M )</span>
<span class="sd">        :math:`\\bar{P}_{l}^{(m-1)}(x)`</span>

<span class="sd">    Pmp1l : ndarray (Nx , L , M )</span>
<span class="sd">        :math:`\\bar{P}_{l}^{(m+1)}(x)`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This function returns :</span>
<span class="sd">        .. math::</span>

<span class="sd">            \\bar{P}_{l}^{(m-1)}(x)</span>

<span class="sd">            \\bar{P}_{l}^{(m+1)}(x)</span>

<span class="sd">     Where</span>

<span class="sd">        .. math::</span>

<span class="sd">            P_l^{(m)}(x)= \\sqrt{ \\frac{2}{2 l+1} \\frac{(l+m)!}{(l-m)!} } \\bar{P}_{l}^{(m)}(x)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>


<span class="sd">    &gt;&gt;&gt; Pmm1l,Pmp1l = AFLegendre2(5,4,np.array([0,1]))</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    L has to be greater or equal than M</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    VW</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PML</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">LL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="c1"># Warning : this is a dangerous factorial ratio</span>
    <span class="c1"># surprinsingly it works well</span>
    <span class="c1">#</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">LL</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">LL</span> <span class="o">-</span> <span class="n">MM</span><span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">LL</span> <span class="o">+</span> <span class="n">MM</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
            <span class="n">pml</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">lpmn</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pml</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">lpmn</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pml</span> <span class="o">=</span> <span class="n">pml</span> <span class="o">*</span> <span class="n">C1</span>
        <span class="n">PML</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pml</span><span class="p">)</span>

    <span class="n">Pml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">PML</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">Pmp1l</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">Pmm1l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">L</span><span class="p">:</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pml</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pml</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">Pmm1l</span><span class="p">,</span> <span class="n">Pmp1l</span></div>

<div class="viewcode-block" id="AFLegendre"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.AFLegendre.html#pylayers.antprop.spharm.AFLegendre">[docs]</a><span class="k">def</span> <span class="nf">AFLegendre</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; calculate Pmm1n and Pmp1n</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    N : int</span>
<span class="sd">        max order  (theta)   (also called l or level )</span>
<span class="sd">    M : int</span>
<span class="sd">        max degree (phi)</span>
<span class="sd">    x : np.array</span>
<span class="sd">            function argument</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    Pmm1l :  ndarray ( Ndir, M , L ) </span>

<span class="sd">        :math:`\\bar{P}_{n}^{(m-1)}(x)`</span>
<span class="sd">    Pmp1l :  ndarray ( Ndir, M , L )</span>
<span class="sd">        :math:`\\bar{P}_{n}^{(m+1)}(x)`</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>

<span class="sd">    This function returns :</span>
<span class="sd">        .. math::</span>

<span class="sd">            \\bar{P}_{l}^{(m-1)}(x)</span>

<span class="sd">            \\bar{P}_{l}^{(m+1)}(x)</span>

<span class="sd">     Where</span>

<span class="sd">        .. math::</span>

<span class="sd">            P_l^{(m)}(x)= \\sqrt{ \\frac{2}{2 l+1} \\frac{(l+m)!}{(l-m)!} } \\bar{P}_{l}^{(m)}(x)</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; Pmm1n,Pmp1n = AFLegendre(5,4,np.array([0,1]))</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    VW</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">PMN</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">NN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">MM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">NN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="c1">#</span>
    <span class="c1"># Warning : this is a dangerous factorial ratio</span>
    <span class="c1"># surprinsingly it works well</span>
    <span class="c1">#</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">NN</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">NN</span> <span class="o">-</span> <span class="n">MM</span><span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">NN</span> <span class="o">+</span> <span class="n">MM</span><span class="p">))</span>
    <span class="k">del</span> <span class="n">MM</span>
    <span class="k">del</span> <span class="n">NN</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
            <span class="n">pmn</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">lpmn</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pmn</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">lpmn</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pmn</span> <span class="o">=</span> <span class="n">pmn</span> <span class="o">*</span> <span class="n">C1</span>
        <span class="n">PMN</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmn</span><span class="p">)</span>

    <span class="n">Pmn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">PMN</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">Pmp1n</span> <span class="o">=</span> <span class="n">Pmn</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmp1n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">Pmp1n</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pmn</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="n">Pmm1n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nx</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">M</span> <span class="o">&lt;</span> <span class="n">N</span><span class="p">:</span>
        <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pmn</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">Pmn</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Pmn</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">Pmm1n</span><span class="p">,</span> <span class="n">Pmp1n</span></div>

<div class="viewcode-block" id="VW2"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VW2.html#pylayers.antprop.spharm.VW2">[docs]</a><span class="k">def</span> <span class="nf">VW2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">Pmm1l</span><span class="p">,</span> <span class="n">Pmp1l</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; evaluate vector Spherical Harmonics basis functions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    l    : ndarray (1 x K)</span>
<span class="sd">        level</span>
<span class="sd">    m    : ndarray (1 x K)</span>
<span class="sd">        mode</span>
<span class="sd">    x    :  ndarray (1 x Nray)</span>

<span class="sd">    phi   : np.array (1 x Nray)</span>

<span class="sd">    Pmm1l : Legendre Polynomial</span>

<span class="sd">    Pmp1l : Legendre Polynomial</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    V  : ndarray (Nray , L, M)</span>
<span class="sd">    W  : ndarray (Nray , L, M)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    AFLegendre</span>

<span class="sd">    Nx x M x L</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">K</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">Nr</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">l</span>   <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">m</span>   <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span>   <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">Ephi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>

    <span class="n">Y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">Y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>

    <span class="n">W</span> <span class="o">=</span> <span class="n">Y1</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="n">Ephi</span>
    <span class="n">W</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">W</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Y2</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="n">Ephi</span>
    <span class="n">V</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">V</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span></div>

<div class="viewcode-block" id="VW"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VW.html#pylayers.antprop.spharm.VW">[docs]</a><span class="k">def</span> <span class="nf">VW</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">theta</span> <span class="p">,</span><span class="n">phi</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; evaluate vector Spherical Harmonics basis functions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    l    : ndarray (1 x K)</span>
<span class="sd">        level</span>
<span class="sd">    m    : ndarray (1 x K)</span>
<span class="sd">        mode</span>
<span class="sd">    theta : np.array (1 x Nray)</span>

<span class="sd">    phi   : np.array (1 x Nray)</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    V  : ndarray (Nray , L, M)</span>
<span class="sd">    W  : ndarray (Nray , L, M)</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    AFLegendre</span>

<span class="sd">    Nray x M x L</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">])</span>

    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

    <span class="c1"># dirty fix</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">theta</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">&lt;</span><span class="mf">1e-5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="o">-</span><span class="mf">0.01</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="c1"># The - sign is necessary to get the good reconstruction</span>
    <span class="c1">#     deduced from observation</span>
    <span class="c1">#     May be it comes from a different definition of theta in SPHEREPACK</span>

    <span class="c1">#Pmm1l, Pmp1l = AFLegendre(L, M, x)</span>

    <span class="n">Pmm1l</span><span class="p">,</span> <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">AFLegendre</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

    <span class="n">K</span>   <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="n">Nr</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">l</span>   <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">m</span>   <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span>   <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">Ephi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">phi</span><span class="p">)</span>

    <span class="n">Y1</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>
    <span class="n">Y2</span> <span class="o">=</span> <span class="p">(</span><span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span><span class="n">m</span><span class="p">,</span><span class="n">l</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Nr</span><span class="p">,</span><span class="n">K</span><span class="p">)</span>

    <span class="n">T</span> <span class="o">=</span>  <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">*</span> <span class="n">Ephi</span>
    <span class="c1">#W = Y1 * (-1.0) ** l / (2 * x * np.sqrt(l * (l + 1))) * Ephi</span>
    <span class="c1">#V = Y2 * (-1.0) ** l / (2 * np.sqrt(l * (l + 1))) * Ephi</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">Y1</span> <span class="o">*</span> <span class="n">T</span> <span class="o">/</span> <span class="n">x</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Y2</span> <span class="o">*</span> <span class="n">T</span>
    <span class="c1">#</span>
    <span class="c1"># dirty fix</span>
    <span class="c1">#</span>
    <span class="c1">#W[np.isinf(W) | np.isnan(W)] = 0</span>
    <span class="c1">#V[np.isinf(V) | np.isnan(V)] = 0</span>

    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span></div>

<div class="viewcode-block" id="VW0"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.VW0.html#pylayers.antprop.spharm.VW0">[docs]</a><span class="k">def</span> <span class="nf">VW0</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">Pmm1n</span><span class="p">,</span> <span class="n">Pmp1n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; evaluate vector Spherical Harmonics basis functions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n    : int</span>
<span class="sd">        level</span>
<span class="sd">    m    : int</span>
<span class="sd">        mode</span>
<span class="sd">    x    :  np.array</span>
<span class="sd">        function argument</span>
<span class="sd">    phi   : np.array</span>
<span class="sd">    Pmm1n : Legendre Polynomial</span>
<span class="sd">    Pmp1n : Legendre Polynomial</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>

<span class="sd">    V</span>
<span class="sd">    W</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    &gt;&gt;&gt; from pylayers.antprop.antenna import *</span>
<span class="sd">    &gt;&gt;&gt; N = 2</span>
<span class="sd">    </span>
<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    AFLegendre</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="n">Y1</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>
    <span class="n">Y2</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>

    <span class="n">Mphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
    <span class="n">Ephi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span> <span class="o">*</span> <span class="n">Mphi</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">Mphi</span>
    <span class="n">Y1</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>
    <span class="n">Y2</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1n</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">t1</span>
    <span class="k">del</span> <span class="n">t2</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">Y1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span> <span class="o">*</span> <span class="n">Ephi</span>
    <span class="n">W</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">W</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">W</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">del</span> <span class="n">Y1</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">Y2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))))</span> <span class="o">*</span> <span class="n">Ephi</span>
    <span class="n">V</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">V</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">del</span> <span class="n">Y2</span>
    <span class="k">return</span> <span class="n">V</span><span class="p">,</span> <span class="n">W</span></div>

<div class="viewcode-block" id="plotVW"><a class="viewcode-back" href="../../../modules/generated/pylayers.antprop.spharm.plotVW.html#pylayers.antprop.spharm.plotVW">[docs]</a><span class="k">def</span> <span class="nf">plotVW</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; plot VSH transform vsh basis in 3D plot</span>

<span class="sd">        (V in fig1 and W in fig2)</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    n,m   : integer values (m&lt;=n)</span>
<span class="sd">    theta : ndarray</span>
<span class="sd">    phi   : ndarray</span>
<span class="sd">    sf    : boolean</span>
<span class="sd">        if sf : plotted figures are saved in a *.png file</span>
<span class="sd">        else  : plotted figures aren&#39;t saved</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    .. plot::</span>
<span class="sd">        :include-source:</span>

<span class="sd">        &gt;&gt;&gt; from pylayers.antprop.spharm import *</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; n=5</span>
<span class="sd">        &gt;&gt;&gt; m=3</span>
<span class="sd">        &gt;&gt;&gt; theta = np.linspace(0,np.pi,30)</span>
<span class="sd">        &gt;&gt;&gt; phi   = np.linspace(0,2*np.pi,60)</span>
<span class="sd">        &gt;&gt;&gt; plotVW(n,m,theta,phi)</span>
<span class="sd">        &gt;&gt;&gt; plt.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate v and w</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">&lt;=</span> <span class="n">l</span><span class="p">:</span>
        <span class="n">theta</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">theta</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span>  <span class="mf">1e-10</span>  <span class="c1"># .. todo :: not clean</span>
        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

        <span class="n">Pmm1l</span><span class="p">,</span> <span class="n">Pmp1l</span> <span class="o">=</span> <span class="n">AFLegendre</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

        <span class="n">t1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">l</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">y1</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">-</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">Pmm1l</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span> <span class="o">+</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">Pmp1l</span><span class="p">[:,</span> <span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">]</span>

        <span class="n">Ephi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1j</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
        <span class="n">cphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sphi</span> <span class="o">=</span> <span class="mf">1e-10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sphi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>

        <span class="n">ny</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
        <span class="n">ne</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ephi</span><span class="p">)</span>
        <span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ny</span><span class="p">)</span>
        <span class="n">ve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">ne</span><span class="p">)</span>
        <span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">ve</span><span class="p">)</span>
        <span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="n">ve</span><span class="p">)</span>
        <span class="n">EPh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">vy</span><span class="p">,</span> <span class="n">Ephi</span><span class="p">)</span>

        <span class="n">const</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">**</span> <span class="n">l</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
        <span class="n">V</span> <span class="o">=</span> <span class="n">const</span> <span class="o">*</span> <span class="n">Y1</span> <span class="o">*</span> <span class="n">EPh</span>
        <span class="c1">#V[np.isinf(V)|isnan(V)]=0</span>
        <span class="n">Vcos</span> <span class="o">=</span> <span class="n">cphi</span> <span class="o">*</span> <span class="n">V</span>
        <span class="n">Vsin</span> <span class="o">=</span> <span class="n">sphi</span> <span class="o">*</span> <span class="n">V</span>

        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#W=np.zeros((len(theta),len(phi)))</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">phi</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">1e-10</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Waux</span> <span class="o">=</span> <span class="n">Y2</span> <span class="o">*</span> <span class="n">EPh</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">x</span>
            <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">const</span><span class="p">)</span> <span class="o">*</span> <span class="n">Waux</span>

        <span class="n">Wcos</span> <span class="o">=</span> <span class="n">cphi</span> <span class="o">*</span> <span class="n">W</span>
        <span class="n">Wsin</span> <span class="o">=</span> <span class="n">sphi</span> <span class="o">*</span> <span class="n">W</span>

        <span class="c1">#figdirV=&#39;/home/rburghel/Bureau/bases_decomposition_VW/base_V_Vsin_Vcos/&#39;</span>
        <span class="n">figdirV</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
        <span class="n">ext1</span> <span class="o">=</span> <span class="s1">&#39;.pdf&#39;</span>
        <span class="n">ext2</span> <span class="o">=</span> <span class="s1">&#39;.eps&#39;</span>
        <span class="n">ext3</span> <span class="o">=</span> <span class="s1">&#39;.png&#39;</span>
        <span class="n">slm</span> <span class="o">=</span> <span class="s1">&#39; l = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39; m = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig1</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">V</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$|V|$&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig2</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Vcos</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Re V$&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">fig3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig3</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Vsin</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Im V$&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">fig4</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig4</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">W</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$|W|$&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">fig5</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig5</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Wcos</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Re W&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">fig6</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">pol3D</span><span class="p">(</span><span class="n">fig6</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">Wsin</span><span class="p">),</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;$\Im W$&#39;</span><span class="o">+</span><span class="n">slm</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;Error: m&gt;n!!!&quot;</span></div>


<span class="k">if</span> <span class="p">(</span><span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; 2015, PyLayers developer team.
      Last updated on avril 06, 2016.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.5. Design by <a href="http://desgrana.es">Desgrana</a>.
    </div>
     <div class="rel">
    
    <div class="buttonPrevious">
      <a href="../../../py-modindex.html">
        Previous
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#AFFFFF');
           },
           function () {
               $(this).css('background-color', '#AFFFFF');
           }
       );
     </script>
  </body>
</html>