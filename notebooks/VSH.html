<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Vector Spherical Harmonics &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../index.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../index.html"><img src="../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../documentation.html">Documentation </a> |&nbsp;</li>
        <li><a href="../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vector Spherical Harmonics</a><ul>
<li><a class="reference internal" href="#vector-spherical-harmonics-function">Vector spherical Harmonics function</a></li>
<li><a class="reference internal" href="#vector-spherical-harmonics-transform-step">Vector Spherical Harmonics transform step</a></li>
<li><a class="reference internal" href="#associated-legendre-function">Associated Legendre Function</a><ul>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#properties">Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#derivation-of-recurrence-formulas-on">Derivation of Recurrence Formulas on <img class="math" src="../_images/math/134735e587a2a82b30a1b387c1988060508003be.png" alt="\bar{P}_l^{(m)}(x)"/></a></li>
<li><a class="reference internal" href="#id1">Derivation of Recurrence formulas on <img class="math" src="../_images/math/961b35b8a78e432992eb06cc04d1747132f49086.png" alt="\frac{d\bar{P}_l^{(m)}}{dx}(x)"/></a><ul>
<li><a class="reference internal" href="#evaluation-of-negative-order">Evaluation of negative order</a></li>
</ul>
</li>
<li><a class="reference internal" href="#practical-implementation">Practical Implementation</a></li>
<li><a class="reference internal" href="#the-vector-spherical-harmonics-functions">The Vector Spherical Harmonics Functions <img class="math" src="../_images/math/6ae81d119f7e1cec5bb84366cae5435ac8231234.png" alt="\bar{V}_l^{(m)}"/></a></li>
<li><a class="reference internal" href="#calculation-of">Calculation of <img class="math" src="../_images/math/385effffb525dac878a4a3932e25759aa4e75fb2.png" alt="\bar{W}_l^{(m)}"/></a></li>
<li><a class="reference internal" href="#norm-of">Norm of <img class="math" src="../_images/math/65d6c5b9946deb02e1a617fce51541ab8f9c5446.png" alt="V_l^{(m)}(x)"/></a></li>
<li><a class="reference internal" href="#id2">Norm of <img class="math" src="../_images/math/76107a2211718e838456e6323bcbc535b070f494.png" alt="\bar{W}_l^{(m)}(x)"/></a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="vector-spherical-harmonics">
<h1>Vector Spherical Harmonics<a class="headerlink" href="#vector-spherical-harmonics" title="Permalink to this headline">¶</a></h1>
<p>In a first step the VSH coefficients are calculated from raw data
describing the full sampled complex radiation pattern over the whole
sphere and for the two orthogonal linear polarizations.</p>
<p>This step can be done once off-line to build an antenna database which
exploits the sparse VSH decomposition.</p>
<div class="math">
<p><img src="../_images/math/a784d3110f7ab6074fa089b03091701f57c5d9b9.png" alt="S_1 : \mathbb{C}^{2 \times N_{\theta} \times N_{\phi} \times N_{f}}
\rightarrow
\mathbb{C}^{4 \times N_{c} }"/></p>
</div><p>In a second step field quantities are generated from the VSH
coefficients for a given set of directions corresponding to the DOD/DOA
of the rays coming out the RT engine.</p>
<div class="math">
<p><img src="../_images/math/95e980d567cda1f614e9fbbb1bdafd2cc36d0c15.png" alt="S_2 : \mathbb{C}^{4 \times N_{c} }
\rightarrow
\mathbb{C}^{2 \times N_{r} \times N_{f}}"/></p>
</div><p>One of the interest in doing this decomposition comes from the fact that
the number of directions of interest <img class="math" src="../_images/math/14b3fd8351471a516e4748ab11cd1ef52d51d702.png" alt="N_r"/> is by far lower than
the number required for the exhaustive sampling of the sphere needed at
the starting point of the synthesis step. In practice, for a given
channel, we do not need to calculate the field in all directions but
only for a limited number of them. The alternative approach would
consist in going through an interpolation procedure into the initial
data structure, what could be either slower if the grid is tight or
poorly accurate.</p>
<p>We are dealing with a set of complex quantities that belongs to
where <img class="math" src="../_images/math/4d42ca344738ccde18857be33fe80e37ea08dd4e.png" alt="N_{\theta}"/>,:math:<cite>N_{phi}</cite>,:math:<cite>N_f</cite> states
respectively for the number of angle <img class="math" src="../_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta"/> <img class="math" src="../_images/math/2c175f60eecef1de7560c3bdea495d69f26f719d.png" alt="\phi"/> and
frequency point. In practice in a ray tracing tool a direction of</p>
<div class="math">
<p><img src="../_images/math/0404202a74babd5c1655423400379d0d7cd82d5a.png" alt="\mathbb{C}^{2 \times N_{r} \times N_{f}}

:math:`N_r` is the number of rays."/></p>
</div><div class="math">
<p><img src="../_images/math/4eea32cccf39251b8629463c3bee75d9afef7b2c.png" alt="% use packages: array
\mathbf{F}(f,\theta,\phi) =
\left[
\begin{array}{l}
F_{\theta}(f,\theta,\phi)\\
F_{\phi}(f,\theta,\phi)
\end{array}
\right]"/></p>
</div><div class="section" id="vector-spherical-harmonics-function">
<h2>Vector spherical Harmonics function<a class="headerlink" href="#vector-spherical-harmonics-function" title="Permalink to this headline">¶</a></h2>
<p>The vector spherical harmonics are based on the function
<img class="math" src="../_images/math/6ae81d119f7e1cec5bb84366cae5435ac8231234.png" alt="\bar{V}_l^{(m)}"/> and <img class="math" src="../_images/math/385effffb525dac878a4a3932e25759aa4e75fb2.png" alt="\bar{W}_l^{(m)}"/></p>
<div class="math">
<p><img src="../_images/math/e85e3386b083257a593ef53b383c9037abd2b135.png" alt="\bar{V}_l^{(m)}(x)=(-1)^{n} \frac{\sqrt{1-x^2}}{\sqrt{l(l+1)}}\bar{P}_l^{(m)'}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/8e8a8371b6bafbc2232191954ed9245b7555aa1b.png" alt="\bar{V}_l^{(m)}(x)
= \frac{ (-1)^n } {  2\sqrt{l(l+1) } }
  \left(
  \sqrt{(l+m)(l-m+1)} \bar{P}_l^{(m-1)}(x)
-  \sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(x)
  \right)"/></p>
</div><div class="math">
<p><img src="../_images/math/beecf1a7d8a6ef3f6cbef8c57049d7594c2d2f96.png" alt="\bar{W}_l^{(m)}(x)=\frac{(-1)^{n} m}{\sqrt{1-x^2}\sqrt{l(l+1)}}\bar{P}_l^{(m)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/b8ee2b6295000d5e1d876551ccabfcadefa52706.png" alt="\bar{W}_l^{(m)}(x)=
\frac{(-1)^{n}}{2x\sqrt{l(l+1)}}
\left[
\sqrt{(l+m)(l-m+1)}
\bar{P}_l^{(m-1)}(x)+
\sqrt{  (l-m) (l+m+1)}
\bar{P}_l^{(m+1)}(x)
\right]"/></p>
</div></div>
<div class="section" id="vector-spherical-harmonics-transform-step">
<h2>Vector Spherical Harmonics transform step<a class="headerlink" href="#vector-spherical-harmonics-transform-step" title="Permalink to this headline">¶</a></h2>
<p>This transform is implemented in the spherepack library in Fortran. The
input is the measured complex pattern and the outpur are</p>
<p>4 complex coefficients arrays which are obtained through the following
projection relations.</p>
<div class="math">
<p><img src="../_images/math/550aca7cd9b266d8621106db2a54ef996bf64b9b.png" alt="br_l^{(m)}  =  \alpha_l^{(m)} \int_{0}^{2\pi}
 \int_{-\pi/2}^{-\pi/2}
( F_{\theta}(\theta,\phi) V_l^{(m)}  \cos{m\phi} -
  F_{\phi}  (\theta,\phi) W_l^{(m)}  \sin{m\phi})
\sin{\theta} d\theta d\phi"/></p>
</div><div class="math">
<p><img src="../_images/math/39c513daf9c8a457b5be79e713dd3fe7392a83a7.png" alt="bi_l^{(m)}  =  \alpha_l^{(m)} \int_{0}^{2\pi}
\int_{-\pi/2}^{-\pi/2}{
( F_{\phi}  (\theta,\phi)  W_l^{(m)} \cos{m\phi} +
  F_{\theta}(\theta,\phi)  V_l^{(m)} \sin{m\phi})
\sin{\theta} d\theta d\phi}"/></p>
</div><div class="math">
<p><img src="../_images/math/f65bdba34e87e7a3c596ea4fe92cb18c4f0d152b.png" alt="cr_l^{(m)} =  \alpha_l^{(m)} \int_{0}^{2\pi} \int_{-\pi/2}^{-\pi/2}
(  F_{\phi}  (\theta,\phi) V_l^{(m)} \cos{m\phi} +
   F_{\theta}(\theta,\phi) W_l^{(m)} \sin{m\phi})
\sin{\theta} d\theta d\phi"/></p>
</div><div class="math">
<p><img src="../_images/math/73820b4ac389deb5eb0fe62aed29608223bdce90.png" alt="ci_l^{(m)} =  \alpha_l^{(m)} \int_{0}^{2\pi} \int_{-\pi/2}^{-\pi/2}
(  -F_{\theta}(\theta,\phi) W_l^{(m)}  \cos{m\phi} +
    F_{\phi}(\theta,\phi)   V_l^{(m)}  \sin{m\phi})
\sin{\theta} d\theta d\phi"/></p>
</div><p>The normalized Legendre polynomial respectively of order <img class="math" src="../_images/math/9b25f8e64b484493fda944d25cad453423041fe6.png" alt="l"/> and
<img class="math" src="../_images/math/6dfb1e5e628439b5aae47f01988e2ac7cdc781bc.png" alt="l-1"/> are satisfying the following relations</p>
<p>The first step consists in evaluating the vector spherical coefficient
for a set of frequencies over the antenna bandwidth.</p>
<p>The two components of the radiated far field are given by the following
expansion which makes use of 4 coefficients.</p>
<p>The problem here addressed is the one of reconstructing as fast as
possible the radiated field from this set of coefficients.</p>
<div class="math">
<p><img src="../_images/math/a73a2c6c5790e500a3be5719936d7d599a4663d3.png" alt="F_{\phi}(\theta,\phi) =
\sum_{l=0}^{L}\sum_{m=0}^l
  W_l^{(m)}(bi_l^{(m)} \cos{m\phi} - br_l^{(m)}\sin{m\phi})  +
  V_l^{(m)}(cr_l^{(m)} \cos{m\phi} + ci_l^{(m)}\sin{m\phi})"/></p>
</div><div class="math">
<p><img src="../_images/math/64c4000273a887f8abe8f536a70b1ca58fab3eda.png" alt="F_{\theta}(\theta,\phi) =
\sum_{l=0}^{L}\sum_{m=0}^n
    V_l^{(m)} ( br_l^{(m)} \cos{m\phi} + bi_l^{(m)} \sin{m\phi})  +
        W_l^{(m)} (-ci_l^{(m)} \cos{m\phi} + cr_l^{(m)} \sin{m\phi})"/></p>
</div><p>In those expressions the expansion functions along the angular parameter
<img class="math" src="../_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta"/> <img class="math" src="../_images/math/1337e53f9cca00ce715dbfb8ee7f2b499e8dc2af.png" alt="V_l^{(m)}"/> and <img class="math" src="../_images/math/ae9be4b04259914b33e079da0ad6e4e3c05623ae.png" alt="W_l^{(m)}"/></p>
<div class="math">
<p><img src="../_images/math/e6d660b710f0080088e0a1471f1784fe327e267e.png" alt="\sqrt{l(l+1)} V_l^{(m)}(\theta) =
\frac{dP_l^{(m)}}{d\theta}      =
\frac{1}{2}  P_l^{(m+1)} -(l+m)(l-m+1) P_l^{(m-1)}"/></p>
</div><div class="math">
<p><img src="../_images/math/72e8c8855af9a29b6bed0db3ed2cd40546acf706.png" alt="\sqrt{l(l+1)} W_l^{(m)}(\theta) =
\frac{m}{\cos\theta}P_l^{(m)}   =
\frac{1}{2} P_{l-1}^{(m+1)} + (l+m)(l+m-1)P_{l-1}^{(m-1)}"/></p>
</div><p>Why <img class="math" src="../_images/math/26eeb5258ca5099acf8fe96b2a1049c48c89a5e6.png" alt="x"/> and <img class="math" src="../_images/math/42781e6e22b30f45c904fcccdaffa1124d6a2d77.png" alt="\cos(\theta)"/> ?</p>
<div class="math">
<p><img src="../_images/math/e07f056bb86e9d3ca8a2872dc0bda0987d0d58cb.png" alt="P_l^{(m)} (x)  =  \frac{1}{2^n l!}  (-\cos\theta)^m
\frac{d^{l+m}}  {dx^{l+m}} (x^2-1)^n"/></p>
</div><div class="math">
<p><img src="../_images/math/4baef932b44458751994077510d5e946e155f950.png" alt="P_{l-1}^{(m)} (x) = \frac{1}{2^{l-1} l!}(-\cos\theta)^m
\frac{d^{l+m-1}} {dx^{l+m-1}} (x^2-1)^{n
-1}"/></p>
</div></div>
<div class="section" id="associated-legendre-function">
<h2>Associated Legendre Function<a class="headerlink" href="#associated-legendre-function" title="Permalink to this headline">¶</a></h2>
<p>The SciPy function <em>lpmn(m,n,z)</em> is an implementation of the Associated
Legendre functions of the first kind, <img class="math" src="../_images/math/b5648ad1379f0556906086b7500101add158fe50.png" alt="P_l^{(m)}(z)"/> and its
derivative, <img class="math" src="../_images/math/43e2211ff5a947c0a40a0037c4ec8bff221393ca.png" alt="P_l^{'(m)}(z)"/> of order <img class="math" src="../_images/math/f5047d1e0cbb50ec208923a22cd517c55100fa7b.png" alt="m"/> and degree
<img class="math" src="../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n"/>.</p>
<p>It returns two arrays of size <img class="math" src="../_images/math/5245660467430076ab47fcf85d334d5e569c0c4d.png" alt="(m+1,l+1)"/> containing
<img class="math" src="../_images/math/b5648ad1379f0556906086b7500101add158fe50.png" alt="P_l^{(m)}(z)"/> and <img class="math" src="../_images/math/43e2211ff5a947c0a40a0037c4ec8bff221393ca.png" alt="P_l^{'(m)}(z)"/> for all orders from
<img class="math" src="../_images/math/c2816d2dfaf9b7ad36b0bff6c522cffc5d57bf4d.png" alt="0 \ldots m"/> and degrees from <img class="math" src="../_images/math/4a226e46f589845d7b8576aad0873a009bb5f84f.png" alt="0 \ldots n"/>. The <img class="math" src="../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z"/>
argument can be complex.</p>
<p>In[ ]:</p>
<p>In[ ]:</p>
<p>Out[ ]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">(</span><span class="n">array</span><span class="p">([[</span> <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.5</span>       <span class="p">,</span> <span class="o">-</span><span class="mf">0.125</span>     <span class="p">,</span> <span class="o">-</span><span class="mf">0.4375</span>    <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">0.8660254</span> <span class="p">,</span> <span class="o">-</span><span class="mf">1.29903811</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.32475953</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">2.25</span>      <span class="p">,</span>  <span class="mf">5.625</span>     <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="o">-</span><span class="mf">9.74278579</span><span class="p">]]),</span>
 <span class="n">array</span><span class="p">([[</span>  <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">1.</span>        <span class="p">,</span>   <span class="mf">1.5</span>       <span class="p">,</span>   <span class="mf">0.375</span>     <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">0.57735027</span><span class="p">,</span>  <span class="o">-</span><span class="mf">1.73205081</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.27868418</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">0.</span>        <span class="p">,</span>  <span class="o">-</span><span class="mf">3.</span>        <span class="p">,</span>   <span class="mf">3.75</span>      <span class="p">],</span>
       <span class="p">[</span>  <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">0.</span>        <span class="p">,</span>   <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">19.48557159</span><span class="p">]]))</span>
</pre></div>
</div>
<div class="section" id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h3>
<p>In this scipy implementation the Condol-Shortley phase <img class="math" src="../_images/math/f9437217dcd1cca1eccdf2d80ab4c9f6fb53a0e3.png" alt="(-1)^m"/> is
already included, thus the expression of the implemented function is
given by :</p>
<div class="math">
<p><img src="../_images/math/7538fc727f9b3f114c76a761dc4d633f3b987bbf.png" alt="P_l^{(m)}(x) = \frac{(-1)^m}{2^{n}l!}(1-x^2)^{\frac{m}{2}} \frac{d^{l+m}}{dx^{l+m}}(x^2-1)^n"/></p>
</div></div>
<div class="section" id="properties">
<h3>Properties<a class="headerlink" href="#properties" title="Permalink to this headline">¶</a></h3>
<p>For associated the two orthogonality relations respectively for
associated Legendre function of different</p>
</div>
</div>
<div class="section" id="derivation-of-recurrence-formulas-on">
<h2>Derivation of Recurrence Formulas on <img class="math" src="../_images/math/134735e587a2a82b30a1b387c1988060508003be.png" alt="\bar{P}_l^{(m)}(x)"/><a class="headerlink" href="#derivation-of-recurrence-formulas-on" title="Permalink to this headline">¶</a></h2>
<p>For the Legendre function of the first kind, we have the following
recurrence property</p>
<div class="math">
<p><img src="../_images/math/30d0bf9f5890f44879ad114db9709a143a6ea6e0.png" alt="2mx P_l^{(m)}(x)=-\sqrt{1-x^2}
\left[
P_l^{(m+1)}(x)+(l+m)(l-m+1)P_l^{(m-1)}(x)
\right]"/></p>
</div><p>Introducing the relation which relates <img class="math" src="../_images/math/dc7647e2f07fbabebff60135d83925b1dab7fec8.png" alt="P_l^{(m)}(x)"/> to
<img class="math" src="../_images/math/349ec3fbcdb7ca5650a566f271c4f6a68bb555cc.png" alt="\bar{P}_l^{(m)(x)}"/></p>
<div class="math">
<p><img src="../_images/math/159818afa2679433cfd752a7d053bcff6967406a.png" alt="P_l^{(m)}(x)= \sqrt{ \frac{2}{2 l+1}  \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/c0c25b2d1cc0c92a4b22967e0253a039664c6068.png" alt="\frac{2mx}{\sqrt{1-x^2}} \sqrt{\frac{(l+m)!}{(l-m)!} } \bar{P}_l^{(m)}(x)
=- \left[ \sqrt{  \frac{(l+m+1)!}{(l-m-1)!} }   \bar{P}_l^{(m+1)}(x)
+ (l+m)(l-m+1) \sqrt{  \frac{(l+m-1)!}{(l-m+1)!} }   \bar{P}_l^{(m-1)}(x) \right]"/></p>
</div><div class="math">
<p><img src="../_images/math/839c38a2809bb1464891c8445921169a4d712791.png" alt="\frac{2mx}{\sqrt{1-x^2}}
\bar{P}_l^{(m)}(x) =-
\sqrt{   \frac{(l-m)!}{(l+m)!} }\left[
\sqrt{  \frac{(l+m+1)!}{(l-m-1)!} }
\bar{P}_l^{(m+1)}(x)
+
(l+m)(l-m+1)
\sqrt{  \frac{(l+m-1)!}{(l-m+1)!} }
\bar{P}_l^{(m-1)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/e49572f030db67ad00468d716a4f26b84ce40edd.png" alt="\bar{P}_l^{(m)}(x) = -
\frac{\sqrt{1-x^2}}{2mx}
\left[
\sqrt{  (l-m) (l+m+1)}
\bar{P}_l^{(m+1)}(x)
+
 \sqrt{(l+m)(l-m+1)}
\bar{P}_l^{(m-1)}(x)
\right]"/></p>
</div></div>
<div class="section" id="id1">
<h2>Derivation of Recurrence formulas on <img class="math" src="../_images/math/961b35b8a78e432992eb06cc04d1747132f49086.png" alt="\frac{d\bar{P}_l^{(m)}}{dx}(x)"/><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../_images/math/843c85c186e8a9c0cc9b443b462b39630f873ce4.png" alt="P_l^{(m)'}(x) = \frac{1}{x^2-1}
\left[
-(l+m)(l-m+1)\sqrt{1-x^2}
P_l^{(m-1)}(x)
-m x
P_l^{(m)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/fa867523c183cf85a8d488cb24f5f388b2632406.png" alt="P_l^{(m)'}(x) = \frac{1}{\sqrt{1-x^2}}
\left[
(l+m)(l-m+1)
P_l^{(m-1)}(x)
+ \frac{m x}{\sqrt{1-x^2}}
P_l^{(m)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/038abb8d41beaabd7e67168b7350989d68390951.png" alt="%P_l^{(m)'}(x)
\sqrt{   \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)'}(x)
= \frac{1}{\sqrt{1-x^2}}
\left[
(l+m)(l-m+1)
\sqrt{  \frac{(l+m-1)!}{(l-m+1)!} }
\bar{P}_l^{(m-1)}(x)
%P_l^{(m-1)}(x)
+ \frac{m x}{\sqrt{1-x^2}}
%P_l^{(m)}(x)
\sqrt{   \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/20d19a6dfdfd6d0ae979792845438fe003f4d6f7.png" alt="%P_l^{(m)'}(x)
\bar{P}_l^{(m)'}(x)
= \frac{1}{\sqrt{1-x^2}}
\sqrt{   \frac{(l-m)!} {(l+m)!}}
\left[
(l+m)(l-m+1)
\sqrt{  \frac{(l+m-1)!}{(l-m+1)!} }
\bar{P}_l^{(m-1)}(x)
%P_l^{(m-1)}(x)
+ \frac{m x}{\sqrt{1-x^2}}
%P_l^{(m)}(x)
\sqrt{   \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/0f76f6da019a4757b8d25676a98039e962906a51.png" alt="\bar{P}_l^{(m)'}(x) = \frac{1}{\sqrt{1-x^2}}
\left[
    \sqrt{(l+m)(l-m+1)}
    \bar{P}_l^{(m-1)}(x)
        P_l^{(m-1)}(x)
    +
    \frac{m x}{\sqrt{1-x^2}} P_l^{(m)}(x)
    \bar{P}_l^{(m)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/a31f7a6df39d65568dd3eeb51080d4f5c0672294.png" alt="\bar{P}_l^{(m)'}(x) = \frac{1}{2\sqrt{1-x^2}} \left[ \sqrt{(l+m) (l-m+1 )}\bar{P}_l^{(m-1)}(x)-\sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(x)  \right]"/></p>
</div><div class="section" id="evaluation-of-negative-order">
<h3>Evaluation of negative order<a class="headerlink" href="#evaluation-of-negative-order" title="Permalink to this headline">¶</a></h3>
<div class="math">
<p><img src="../_images/math/715f8e4a109831c28b5793ada64883bbbedfb6d1.png" alt="P_l^{(-m)}(x)=(-1)^{m}\frac{(l-m)!}{(l+m)!}P_l^{(m)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/a7a699f9a42b95371227fd3d32b8bb6493062b0e.png" alt="\sqrt{  \frac{(l-m)!}{(l+m)!} }
\bar{P}_l^{(-m)}(x)
=(-1)^{m}
\frac{(l-m)!}{(l+m)!}
\sqrt{   \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/1f9af454a59347c4f4d29988c03ac2946fc7a00d.png" alt="\bar{P}_l^{(-m)}(x)
=(-1)^{m}
\frac{(l-m)!}{(l+m)!}
\sqrt{   \frac{(l+m)!}{(l-m)!}
 \frac{(l+m)!}{(l-m)!} }
\bar{P}_l^{(m)}(x)"/></p>
</div><p>We get the nice and simple relation</p>
<div class="math">
<p><img src="../_images/math/c894fccf49682a6cb8e9c14979076069e512ffef.png" alt="\bar{P}_l^{(-m)}(x)
=(-1)^{m}
\bar{P}_l^{(m)}(x)"/></p>
</div></div>
</div>
<div class="section" id="practical-implementation">
<h2>Practical Implementation<a class="headerlink" href="#practical-implementation" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../_images/math/5627ddd0e8ef538d4f71fbe10cf1375212cff902.png" alt="\Re\{F\_{\theta}(\theta,\phi)\} =
\Re \{ \frac{1}{2} \sum\_{l=0}^{L}
(br_l^{(0)}\bar{V}_l^{(0)}- j cr_l^{(0)}\bar{W}_l^{(0)})
+ \sum\_{m=1}^{M}\sum\_{l=m}^{N}
  (br_l^{(m)} \bar{V}_l^{m}
-j cr_l^{(m)} \bar{W}_l^{m})
e^{jm\phi}\}"/></p>
</div><div class="math">
<p><img src="../_images/math/34ceaadca058cfd644114a27d3c54554a216f907.png" alt="\Im\{F\_{\theta}(\theta,\phi)\} = \Re \{ \frac{1}{2} \sum\_{l=0}^{L}
(bi_{0,n}\bar{V}_l^{0}- j ci_l^{(0)}\bar{W}_l^{(0)})
+ \sum\_{m=1}^{M}\sum\_{l=m}^{N}(bi_l^{(m)}\bar{V}_l^{m}
-j ci_l^{(m)}\bar{W}_l^{m})
e^{jm\phi}\}"/></p>
</div><div class="math">
<p><img src="../_images/math/184c407ebec5801cc4c926164d92e509bbcc9dc1.png" alt="\Re\{F\_{\phi}(\theta,\phi)\} = \Re \{ \frac{1}{2} \sum\_{l=0}^{N}
(j br_l^{(0)}\bar{W}_l^{(0)}+ cr_l^{(0)}  \bar{V}_l^{(0)})
+ \sum\_{m=1}^{M}\sum\_{l=0}^{N}(j br_l^{(m)} \bar{W}_l^{m}
+cr_l^{(m)}\bar{V}_l^{m})e^{jm\phi})\}"/></p>
</div><div class="math">
<p><img src="../_images/math/98737dc6287d4163d57f8fbe203454be219ee9a3.png" alt="\Im\{F\_{\phi}(\theta,\phi)\} = \Re \{ \frac{1}{2} \sum\_{l=0}^{N}
(j bi_l^{(0)}\bar{W}_l^{(0)} + ci_l^{(0)}\bar{V}_l^{(0)})
+ \sum\_{m=1}^{M}\sum\_{l=0}^{N}(j bi_l^{(m)}\bar{W}_l^{m}
+ ci_l^{(m)}\bar{V}_l^{m} )
e^{jm\phi}\}"/></p>
</div></div>
<div class="section" id="the-vector-spherical-harmonics-functions">
<h2>The Vector Spherical Harmonics Functions <img class="math" src="../_images/math/6ae81d119f7e1cec5bb84366cae5435ac8231234.png" alt="\bar{V}_l^{(m)}"/><a class="headerlink" href="#the-vector-spherical-harmonics-functions" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../_images/math/8e8a8371b6bafbc2232191954ed9245b7555aa1b.png" alt="\bar{V}_l^{(m)}(x)
= \frac{ (-1)^n } {  2\sqrt{l(l+1) } }
  \left(
  \sqrt{(l+m)(l-m+1)} \bar{P}_l^{(m-1)}(x)
-  \sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(x)
  \right)"/></p>
</div></div>
<div class="section" id="calculation-of">
<h2>Calculation of <img class="math" src="../_images/math/385effffb525dac878a4a3932e25759aa4e75fb2.png" alt="\bar{W}_l^{(m)}"/><a class="headerlink" href="#calculation-of" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../_images/math/beecf1a7d8a6ef3f6cbef8c57049d7594c2d2f96.png" alt="\bar{W}_l^{(m)}(x)=\frac{(-1)^{n} m}{\sqrt{1-x^2}\sqrt{l(l+1)}}\bar{P}_l^{(m)}(x)"/></p>
</div><div class="math">
<p><img src="../_images/math/9e6563f3a33485842555b8d717c48c9bf9986e4b.png" alt="\bar{W}_l^{(m)}(x)=(-1)^{n} \frac{m}{\sqrt{1-x^2}\sqrt{l(l+1)}}
\frac{\sqrt{1-x^2}}{2mx}
\left[
\sqrt{  (l-m) (l+m+1)}
\bar{P}_l^{(m+1)}(x)
+
 \sqrt{(l+m)(l-m+1)}
\bar{P}_l^{(m-1)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/e732cc9fab8ccecfafeb0a97f7c457e7f1064913.png" alt="\bar{W}_l^{(m)}(x)= \frac{(-1)^{n}}{2x\sqrt{l(l+1)}}
\left[
\sqrt{  (l-m) (l+m+1)}
\bar{P}_l^{(m+1)}(x)
+
 \sqrt{(l+m)(l-m+1)}
\bar{P}_l^{(m-1)}(x)
\right]"/></p>
</div><div class="math">
<p><img src="../_images/math/dae45ec093f9705dc77cffd6070f20780ec710b4.png" alt="\bar{W}_l^{(m)}(\theta)
= \frac{ (-1)^n } {  2 \cos \theta \sqrt{l(l+1) } }
  \left[
  \sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(\cos \theta) +
  \sqrt{(l+m)(l-m+1)} \bar{P}_l^{(m-1)}(\cos \theta)
  \right]"/></p>
</div><p>There is a singularity of <img class="math" src="../_images/math/e164f7bc75d1b5877b461f4d2127745e07d863b8.png" alt="\bar{W}_l^{(m)}(\theta)"/> in
<img class="math" src="../_images/math/f18c57dcca9690bcf64babd9d735de69c78bbd48.png" alt="\theta=\pi/2"/></p>
<div class="math">
<p><img src="../_images/math/dae45ec093f9705dc77cffd6070f20780ec710b4.png" alt="\bar{W}_l^{(m)}(\theta)
= \frac{ (-1)^n } {  2 \cos \theta \sqrt{l(l+1) } }
  \left[
  \sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(\cos \theta) +
  \sqrt{(l+m)(l-m+1)} \bar{P}_l^{(m-1)}(\cos \theta)
  \right]"/></p>
</div></div>
<div class="section" id="norm-of">
<h2>Norm of <img class="math" src="../_images/math/65d6c5b9946deb02e1a617fce51541ab8f9c5446.png" alt="V_l^{(m)}(x)"/><a class="headerlink" href="#norm-of" title="Permalink to this headline">¶</a></h2>
<p>Those basis functions are not unitary</p>
<div class="math">
<p><img src="../_images/math/800ac3dda4c52a9df0fe6890613bb9e3328730c1.png" alt="\int_{-1}^{1}
 \bar{V}_l^{2(m)}(x) dx =
\frac{1 } {  4 l(l+1)  }
 \int_{-1}^{1}
  \left(
  \sqrt{(l+m)(l-m+1)} \bar{P}_l^{(m-1)}(x)
- \sqrt{(l-m)(l+m+1)} \bar{P}_l^{(m+1)}(x)
  \right)^2
 dx"/></p>
</div><div class="math">
<p><img src="../_images/math/3f42a631cdd34402e8034c243255be6e7b041f5e.png" alt="\int_{-1}^{1}
 \bar{V}_l^{2(m)}(x) dx =
\frac{1 } {  4 l(l+1)  }
 \int_{-1}^{1}
 (
  (l+m)(l-m+1) \bar{P}_l^{2(m-1)}(x)
+ (l-m)(l+m+1) \bar{P}_l^{2(m+1)}(x)\\
- 2\sqrt{(l+m)(l-m+1)(l-m)(l+m+1)}
 \bar{P}_l^{(m-1)}(x)
 \bar{P}_l^{(m+1)}(x)
 )
 dx"/></p>
</div><div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils"> \int_{-1}^{1}
 \bar{V}\_l^{2(m)}(x) dx =
\frac{1 } {  4 l(l+1)  }
 \left( (l+m)(l-m+1)
+ (l-m)(l+m+1)\\
- 2\sqrt{(l+m)(l-m+1)(l-m)(l+m+1)}
\int_{-1}^{1}
\bar{P}\_l^{(m-1)}(x)
 \bar{P}\_l^{(m+1)}(x) dx
\right)</tt>)</p>
latex exited with error
[stdout]
This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009/Debian)
entering extended mode
(./math.tex
LaTeX2e &lt;2009/09/24&gt;
Babel &lt;v3.8l&gt; and hyphenation patterns for english, usenglishmax, dumylang, noh
yphenation, loaded.
(/usr/share/texmf-texlive/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/share/texmf-texlive/tex/latex/base/size12.clo))
(/usr/share/texmf-texlive/tex/latex/base/inputenc.sty
(/home/uguen/texmf/tex/latex/ucs/utf8x.def))
(/home/uguen/texmf/tex/latex/ucs/ucs.sty
(/home/uguen/texmf/tex/latex/ucs/data/uni-global.def))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsmath.sty
For additional information on amsmath, use the `?&#8217; option.
(/usr/share/texmf-texlive/tex/latex/amsmath/amstext.sty
(/usr/share/texmf-texlive/tex/latex/amsmath/amsgen.sty))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsbsy.sty)
(/usr/share/texmf-texlive/tex/latex/amsmath/amsopn.sty))
(/usr/share/texmf-texlive/tex/latex/amscls/amsthm.sty)
(/usr/share/texmf-texlive/tex/latex/amsfonts/amssymb.sty
(/usr/share/texmf-texlive/tex/latex/amsfonts/amsfonts.sty))
(/usr/share/texmf-texlive/tex/latex/tools/bm.sty)
No file math.aux.
(/home/uguen/texmf/tex/latex/ucs/ucsencs.def)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsa.fd)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsb.fd)
! Extra }, or forgotten \right.
&lt;template&gt; }
            $\endtemplate 
l.23 \end{gather}
                 
! Missing \right. inserted.
&lt;inserted text&gt; 
                \right .
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Extra \right.
&lt;argument&gt; ...) \bar {P}\_l^{(m+1)}(x) dx \right )
                                                  \end {split}\notag 
l.23 \end{gather}
                 
! Missing { inserted.
&lt;inserted text&gt; 
                {
l.23 \end{gather}
                 
! Extra }, or forgotten \right.
&lt;template&gt; }
            $\endtemplate 
l.23 \end{gather}
                 
! Missing \right. inserted.
&lt;inserted text&gt; 
                \right .
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Extra \right.
&lt;argument&gt; ...) \bar {P}\_l^{(m+1)}(x) dx \right )
                                                  \end {split}\notag 
l.23 \end{gather}
                 
! Missing { inserted.
&lt;inserted text&gt; 
                {
l.23 \end{gather}
                 
[1] (./math.aux) )
(see the transcript file for additional information)
Output written on math.dvi (1 page, 1052 bytes).
Transcript written on math.log.
</div>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt class="docutils"> \int_{-1}^{1}
 \bar{V}\_l^{2(m)}(x) dx =
\frac{1 } {  4 l(l+1)  }
 \left( (l^2-m^2+l+m)
+  (l^2-m^2+l-m)\\
- 2\sqrt{(l^2-m^2+l+m)(l^2-m^2+l-m)}
\int_{-1}^{1}
\bar{P}\_l^{(m-1)}(x)
 \bar{P}\_l^{(m+1)}(x) dx
\right )</tt>)</p>
latex exited with error
[stdout]
This is pdfTeX, Version 3.1415926-1.40.10 (TeX Live 2009/Debian)
entering extended mode
(./math.tex
LaTeX2e &lt;2009/09/24&gt;
Babel &lt;v3.8l&gt; and hyphenation patterns for english, usenglishmax, dumylang, noh
yphenation, loaded.
(/usr/share/texmf-texlive/tex/latex/base/article.cls
Document Class: article 2007/10/19 v1.4h Standard LaTeX document class
(/usr/share/texmf-texlive/tex/latex/base/size12.clo))
(/usr/share/texmf-texlive/tex/latex/base/inputenc.sty
(/home/uguen/texmf/tex/latex/ucs/utf8x.def))
(/home/uguen/texmf/tex/latex/ucs/ucs.sty
(/home/uguen/texmf/tex/latex/ucs/data/uni-global.def))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsmath.sty
For additional information on amsmath, use the `?&#8217; option.
(/usr/share/texmf-texlive/tex/latex/amsmath/amstext.sty
(/usr/share/texmf-texlive/tex/latex/amsmath/amsgen.sty))
(/usr/share/texmf-texlive/tex/latex/amsmath/amsbsy.sty)
(/usr/share/texmf-texlive/tex/latex/amsmath/amsopn.sty))
(/usr/share/texmf-texlive/tex/latex/amscls/amsthm.sty)
(/usr/share/texmf-texlive/tex/latex/amsfonts/amssymb.sty
(/usr/share/texmf-texlive/tex/latex/amsfonts/amsfonts.sty))
(/usr/share/texmf-texlive/tex/latex/tools/bm.sty) (./math.aux)
(/home/uguen/texmf/tex/latex/ucs/ucsencs.def)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsa.fd)
(/usr/share/texmf-texlive/tex/latex/amsfonts/umsb.fd)
! Extra }, or forgotten \right.
&lt;template&gt; }
            $\endtemplate 
l.23 \end{gather}
                 
! Missing \right. inserted.
&lt;inserted text&gt; 
                \right .
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Extra \right.
&lt;argument&gt; ...) \bar {P}\_l^{(m+1)}(x) dx \right )
                                                  \end {split}\notag 
l.23 \end{gather}
                 
! Missing { inserted.
&lt;inserted text&gt; 
                {
l.23 \end{gather}
                 
! Extra }, or forgotten \right.
&lt;template&gt; }
            $\endtemplate 
l.23 \end{gather}
                 
! Missing \right. inserted.
&lt;inserted text&gt; 
                \right .
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Missing } inserted.
&lt;inserted text&gt; 
                }
l.23 \end{gather}
                 
! Extra \right.
&lt;argument&gt; ...) \bar {P}\_l^{(m+1)}(x) dx \right )
                                                  \end {split}\notag 
l.23 \end{gather}
                 
! Missing { inserted.
&lt;inserted text&gt; 
                {
l.23 \end{gather}
                 
[1] (./math.aux) )
(see the transcript file for additional information)
Output written on math.dvi (1 page, 1144 bytes).
Transcript written on math.log.
</div>
<div class="math">
<p><img src="../_images/math/2ac858bdb64b145214f1acf1c82b3886cd8a4f4f.png" alt="\int_{-1}^{1}
 \bar{V}_l^{2(m)}(x) dx =
\frac{l^2-m^2+l } {  2 l(l+1)  }
 \left( 1
- \sqrt{1-\frac{m^2}{(l^2-m^2+l)^2}}
\int_{-1}^{1}
\bar{P}\_l^{(m-1)}(x)
 \bar{P}\_l^{(m+1)}(x) dx
 \right)"/></p>
</div></div>
<div class="section" id="id2">
<h2>Norm of <img class="math" src="../_images/math/76107a2211718e838456e6323bcbc535b070f494.png" alt="\bar{W}_l^{(m)}(x)"/><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="math">
<p><img src="../_images/math/4e64f331a32e9a19964076c0f62af73f27d51ed0.png" alt="\int_{-1}^{1}
 \bar{W}_l^{2(m)}(x) dx =
\frac{ l^2-m^2+l } { l(l+1) }
\left(
  1
- \sqrt{1-\frac{m^2}{(l^2-m^2+l)^2}}
  \int_{-1}^{1} \bar{P}_l^{(m-1)}(x)\bar{P}_l^{(m+1)}(x) dx
  \right)"/></p>
</div></div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../documentation.html">Documentation </a> |&nbsp;</li>
        <li><a href="../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, PyLayers developer team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>