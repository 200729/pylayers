
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The class Cone &mdash; Python 1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="top" title="Python 1 documentation" href="../../index.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body role="document">

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../../index.html">
            <img src="../../_static/pylayers.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../../download.html">Download</a></li>
            <li><a href="../TOC.html">User Guide</a></li>
            <li><a href="../../modules/pylayers.html">Reference</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script>
  (function() {
       var cx = '004820205189002234612:sa15qzuf2ca';
           var gcse = document.createElement('script');
               gcse.type = 'text/javascript';
                   gcse.async = true;
                       gcse.src = (document.location.protocol == 'https:' ?
                           'https:' : 'http:') +
                               '//cse.google.com/cse.js?cx=' + cx;
                                   var s =
                                   document.getElementsByTagName('script')[0];
                                       s.parentNode.insertBefore(gcse, s);
                                         })();
</script>
<gcse:search></gcse:search>
</div>
</div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	   <div class="rel rellarge">
	     
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="../../py-modindex.html" title="Python Module Index"
	    >Modules
	    <br>
	    <span class="smallrellink">
	    Python Module...
	    </span>
	    <span class="hiddenrellink">
	    Python Module Index
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
    </div>
    <p style="text-align: center; background-color: #BFFFFF">This documentation is

    for Python <strong>version 1</strong>
    &mdash; <a href="https://github.com/pylayers/pylayers/archive/master.zip">Other versions</a></p>
    
    <h3>Citing</h3>
    <p>If you use the software, please consider
    <a href="../../about.html#citing-pylayers">citing pylayers</a>.</p>
    <h3>This page</h3>
	<ul>
<li><a class="reference internal" href="#">The class Cone</a><ul>
<li><a class="reference internal" href="#is-a-point-belonging-to-a-cone-belong-point">Is a point belonging to a cone ? : belong_point()</a></li>
<li><a class="reference internal" href="#creating-a-cone-from-2-segments-from2segs">Creating a Cone from 2 segments <code class="docutils literal"><span class="pre">from2segs()</span></code></a></li>
<li><a class="reference internal" href="#conditional-graph">Conditional Graph</a><ul>
<li><a class="reference internal" href="#benchmark-normalizing-a-vector">Benchmark normalizing a vector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#debug">Debug</a></li>
<li><a class="reference internal" href="#geomutil-mirror">geomutil.mirror</a></li>
<li><a class="reference internal" href="#geometric-probability">Geometric probability</a></li>
</ul>
</li>
</ul>

    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-class-cone">
<h1>The class Cone<a class="headerlink" href="#the-class-cone" title="Permalink to this headline">¶</a></h1>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>from pylayers.util.cone import *
from pylayers.util.geomutil import *
from pylayers.util.plotutil import *
%matplotlib inline
</pre></div>
</div>
<p>The
<code class="docutils literal"><span class="pre">`Cone</span></code> &lt;<a class="reference external" href="http://pylayers.github.io/pylayers/modules/pylayers.util.cone.html">http://pylayers.github.io/pylayers/modules/pylayers.util.cone.html</a>&gt;`__
class implements several methods for handling planar cones.</p>
<p>A planar cone is defined as being composed of : + an apex
<img src="../../_images/mathmpl/math-a7f83b41e6.png" style="position: relative; bottom: -7px"/> + two vectors <img src="../../_images/mathmpl/math-7f74f2117c.png" style="position: relative; bottom: -6px"/> and <img src="../../_images/mathmpl/math-bc8d915143.png" style="position: relative; bottom: -6px"/>
not necessarily normalized.</p>
<p>Let create a cone.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">va</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">vb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">(</span><span class="n">va</span><span class="p">,</span><span class="n">vb</span><span class="p">,</span><span class="n">apex</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<p>From those parameters the Cone <code class="docutils literal"><span class="pre">__init__</span></code> constructs 2 unitary vectors
<img src="../../_images/mathmpl/math-45a9cb8a6a.png" style="position: relative; bottom: -3px"/> and <img src="../../_images/mathmpl/math-7e4d2cc386.png" style="position: relative; bottom: -3px"/> such that :</p>
<ul class="simple">
<li><img src="../../_images/mathmpl/math-8360c8b6ef.png" /></li>
</ul>
<p>This can be interpreted as applying an anticlockwise rotation from
<img src="../../_images/mathmpl/math-45a9cb8a6a.png" style="position: relative; bottom: -3px"/> to <img src="../../_images/mathmpl/math-7e4d2cc386.png" style="position: relative; bottom: -3px"/>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span> <span class="s2">&quot;Unitary vector u&quot;</span><span class="p">,</span><span class="n">C</span><span class="o">.</span><span class="n">u</span>
<span class="k">print</span> <span class="s2">&quot;Unitary vector v&quot;</span><span class="p">,</span><span class="n">C</span><span class="o">.</span><span class="n">v</span>
<span class="k">print</span> <span class="s2">&quot;dot(u,v)&quot;</span><span class="p">,</span><span class="n">C</span><span class="o">.</span><span class="n">dot</span>
<span class="k">print</span> <span class="s2">&quot;cross(u,v)&quot;</span><span class="p">,</span><span class="n">C</span><span class="o">.</span><span class="n">cross</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>Unitary vector u [ 0.89442719  0.4472136 ]
Unitary vector v [ 0.31622777  0.9486833 ]
dot(u,v) 0.707106781187
cross(u,v) 0.707106781187
</pre></div>
</div>
<div class="section" id="is-a-point-belonging-to-a-cone-belong-point">
<h2>Is a point belonging to a cone ? : belong_point()<a class="headerlink" href="#is-a-point-belonging-to-a-cone-belong-point" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6000</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">belong_point</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">b</span><span class="p">]</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">nb</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;belong_cone method&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis(&#39;off&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>&lt;matplotlib.text.Text at 0x2b8da2271f50&gt;
</pre></div>
</div>
<img alt="../../_images/Cone_13_1.png" src="../../_images/Cone_13_1.png" />
</div>
<div class="section" id="creating-a-cone-from-2-segments-from2segs">
<h2>Creating a Cone from 2 segments <code class="docutils literal"><span class="pre">from2segs()</span></code><a class="headerlink" href="#creating-a-cone-from-2-segments-from2segs" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">seg0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">seg1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">=</span><span class="n">Cone</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">from2segs</span><span class="p">(</span><span class="n">seg0</span><span class="p">,</span><span class="n">seg1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">apex</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">1.5</span><span class="p">,</span>  <span class="mf">2.</span> <span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">seg1</span><span class="o">-</span><span class="n">seg1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8d9fdfed90&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8d721e64d0&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_20_1.png" src="../../_images/Cone_20_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">=</span><span class="n">Cs</span><span class="o">.</span><span class="n">belong_point</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pta</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">phe</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">nb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="ow">not</span> <span class="n">x</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">b</span><span class="p">]</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">nb</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#displot(pta[:,bs],phe[:,bs],color=&#39;k&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis(&#39;off&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Cone_24_1.png" src="../../_images/Cone_24_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">seg1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">bi</span><span class="o">=</span><span class="n">Cs</span><span class="o">.</span><span class="n">belong_point2</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%timeit b=Cs.belong_point(p)
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>The slowest run took 6.43 times longer than the fastest. This could mean that an intermediate result is being cached.
10000 loops, best of 3: 106 µs per loop
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="c1">#nb = np.array(map(lambda x: not x,bo))</span>
<span class="n">pr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">bi</span><span class="p">]</span>
<span class="c1">#pb = p[:,bo2]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.r&#39;</span><span class="p">)</span>
<span class="c1">#ax.plot(pb[0,:],pb[1,:],&#39;.b&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis(&#39;off&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Cone_28_1.png" src="../../_images/Cone_28_1.png" />
<p>The adressed problem consists in determining whether a segment lies in
the cone or not. The condition is satisfied if not all segments
termination are outside the cone on the same side of the cone. This is
implemented in the method <code class="docutils literal"><span class="pre">Cone.outside</span></code></p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="o">=</span><span class="n">Cs</span><span class="o">.</span><span class="n">outside_point</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">b1</span><span class="p">]</span>
<span class="n">pb</span> <span class="o">=</span> <span class="n">p</span><span class="p">[:,</span><span class="n">b2</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pr</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pr</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.r&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pb</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">pb</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;.b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="c1">#plt.axis(&#39;off&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">15.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">15.0</span><span class="p">,</span> <span class="mf">20.0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/Cone_31_1.png" src="../../_images/Cone_31_1.png" />
<p>Un cone est un objet qui va servir construire les objets <code class="docutils literal"><span class="pre">Beams</span></code>. Un
<code class="docutils literal"><span class="pre">Beam</span></code> est un <code class="docutils literal"><span class="pre">Cone</span></code> qui englobe les segments d&#8217;une <code class="docutils literal"><span class="pre">Signature</span></code>.
Une signature et un point donne un <code class="docutils literal"><span class="pre">Beam</span></code>. A un <code class="docutils literal"><span class="pre">Beam</span></code> est associ un
<code class="docutils literal"><span class="pre">Cone</span></code> dont l&#8217;apex est une ancre virtuelle.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pta</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>
<span class="n">phe</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">,</span><span class="n">phe</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8da250c750&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8da2416790&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_34_1.png" src="../../_images/Cone_34_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cs</span><span class="o">.</span><span class="n">seg0</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">typ</span><span class="p">,</span> <span class="n">proba</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">belong_seg</span><span class="p">(</span><span class="n">pta</span><span class="p">,</span><span class="n">phe</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">Cs</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">bs1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bs2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bs3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bs4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bs5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">bs6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs1</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs2</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs3</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs3</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs4</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs4</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs5</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs5</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1">#displot(pta[:,bs6],phe[:,bs6],color=&#39;m&#39;)</span>
<span class="c1">#displot(pta[:,bs],phe[:,bs],color=&#39;blue&#39;)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8da31815d0&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8da313b050&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_37_1.png" src="../../_images/Cone_37_1.png" />
<p>There is different way to create a <code class="docutils literal"><span class="pre">Cone</span></code> either from 2 segments
<code class="docutils literal"><span class="pre">from2segs</span></code> or from one point and one segment <code class="docutils literal"><span class="pre">fromptseg</span></code>. This
second method is used when the field is going from a diffraction point
to a segment.</p>
</div>
<div class="section" id="conditional-graph">
<h2>Conditional Graph<a class="headerlink" href="#conditional-graph" title="Permalink to this headline">¶</a></h2>
<p><img src="../../_images/mathmpl/math-4c79050f98.png" style="position: relative; bottom: -6px"/> is a <code class="docutils literal"><span class="pre">conditional</span> <span class="pre">graph</span></code> meaning that the edge
indicates which is the list of authorized next edge for the output. A
ray being a sequence <img src="../../_images/mathmpl/math-5d7b3f6d20.png" style="position: relative; bottom: -6px"/> of nodes of <img src="../../_images/mathmpl/math-4c79050f98.png" style="position: relative; bottom: -6px"/>.
The cone angular sector represents the whole set and each intercepting
segment, is a part or this whole set. This can be interpreted as a
probability. This means that the research of rays could be done
stochastically in a very efficient manner. This is not fully implemented
yet.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cb</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cb</span><span class="o">.</span><span class="n">u</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cb</span><span class="o">.</span><span class="n">fromptseg</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span><span class="n">seg</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">typ</span><span class="p">,</span><span class="n">proba</span> <span class="o">=</span> <span class="n">Cb</span><span class="o">.</span><span class="n">belong_seg</span><span class="p">(</span><span class="n">pta</span><span class="p">,</span><span class="n">phe</span><span class="p">)</span>
<span class="n">bs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cb</span><span class="o">.</span><span class="n">seg1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">Cb</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bs</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bs</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8da2420d10&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8da313b210&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_47_1.png" src="../../_images/Cone_47_1.png" />
<div class="section" id="benchmark-normalizing-a-vector">
<h3>Benchmark normalizing a vector<a class="headerlink" href="#benchmark-normalizing-a-vector" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%timeit a/np.sqrt(np.dot(a,a))
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>The slowest run took 8.16 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 4.88 µs per loop
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%timeit a/sp.linalg.norm(a)
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>The slowest run took 6.72 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 9.65 µs per loop
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span>%timeit a/np.sqrt(np.sum(a*a,axis=0))
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>The slowest run took 4.93 times longer than the fastest. This could mean that an intermediate result is being cached.
100000 loops, best of 3: 9.54 µs per loop
</pre></div>
</div>
</div>
</div>
<div class="section" id="debug">
<h2>Debug<a class="headerlink" href="#debug" title="Permalink to this headline">¶</a></h2>
<p>This a case which where segments <code class="docutils literal"><span class="pre">seg0</span></code> and <code class="docutils literal"><span class="pre">seg1</span></code> are orthogonal</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">seg0</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">25.768</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.822</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">4.28</span> <span class="p">,</span>   <span class="mf">9.925</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-39-1063b62b8faf&gt; in &lt;module&gt;()
----&gt; 1 seg0 = array([[-25.768, -25.822],
      2        [  4.28 ,   9.925]])


NameError: name &#39;array&#39; is not defined
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">seg1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">26.848</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.805</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mf">5.415</span><span class="p">,</span>   <span class="mf">4.515</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-40-95e9502a4505&gt; in &lt;module&gt;()
----&gt; 1 seg1 = array([[-26.848, -26.805],
      2        [  5.415,   4.515]])


NameError: name &#39;array&#39; is not defined
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">cn</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">from2segs</span><span class="p">(</span><span class="n">seg0</span><span class="p">,</span><span class="n">seg1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pta</span> <span class="o">=</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">27.836</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.833</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.833</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.817</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.848</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.774</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.952</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">28.062</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">10.926</span><span class="p">,</span>  <span class="mf">10.686</span><span class="p">,</span>  <span class="mf">10.686</span><span class="p">,</span>   <span class="mf">8.956</span><span class="p">,</span>   <span class="mf">5.415</span><span class="p">,</span>   <span class="mf">4.506</span><span class="p">,</span>  <span class="mf">10.934</span><span class="p">,</span>    <span class="mf">8.954</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-43-b197e999ada8&gt; in &lt;module&gt;()
----&gt; 1 pta =array([[-27.836, -27.833, -27.833, -27.817, -26.848, -27.774, -26.952,
      2         -28.062],
      3        [ 10.926,  10.686,  10.686,   8.956,   5.415,   4.506,  10.934,    8.954]])


NameError: name &#39;array&#39; is not defined
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">phe</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">27.835</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.835</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.078</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.774</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.882</span><span class="p">,</span> <span class="o">-</span><span class="mf">26.805</span><span class="p">,</span> <span class="o">-</span><span class="mf">27.836</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">28.078</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">10.891</span><span class="p">,</span>  <span class="mf">10.891</span><span class="p">,</span>  <span class="mf">10.683</span><span class="p">,</span>   <span class="mf">4.506</span><span class="p">,</span>   <span class="mf">8.965</span><span class="p">,</span>   <span class="mf">4.515</span><span class="p">,</span>  <span class="mf">10.926</span><span class="p">,</span>
         <span class="mf">10.683</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-44-b4e3a2a92cdb&gt; in &lt;module&gt;()
----&gt; 1 phe = array([[-27.835, -27.835, -28.078, -27.774, -26.882, -26.805, -27.836,
      2         -28.078],
      3        [ 10.891,  10.891,  10.683,   4.506,   8.965,   4.515,  10.926,
      4          10.683]])


NameError: name &#39;array&#39; is not defined
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">typ</span><span class="p">,</span><span class="n">proba</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">belong_seg</span><span class="p">(</span><span class="n">pta</span><span class="p">,</span><span class="n">phe</span><span class="p">)</span>
<span class="n">bn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">proba</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.10498244</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.30597098</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.59967647</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.97801319</span><span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.07398923</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.63906749</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.01383698</span><span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.05744027</span><span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.76873907</span><span class="p">,</span>  <span class="mf">0.1480276</span> <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.59913756</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.70409614</span><span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.53280277</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.75685669</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.02961765</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.3281306</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.2693165</span> <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.36991486</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">1.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>
        <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">bn</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">bn</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8da3357450&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8da3489850&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_63_1.png" src="../../_images/Cone_63_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pta1</span><span class="o">=</span><span class="n">pta</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">phe1</span><span class="o">=</span><span class="n">phe</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">cn</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pta1</span><span class="p">,</span><span class="n">phe1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>(&lt;matplotlib.figure.Figure at 0x2b8da3587d10&gt;,
 &lt;matplotlib.axes._subplots.AxesSubplot at 0x2b8da3591bd0&gt;)
</pre></div>
</div>
<img alt="../../_images/Cone_65_1.png" src="../../_images/Cone_65_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">cn</span><span class="o">.</span><span class="n">belong_seg</span><span class="p">(</span><span class="n">pta1</span><span class="p">,</span><span class="n">phe1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="geomutil-mirror">
<h2>geomutil.mirror<a class="headerlink" href="#geomutil-mirror" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">pa</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pb</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">geu</span><span class="o">.</span><span class="n">mirror</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">pa</span><span class="p">,</span><span class="n">pb</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">M</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.95213575</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.92663038</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.41836739</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.86016358</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">1.68726104</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.11654995</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mf">0.34091807</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.31914793</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.18926891</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.86315627</span><span class="p">,</span>
         <span class="mf">0.83181209</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.46015444</span><span class="p">]])</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">figsize</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">displot</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span><span class="n">pb</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;or&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s1">&#39;ob&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-53-0829430ac458&gt; in &lt;module&gt;()
----&gt; 1 figsize(20,20)
      2 displot(pa,pb)
      3 plot(p[0,:],p[1,:],&#39;or&#39;,alpha=0.2)
      4 plot(M[0,:],M[1,:],&#39;ob&#39;,alpha=0.2)


NameError: name &#39;figsize&#39; is not defined
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">pa</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pb</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">geu</span><span class="o">.</span><span class="n">isaligned</span><span class="p">(</span><span class="n">pa</span><span class="p">,</span><span class="n">pb</span><span class="p">,</span><span class="n">pc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="bp">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="geometric-probability">
<h2>Geometric probability<a class="headerlink" href="#geometric-probability" title="Permalink to this headline">¶</a></h2>
<p>The idea is to add an information of the fraction of the angular sector
which is subtended by the intercepted segment.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">apex</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">]))</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="n">pta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">phe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">5.99</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pta</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">phe</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">typ</span><span class="p">,</span><span class="n">proba</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">belong_seg</span><span class="p">(</span><span class="n">pta</span><span class="p">,</span><span class="n">phe</span><span class="p">)</span>
<span class="n">u0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">u6</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">typ</span><span class="o">==</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">us</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="p">((</span><span class="n">proba</span><span class="o">&lt;</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">proba</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">))</span> <span class="p">)</span>  <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#col=[&#39;r&#39;,&#39;g&#39;,&#39;b&#39;,&#39;m&#39;]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">us</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">us</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<img alt="../../_images/Cone_77_0.png" src="../../_images/Cone_77_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="c1">#col=[&#39;r&#39;,&#39;g&#39;,&#39;b&#39;,&#39;m&#39;]</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u1</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">print</span> <span class="n">proba</span><span class="p">[</span><span class="n">u1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.]
</pre></div>
</div>
<img alt="../../_images/Cone_78_1.png" src="../../_images/Cone_78_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u2</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u2</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">print</span><span class="p">(</span><span class="n">proba</span><span class="p">[</span><span class="n">u2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[ 0.09765695  0.7471172   0.37631341  0.09134127  0.8107929   0.02740472
  0.01155886  0.43371337  0.57482972  0.81665712  0.09720132  0.96918426
  0.32940117  0.19930752  0.22127924  0.33946677  0.72901486  0.28132239
  0.24382297  0.09193293  0.83508063  0.55212659  0.0847907   0.25187003
  0.60830125  0.88909621  0.11755991  0.96715141  0.06429485]
</pre></div>
</div>
<img alt="../../_images/Cone_79_1.png" src="../../_images/Cone_79_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u3</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u3</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">print</span><span class="p">(</span><span class="n">proba</span><span class="p">[</span><span class="n">u3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[ 0.24390893  0.91534494  0.38011268  0.93977795  0.49295148  0.6531122
  0.77907516  0.09083322  0.81165485  0.03616402  0.29557555  0.86111473
  0.8210745   0.13908704  0.19076096  0.06951564  0.64362376  0.28828787
  0.66350535  0.57403557  0.79200419  0.68915284  0.97868987  0.36929148
  0.30572578  0.5364374   0.44502893  0.55027637  0.06697602  0.01464838
  0.63885564  0.2872956   0.75582834  0.58048507]
</pre></div>
</div>
<img alt="../../_images/Cone_80_1.png" src="../../_images/Cone_80_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u4</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u4</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="k">print</span><span class="p">(</span><span class="n">proba</span><span class="p">[</span><span class="n">u4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>[  7.56335012e-01   6.41774363e-01   7.40926394e-01   3.33228564e-02
   7.92943111e-03   2.72642928e-04   7.36840265e-01   9.33150163e-01
   9.83228643e-01   6.67982410e-01   6.65751859e-01   3.26300612e-01]
</pre></div>
</div>
<img alt="../../_images/Cone_81_1.png" src="../../_images/Cone_81_1.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u5</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u5</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<img alt="../../_images/Cone_82_0.png" src="../../_images/Cone_82_0.png" />
<div class="code python highlight-python"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">displot</span><span class="p">(</span><span class="n">pta</span><span class="p">[:,</span><span class="n">u6</span><span class="p">],</span><span class="n">phe</span><span class="p">[:,</span><span class="n">u6</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<img alt="../../_images/Cone_83_0.png" src="../../_images/Cone_83_0.png" />
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; 2015, PyLayers developer team.
      Last updated on avril 26, 2016.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.3.5. Design by <a href="http://desgrana.es">Desgrana</a>.
    <span style="padding-left: 5ex;">
    <a href="../../_sources/notebook/8-MISC/Cone.txt"
	    rel="nofollow">Show this page source</a>
    </span>
    </div>
     <div class="rel rellarge">
    
    <div class="buttonPrevious">
      <a href="../../py-modindex.html">
        Previous
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#AFFFFF');
           },
           function () {
               $(this).css('background-color', '#AFFFFF');
           }
       );
     </script>
  </body>
</html>