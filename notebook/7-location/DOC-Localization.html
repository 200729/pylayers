<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Example of TDOA &mdash; PyLayers</title>
    
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="PyLayers" href="../../index.html" /> 
  </head>
  <body>
<div style="color: black;background-color: white; font-size: 3.2em; text-align: left; padding: 15px 10px 10px 15px">
    PyLayers
<!--
<a href="../../index.html"><img src="../../_static/logo.png" height="200" border="0"
    alt="pylayers"/></a>
-->
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pylayers.location.algebraic.algebraic</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.util.geomutil</span> <span class="kn">import</span> <span class="n">dist</span>
</pre></div>
</div>
<div class="section" id="example-of-tdoa">
<h1>Example of TDOA<a class="headerlink" href="#example-of-tdoa" title="Permalink to this headline">Â¶</a></h1>
<p>First, it is necesary to define Anchor nodes and associated Reference
Anchor Nodes. This is important to be very specific about what exactly
the TDOA is. In the example the Blin node is draw randomly as well as
anchor nodes.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">AN_TDOA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="c">#AN_TDOA1=np.array([[0, 0, 1, 1],[0,1,1,0]])</span>
<span class="c">#AN_TDOAr1 = np.roll(AN_TDOA,1,axis=1)</span>
<span class="n">AN_TDOAr1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">AN_TDOAr2</span> <span class="o">=</span> <span class="n">AN_TDOA</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">][:,</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">BN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">],[</span><span class="mf">0.3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AN_TDOA</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span> <span class="mf">0.7954218</span> <span class="p">,</span>  <span class="mf">0.16876022</span><span class="p">,</span>  <span class="mf">0.65633484</span><span class="p">,</span>  <span class="mf">0.45043979</span><span class="p">,</span>  <span class="mf">0.49316679</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.2841033</span> <span class="p">,</span>  <span class="mf">0.2656847</span> <span class="p">,</span>  <span class="mf">0.27377311</span><span class="p">,</span>  <span class="mf">0.82897223</span><span class="p">,</span>  <span class="mf">0.53357009</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AN_TDOAr1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AN_TDOAr2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span> <span class="mf">0.49316679</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.53357009</span><span class="p">]])</span>
</pre></div>
</div>
<p>The figure below illustrates the situation, in red the anchor nodes, the
blue star is the blind node.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">plot</span><span class="p">(</span><span class="n">AN_TDOA</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">AN_TDOA</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s">&#39;or&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">AN_TDOAr2</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">AN_TDOAr2</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s">&#39;ok&#39;</span><span class="p">)</span>
<span class="n">plot</span><span class="p">(</span><span class="n">BN</span><span class="p">[</span><span class="mi">0</span><span class="p">,:],</span><span class="n">BN</span><span class="p">[</span><span class="mi">1</span><span class="p">,:],</span><span class="s">&#39;*b&#39;</span><span class="p">)</span>
<span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<img alt="./DOC-Localization_files/DOC-Localization_8_1.png" src="./DOC-Localization_files/DOC-Localization_8_1.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">AN_TDOA</span><span class="p">,</span><span class="n">BN</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dr1</span><span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">AN_TDOAr1</span><span class="p">,</span><span class="n">BN</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">dr2</span><span class="o">=</span> <span class="n">dist</span><span class="p">(</span><span class="n">AN_TDOAr2</span><span class="p">,</span><span class="n">BN</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tdoa1</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">dr1</span><span class="p">)</span><span class="o">/</span><span class="mf">0.3</span>
<span class="n">tdoa2</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">dr2</span><span class="p">)</span><span class="o">/</span><span class="mf">0.3</span>
<span class="n">tdoa0</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="o">-</span><span class="n">roll</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="mf">0.3</span>

<span class="k">print</span> <span class="n">cumsum</span><span class="p">(</span><span class="n">tdoa0</span><span class="p">)</span>
<span class="k">print</span> <span class="n">tdoa1</span>
<span class="k">print</span> <span class="n">tdoa2</span>
</pre></div>
</div>
<div class="highlight-python"><pre>[  7.35994442e-01  -1.09476736e+00   2.74174196e-01   7.01421509e-01
   2.22044605e-16]
[ 0.78359612 -1.04716568  0.32177588  0.74902319  0.04760168]
[ 0.73599444 -1.09476736  0.2741742   0.70142151  0.        ]</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">node</span><span class="o">=</span><span class="p">{}</span>
<span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">BN</span>
<span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RN_TDOA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">AN_TDOA</span>
<span class="n">nodes</span><span class="p">[</span><span class="s">&#39;RNr_TDOA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">AN_TDOAr2</span>
<span class="n">ldp</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TDOA&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">cumsum</span><span class="p">(</span><span class="n">tdoa0</span><span class="p">)</span>
<span class="n">ldp</span><span class="p">[</span><span class="s">&#39;TDOA_std&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">=</span><span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span><span class="n">ldp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><pre>Nodes :  {'RN_TDOA': array([[ 0.7954218 ,  0.16876022,  0.65633484,  0.45043979,  0.49316679],
       [ 0.2841033 ,  0.2656847 ,  0.27377311,  0.82897223,  0.53357009]]), 'BN': array([[ 0.2],
       [ 0.3]]), 'RNr_TDOA': array([[ 0.49316679],
       [ 0.53357009]])}
Location dependent parameters :  {'TDOA': array([  7.35994442e-01,  -1.09476736e+00,   2.74174196e-01,
         7.01421509e-01,   2.22044605e-16]), 'TDOA_std': array([ 1.,  1.,  1.,  1.,  1.])}</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span> <span class="o">=</span> <span class="n">algloc</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span><span class="n">ldp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">ls_locate</span><span class="p">(</span><span class="n">tdoa</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">toa</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">rss</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span> <span class="mf">0.19957344</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.2997624</span> <span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nodes</span><span class="p">[</span><span class="s">&#39;BN&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">array</span><span class="p">([[</span> <span class="mf">0.2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>
</pre></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="../../index.html">PyLayers Home </a> |&nbsp;</li>
        <li><a href="../index.html">Documentation </a> |&nbsp;</li>
        <li><a href="../../download.html">Download </a> |&nbsp; </li>
        <li><a href="https://github.com/pylayers/">Developer (Github)</a> </li>
 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, PyLayers developer team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_setDomainName', 'pylayers.github.io']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })(); 
</script> 
 
  </body>
</html>