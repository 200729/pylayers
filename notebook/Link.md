# Upgrading Dlink

```python
>>> from pylayers.simul.link import *
>>> from pylayers.util.pyutil import *
>>> import h5py
>>> from pylayers.simul.simultraj import *
>>> from pylayers.measures.cormoran import *
>>> C=CorSer(serie=6,day=11)
>>> S = Simul(C,verbose=False)
>>> %matplotlib inline
WARNING:traits.has_traits:DEPRECATED: traits.has_traits.wrapped_class, 'the 'implements' class advisor has been deprecated. Use the 'provides' class decorator.

load infrastructure node position: **** Processor coding : Intel-PC

load  Nicolas  body: **** Processor coding : Intel-PC

BS data frame index:  Align on mocap OK... time-offset applied OK

HKB data frame index: Align on mocap OK... time-offset applied OK

Create distance Dataframe... OK
```

```python
>>> S.N.links['ieee802154']
>>> link = {'ieee802154':[]}
>>> link['ieee802154'].append(S.N.links['ieee802154'][112])
```

```python
>>> link
{'ieee802154': [['HKB:1', 'HKB:8', 'B2I']]}
```

```python
>>> DL=S.get_link(typ=['R','C','H'],links=link,t=12.23)
```

```python
>>> DL
filename: Links_0_MOCAP-small2.ini.h5
Link Parameters :
------- --------
Layout : MOCAP-small2.ini

Node a   
------  
position : [ 0.01855185 -2.74993723  0.97916601]
Antenna : S2R2.sh3
Rotation matrice : 
 [[1 0 0]
 [0 1 0]
 [0 0 1]]

Node b   
------  
position : [-0.17615773 -0.03718217  1.17708252]
Antenna : S2R2.sh3
Rotation matrice : 
 [[ 0.92490492 -0.04566981 -0.35000982]
 [ 0.35101449  0.01618468  0.92549021]
 [-0.03660216 -0.99882547  0.03100006]]

Link evaluation information : 
----------------------------- 
distance :  2.727 m 
delay :  9.090 ns
fmin (fGHz) : 2.0
fmax (fGHz) : 11.0
fstep (fGHz) : 0.05
Nf : 181
```

```python
>>> DL.H
freq : 2.0 5.95 80
shape  : (126, 80)
tau (min, max) : 9.08975170951 268.035695162
dist :2.72692551285 80.4107085487
Friis factor -j c/(4 pi f) has been applied
```

```python
>>> plt.stem(DL.H.tk,DL.H.ak)
<Container object of 3 artists>
```

```python
>>> DL.eval(force=True)
(array([  2.75709281e-04,   1.46569805e-06,   1.06039081e-05,
          0.00000000e+00,   1.61625608e-05,   1.00849091e-06,
          8.11964334e-06,   0.00000000e+00,   1.18268650e-06,
          1.42376341e-05,   8.89552870e-07,   3.79925656e-05,
          2.76832233e-06,   1.11305264e-05,   1.11265646e-06,
          1.32787397e-06,   9.09928787e-06,   1.02712122e-06,
          6.32870923e-07,   0.00000000e+00,   0.00000000e+00,
          6.15275108e-07,   1.67275567e-06,   2.45975998e-06,
          8.94889714e-06,   4.73748262e-06,   1.95040101e-05,
          2.44893417e-06,   2.79411346e-05,   2.13862891e-06,
          5.78032257e-06,   1.31795353e-06,   8.36319390e-07,
          2.24837847e-05,   1.08776656e-06,   4.20046474e-07,
          9.50709961e-06,   4.84723260e-06,   7.12111624e-07,
          1.92644559e-06,   5.99451747e-40,   1.02509592e-38,
          3.59297676e-07,   2.10742959e-06,   2.13181243e-07,
          5.48328232e-07,   5.36099385e-40,   6.95803129e-08,
          3.54333788e-06,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   2.04686753e-06,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          9.28758887e-07,   1.60883124e-06,   4.88953126e-06,
          3.88815349e-06,   1.24830401e-05,   6.14154775e-07,
          2.57412818e-07,   1.00052209e-06,   1.02339644e-06,
          3.36129984e-07,   1.37715657e-22,   1.14903350e-22,
          9.16115065e-07,   5.15071918e-07,   2.88976419e-06,
          1.50117678e-06,   4.64316336e-07,   5.47872738e-07,
          2.41122649e-07,   4.78177302e-07,   9.19982495e-08,
          1.84900795e-07,   5.70274972e-08,   8.81735859e-43,
          3.31131941e-06,   0.00000000e+00,   2.21305426e-40,
          0.00000000e+00,   4.10293426e-08,   4.53448944e-07,
          4.11484121e-07,   4.18531927e-07,   3.48351138e-40,
          0.00000000e+00,   1.95432383e-06,   0.00000000e+00,
          0.00000000e+00,   2.54529625e-07,   4.28623879e-07,
          4.10266721e-07,   3.03628580e-06,   2.13367533e-07,
          1.80915927e-06,   7.78324587e-07,   1.11038703e-07,
          2.68898634e-07,   7.05343989e-08,   2.59122919e-07,
          9.07425908e-08,   1.89718383e-07,   9.45125245e-08,
          2.87799058e-08,   4.85833355e-08,   1.97751996e-07,
          0.00000000e+00,   1.49689166e-06,   1.49247626e-06,
          1.01423642e-39,   0.00000000e+00,   0.00000000e+00,
          1.22999257e-07,   8.98660233e-40,   0.00000000e+00,
          1.70198989e-07,   1.64154284e-07,   1.14862824e-06,
          2.18002366e-07,   2.17627453e-07,   3.73406168e-07]),
 array([   9.08975171,   66.92641241,   68.4682688 ,   75.30198632,
         131.21155187,   67.30801981,   68.84132977,   75.64135111,
          89.53480494,   90.69311137,   93.54699188,   95.95689533,
         100.52538316,  131.40660637,  133.84007761,  135.14069049,
         144.06181993,  145.91948445,  148.79952773,  197.47881729,
         215.52738144,   93.82038447,   93.99801184,   94.92919475,
          95.1019736 ,   96.02245138,  100.13426334,  100.77984676,
         101.00889308,  110.85294902,  116.80192326,  134.03130689,
         135.33008194,  137.2659995 ,  146.09490338,  146.45990233,
         146.87733963,  147.47501036,  147.64939161,  148.97155536,
         153.36329037,  154.18158314,  157.57484748,  160.2455493 ,
         187.40756586,  188.09409018,  197.60847181,  200.70844796,
         206.24068438,  207.93604143,  209.08483644,  209.08822969,
         215.64618476,  223.58306905,  225.13162322,  226.14438279,
         226.14863683,  114.4880834 ,  115.25383736,  120.25736656,
         120.98661082,  137.45246259,  149.23018436,  149.59709635,
         149.81846919,  150.3977652 ,  150.98150073,  153.53020448,
         154.34761233,  160.15298153,  160.70128587,  162.78139023,
         163.32087065,  164.49205285,  165.25524862,  187.54418305,
         188.23020909,  196.61874875,  197.27322013,  200.83601753,
         208.05917951,  208.21710984,  208.6391397 ,  209.20729835,
         209.21068961,  209.33518028,  216.27467245,  217.37940438,
         217.38266815,  225.24536095,  225.40748369,  225.79738592,
         226.25761141,  226.26186332,  232.85528637,  233.83459643,
         233.83871057,  259.44310849,  152.31032851,  152.88676187,
         166.96341032,  167.48942107,  167.71536045,  168.23902019,
         198.69090894,  199.13312904,  199.33857708,  199.77936355,
         211.28266052,  211.69857917,  218.16021378,  218.56304506,
         219.2554455 ,  219.25868135,  219.65626822,  219.65949816,
         234.60760714,  234.98224425,  235.57963286,  235.58371653,
         235.95272663,  235.95680384,  259.5418105 ,  266.1729948 ,
         267.70731797,  268.03569516]))
```

```python
>>> DL.H.Gap
array([-22.73088512+0.j, -24.68203213+0.j, -24.65404719+0.j,
       -23.73190099+0.j, -22.72059861+0.j, -24.46458389+0.j,
       -25.57748922+0.j, -23.46782851+0.j, -25.98236553+0.j,
       -24.26496771+0.j, -21.49322865+0.j, -21.94540706+0.j,
       -23.49493529+0.j, -22.91326140+0.j, -25.04383130+0.j,
       -25.47153335+0.j, -23.02032140+0.j, -22.51224248+0.j,
       -23.27789647+0.j, -22.73021383+0.j, -23.82358723+0.j,
       -22.43126455+0.j, -17.04192414+0.j, -25.59568211+0.j,
       -17.69258915+0.j, -24.28207330+0.j, -17.28378933+0.j,
       -23.50921859+0.j, -21.42248789+0.j, -22.81405337+0.j,
       -21.60207875+0.j, -25.61688606+0.j, -25.55069447+0.j,
       -23.77030916+0.j, -22.41509101+0.j, -24.63957691+0.j,
       -20.09957484+0.j, -23.85326012+0.j, -26.76027164+0.j,
       -23.59033537+0.j, -23.13614485+0.j, -22.16212061+0.j,
       -24.28811685+0.j, -22.53958117+0.j, -23.47067862+0.j,
       -23.63692239+0.j, -22.85985796+0.j, -25.74224334+0.j,
       -23.56527164+0.j, -22.39659046+0.j, -23.06087495+0.j,
       -23.04693569+0.j, -23.98221618+0.j, -23.55058387+0.j,
       -22.78691545+0.j, -24.19239173+0.j, -24.18994156+0.j,
       -17.22562415+0.j, -22.43120845+0.j, -15.40695663+0.j,
       -21.84011903+0.j, -23.88419690+0.j, -20.91275208+0.j,
       -23.02620552+0.j, -24.41190262+0.j, -21.06344602+0.j,
       -27.31213874+0.j, -23.87291956+0.j, -22.36855781+0.j,
       -22.91075310+0.j, -24.63666851+0.j, -20.27519667+0.j,
       -22.94668254+0.j, -21.51056657+0.j, -22.85775355+0.j,
       -23.39187104+0.j, -23.37106862+0.j, -22.53874525+0.j,
       -26.01572613+0.j, -25.86769343+0.j, -22.36630425+0.j,
       -22.83359915+0.j, -23.02147082+0.j, -23.30636058+0.j,
       -23.29132347+0.j, -26.21697112+0.j, -24.10504330+0.j,
       -23.82966633+0.j, -23.83976563+0.j, -23.18100811+0.j,
       -21.32203699+0.j, -23.35447536+0.j, -24.19081036+0.j,
       -24.18781473+0.j, -22.77055632+0.j, -22.58359545+0.j,
       -22.55261180+0.j, -22.73061589+0.j, -20.76527581+0.j,
       -23.07955624+0.j, -18.02596060+0.j, -21.35714704+0.j,
       -21.36812893+0.j, -23.64729095+0.j, -20.14095633+0.j,
       -21.97018003+0.j, -24.01853853+0.j, -26.10897199+0.j,
       -24.59564278+0.j, -26.00266982+0.j, -23.40974438+0.j,
       -23.85446774+0.j, -22.52742923+0.j, -22.55148672+0.j,
       -23.25915033+0.j, -23.27015142+0.j, -22.48819422+0.j,
       -22.38822132+0.j, -20.59879765+0.j, -20.58777539+0.j,
       -22.67862491+0.j, -22.64688249+0.j, -22.82751201+0.j,
       -24.25037958+0.j, -22.87144897+0.j, -24.07943463+0.j])
```

```python
>>> plt.stem(DL.H.tk,DL.H.ak)
<Container object of 3 artists>
```

```python
>>> DL
filename: Links_0_MOCAP-small2.ini.h5
Link Parameters :
------- --------
Layout : MOCAP-small2.ini

Node a   
------  
position : [ 0.01855185 -2.74993723  0.97916601]
Antenna : S2R2.sh3
Rotation matrice : 
 [[1 0 0]
 [0 1 0]
 [0 0 1]]

Node b   
------  
position : [-0.17615773 -0.03718217  1.17708252]
Antenna : S2R2.sh3
Rotation matrice : 
 [[ 0.92490492 -0.04566981 -0.35000982]
 [ 0.35101449  0.01618468  0.92549021]
 [-0.03660216 -0.99882547  0.03100006]]

Link evaluation information : 
----------------------------- 
distance :  2.727 m 
delay :  9.090 ns
fmin (fGHz) : 2.0
fmax (fGHz) : 11.0
fstep (fGHz) : 0.05
Nf : 181
```

```python
>>> DL.C.Tr
array([[ 0.92490492, -0.04566981, -0.35000982],
       [ 0.35101449,  0.01618468,  0.92549021],
       [-0.03660216, -0.99882547,  0.03100006]])
```

```python
>>> DL.H
freq : 2.0 5.95 80
shape  : (126, 80)
tau (min, max) : 9.08975170951 268.035695162
dist :2.72692551285 80.4107085487
Friis factor -j c/(4 pi f) has been applied
```

```python
>>> DL.H.sort()
```

```python
>>> DL.H.sort()
```

```python
>>> DL.C.sort()
```

```python
>>> DL.eval(force=['H'])
(array([  2.75709281e-04,   1.46569805e-06,   1.06039081e-05,
          0.00000000e+00,   1.61625608e-05,   1.00849091e-06,
          8.11964334e-06,   0.00000000e+00,   1.18268650e-06,
          1.42376341e-05,   8.89552870e-07,   3.79925656e-05,
          2.76832233e-06,   1.11305264e-05,   1.11265646e-06,
          1.32787397e-06,   9.09928787e-06,   1.02712122e-06,
          6.32870923e-07,   0.00000000e+00,   0.00000000e+00,
          6.15275108e-07,   1.67275567e-06,   2.45975998e-06,
          8.94889714e-06,   4.73748262e-06,   1.95040101e-05,
          2.44893417e-06,   2.79411346e-05,   2.13862891e-06,
          5.78032257e-06,   1.31795353e-06,   8.36319390e-07,
          2.24837847e-05,   1.08776656e-06,   4.20046474e-07,
          9.50709961e-06,   4.84723260e-06,   7.12111624e-07,
          1.92644559e-06,   5.99451747e-40,   1.02509592e-38,
          3.59297676e-07,   2.10742959e-06,   2.13181243e-07,
          5.48328232e-07,   5.36099385e-40,   6.95803129e-08,
          3.54333788e-06,   0.00000000e+00,   0.00000000e+00,
          0.00000000e+00,   0.00000000e+00,   2.04686753e-06,
          0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
          9.28758887e-07,   1.60883124e-06,   4.88953126e-06,
          3.88815349e-06,   1.24830401e-05,   6.14154775e-07,
          2.57412818e-07,   1.00052209e-06,   1.02339644e-06,
          3.36129984e-07,   1.37715657e-22,   1.14903350e-22,
          9.16115065e-07,   5.15071918e-07,   2.88976419e-06,
          1.50117678e-06,   4.64316336e-07,   5.47872738e-07,
          2.41122649e-07,   4.78177302e-07,   9.19982495e-08,
          1.84900795e-07,   5.70274972e-08,   8.81735859e-43,
          3.31131941e-06,   0.00000000e+00,   2.21305426e-40,
          0.00000000e+00,   4.10293426e-08,   4.53448944e-07,
          4.11484121e-07,   4.18531927e-07,   3.48351138e-40,
          0.00000000e+00,   1.95432383e-06,   0.00000000e+00,
          0.00000000e+00,   2.54529625e-07,   4.28623879e-07,
          4.10266721e-07,   3.03628580e-06,   2.13367533e-07,
          1.80915927e-06,   7.78324587e-07,   1.11038703e-07,
          2.68898634e-07,   7.05343989e-08,   2.59122919e-07,
          9.07425908e-08,   1.89718383e-07,   9.45125245e-08,
          2.87799058e-08,   4.85833355e-08,   1.97751996e-07,
          0.00000000e+00,   1.49689166e-06,   1.49247626e-06,
          1.01423642e-39,   0.00000000e+00,   0.00000000e+00,
          1.22999257e-07,   8.98660233e-40,   0.00000000e+00,
          1.70198989e-07,   1.64154284e-07,   1.14862824e-06,
          2.18002366e-07,   2.17627453e-07,   3.73406168e-07]),
 array([   9.08975171,   66.92641241,   68.4682688 ,   75.30198632,
         131.21155187,   67.30801981,   68.84132977,   75.64135111,
          89.53480494,   90.69311137,   93.54699188,   95.95689533,
         100.52538316,  131.40660637,  133.84007761,  135.14069049,
         144.06181993,  145.91948445,  148.79952773,  197.47881729,
         215.52738144,   93.82038447,   93.99801184,   94.92919475,
          95.1019736 ,   96.02245138,  100.13426334,  100.77984676,
         101.00889308,  110.85294902,  116.80192326,  134.03130689,
         135.33008194,  137.2659995 ,  146.09490338,  146.45990233,
         146.87733963,  147.47501036,  147.64939161,  148.97155536,
         153.36329037,  154.18158314,  157.57484748,  160.2455493 ,
         187.40756586,  188.09409018,  197.60847181,  200.70844796,
         206.24068438,  207.93604143,  209.08483644,  209.08822969,
         215.64618476,  223.58306905,  225.13162322,  226.14438279,
         226.14863683,  114.4880834 ,  115.25383736,  120.25736656,
         120.98661082,  137.45246259,  149.23018436,  149.59709635,
         149.81846919,  150.3977652 ,  150.98150073,  153.53020448,
         154.34761233,  160.15298153,  160.70128587,  162.78139023,
         163.32087065,  164.49205285,  165.25524862,  187.54418305,
         188.23020909,  196.61874875,  197.27322013,  200.83601753,
         208.05917951,  208.21710984,  208.6391397 ,  209.20729835,
         209.21068961,  209.33518028,  216.27467245,  217.37940438,
         217.38266815,  225.24536095,  225.40748369,  225.79738592,
         226.25761141,  226.26186332,  232.85528637,  233.83459643,
         233.83871057,  259.44310849,  152.31032851,  152.88676187,
         166.96341032,  167.48942107,  167.71536045,  168.23902019,
         198.69090894,  199.13312904,  199.33857708,  199.77936355,
         211.28266052,  211.69857917,  218.16021378,  218.56304506,
         219.2554455 ,  219.25868135,  219.65626822,  219.65949816,
         234.60760714,  234.98224425,  235.57963286,  235.58371653,
         235.95272663,  235.95680384,  259.5418105 ,  266.1729948 ,
         267.70731797,  268.03569516]))
```

```python
>>> DL.H.tk
array([   9.08975171,   66.92641241,   68.4682688 ,   75.30198632,
        131.21155187,   67.30801981,   68.84132977,   75.64135111,
         89.53480494,   90.69311137,   93.54699188,   95.95689533,
        100.52538316,  131.40660637,  133.84007761,  135.14069049,
        144.06181993,  145.91948445,  148.79952773,  197.47881729,
        215.52738144,   93.82038447,   93.99801184,   94.92919475,
         95.1019736 ,   96.02245138,  100.13426334,  100.77984676,
        101.00889308,  110.85294902,  116.80192326,  134.03130689,
        135.33008194,  137.2659995 ,  146.09490338,  146.45990233,
        146.87733963,  147.47501036,  147.64939161,  148.97155536,
        153.36329037,  154.18158314,  157.57484748,  160.2455493 ,
        187.40756586,  188.09409018,  197.60847181,  200.70844796,
        206.24068438,  207.93604143,  209.08483644,  209.08822969,
        215.64618476,  223.58306905,  225.13162322,  226.14438279,
        226.14863683,  114.4880834 ,  115.25383736,  120.25736656,
        120.98661082,  137.45246259,  149.23018436,  149.59709635,
        149.81846919,  150.3977652 ,  150.98150073,  153.53020448,
        154.34761233,  160.15298153,  160.70128587,  162.78139023,
        163.32087065,  164.49205285,  165.25524862,  187.54418305,
        188.23020909,  196.61874875,  197.27322013,  200.83601753,
        208.05917951,  208.21710984,  208.6391397 ,  209.20729835,
        209.21068961,  209.33518028,  216.27467245,  217.37940438,
        217.38266815,  225.24536095,  225.40748369,  225.79738592,
        226.25761141,  226.26186332,  232.85528637,  233.83459643,
        233.83871057,  259.44310849,  152.31032851,  152.88676187,
        166.96341032,  167.48942107,  167.71536045,  168.23902019,
        198.69090894,  199.13312904,  199.33857708,  199.77936355,
        211.28266052,  211.69857917,  218.16021378,  218.56304506,
        219.2554455 ,  219.25868135,  219.65626822,  219.65949816,
        234.60760714,  234.98224425,  235.57963286,  235.58371653,
        235.95272663,  235.95680384,  259.5418105 ,  266.1729948 ,
        267.70731797,  268.03569516])
```

```python
>>> DL
filename: Links_0_MOCAP-small2.ini.h5
Link Parameters :
------- --------
Layout : MOCAP-small2.ini

Node a   
------  
position : [ 0.01855185 -2.74993723  0.97916601]
Antenna : S2R2.sh3
Rotation matrice : 
 [[1 0 0]
 [0 1 0]
 [0 0 1]]

Node b   
------  
position : [-0.17615773 -0.03718217  1.17708252]
Antenna : S2R2.sh3
Rotation matrice : 
 [[ 0.92490492 -0.04566981 -0.35000982]
 [ 0.35101449  0.01618468  0.92549021]
 [-0.03660216 -0.99882547  0.03100006]]

Link evaluation information : 
----------------------------- 
distance :  2.727 m 
delay :  9.090 ns
fmin (fGHz) : 2.0
fmax (fGHz) : 11.0
fstep (fGHz) : 0.05
Nf : 181
```

```python
>>> DL
filename: Links_0_MOCAP-small2.ini.h5
Link Parameters :
------- --------
Layout : MOCAP-small2.ini

Node a   
------  
position : [ 0.01855185 -2.74993723  0.97916601]
Antenna : S2R2.sh3
Rotation matrice : 
 [[1 0 0]
 [0 1 0]
 [0 0 1]]

Node b   
------  
position : [-0.17615773 -0.03718217  1.17708252]
Antenna : S2R2.sh3
Rotation matrice : 
 [[ 0.92490492 -0.04566981 -0.35000982]
 [ 0.35101449  0.01618468  0.92549021]
 [-0.03660216 -0.99882547  0.03100006]]

Link evaluation information : 
----------------------------- 
distance :  2.727 m 
delay :  9.090 ns
fmin (fGHz) : 2.0
fmax (fGHz) : 11.0
fstep (fGHz) : 0.05
Nf : 181
```

```python
>>> from pylayers.antprop.channel import *
```

```python
>>> C=Ctilde()
```

```python
>>> C
Ctilde
---------
```

```python
>>> C.
```
