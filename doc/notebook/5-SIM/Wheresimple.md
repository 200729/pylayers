### WHERE1 UWB Measurement campaign M1

```python
>>> %matplotlib inline
>>> from pylayers.measures.mesuwb import *
>>> from pylayers.measures.mesuwb import *
>>> from pylayers.gis.layout import *
>>> 
>>> from pylayers.simul.link import *
>>> from pylayers.signal.waveform import *
WARNING:traits.has_traits:DEPRECATED: traits.has_traits.wrapped_class, 'the 'implements' class advisor has been deprecated. Use the 'provides' class decorator.
```

First of all, we load the Layout of the environment. If the Layout associated graphs have already been built, one can load them with the `dumpr()` method.

```python
>>> L=Layout('WHERE1.ini')
>>> L.dumpr()
```

```python
>>> try:
...     del td1
...     del td2
...     del td3
...     del td4
...     del te1
...     del te2
...     del te3
...     del te4
...     del tt1
...     del tt2
...     del tt3
...     del tt4
>>> except:
...     pass
```

The UWB measure from the WHERE1 project are handled in the class `UWBMeasure`

```python
>>> K=UWBMeasure(10)
```

The delays associated with the 4 links are obatained directly

```python
>>> K.de
array([ 46.19349565,  23.96692223,  71.6705632 ,  55.09300165])
```

As well as more information if needed.

```python
>>> K.info()
Date_Time : [u'31-Jul-2008 08:17:50']
Tx_height : [u'120cm']
Tx_position : [u'P010']
Tx :  [-25.3654  12.304    1.2   ]
------Tx1 ------
delays     (ns): 46.1934956511
range  (meters): 13.8580486953
visibility     : NLOS2
angular (degree)  : 2.80776139034
LQI Meth1 12.7383607831  (dB)
LQI Meth2 -1.2959656826  (dB)
------Tx2 ------
delays     (ns): 23.9669222261
range  (meters): 7.19007666782
visibility     : NLOS2
angular (degree)  : 3.55280136793
LQI Meth1 21.4526880977  (dB)
LQI Meth2 5.56578610451  (dB)
------Tx3 ------
delays     (ns): 71.6705632005
range  (meters): 21.5011689601
visibility     : NLOS2
angular (degree)  : 2.98073648115
LQI Meth1 11.5021659794  (dB)
LQI Meth2 4.23241262908  (dB)
------Tx4 ------
delays     (ns): 55.0930016539
range  (meters): 16.5279004962
visibility     : NLOS
angular (degree)  : 3.31710006758
LQI Meth1 28.2789637953  (dB)
LQI Meth2 4.89658815244  (dB)
```

```python
>>> ### Simulation section
... fig=plt.figure(figsize=(10,5))
>>> f,a = K.show(delay=K.de)
```

```python
>>> toa1 = K.toa_new()
>>> toa2 = K.toa_th(1e-1,1e-1)
```

```python
>>> toa1
array([ 47.51 ,  25.005,  74.725,  56.52 ])
```

```python
>>> K.tau_Emax()
array([[ 48.125],
       [ 28.025],
       [ 75.17 ],
       [ 57.405]])
```

```python
>>> np.vstack((K.rx))
array([[  0.    ,   0.    ,   1.2   ],
       [-12.2724,   7.7632,   1.2   ],
       [-18.7747,  15.178 ,   1.2   ],
       [ -4.1418,   8.8603,   1.2   ],
       [ -9.0914,  15.1899,   1.2   ]])
```

The code below reads data from the M1-WHERE2 measurement campaign.

```python
>>> for k in range(300):
...     try:
...         M  = UWBMeasure(k)
...         tx = M.tx
...         D  = M.rx-tx[np.newaxis,:]
...         D2 = D*D
...         dist = np.sqrt(np.sum(D2,axis=1))[1:]
...         Emax = M.Emax()
...         Etot = M.Etot()[0]
...         try:
...             td1 = np.hstack((td1,dist[0]))
...             td2 = np.hstack((td2,dist[1]))
...             td3 = np.hstack((td3,dist[2]))
...             td4 = np.hstack((td4,dist[3]))
>>> 
...             te1 = np.hstack((te1,Emax[0]))
...             te2 = np.hstack((te2,Emax[1]))
...             te3 = np.hstack((te3,Emax[2]))
...             te4 = np.hstack((te4,Emax[3]))
>>> 
...             tt1 = np.hstack((tt1,Etot[0]))
...             tt2 = np.hstack((tt2,Etot[1]))
...             tt3 = np.hstack((tt3,Etot[2]))
...             tt4 = np.hstack((tt4,Etot[3]))
...             #tdist = np.hstack((tdist,dist))
...             #te = np.hstack((te,Emax))
...         except:
...             td1=np.array(dist[0])
...             td2=np.array(dist[1])
...             td3=np.array(dist[2])
...             td4=np.array(dist[3])
...             te1 =np.array(Emax[0])
...             te2 =np.array(Emax[1])
...             te3 =np.array(Emax[2])
...             te4 =np.array(Emax[3])
...             tt1 =np.array(Etot[0])
...             tt2 =np.array(Etot[1])
...             tt3 =np.array(Etot[2])
...             tt4 =np.array(Etot[3])
...     except:
...         pass
```

The IR-UWB applied waweform is available in the raw data structure and can be extracted as follow. This exracttion is important in order to proceeed to the ray tracing simulation with the same waveform as the one used in the measurement campaign.

```python
>>> from pylayers.signal.bsignal import *
>>> s=M.RAW_DATA.tx[0]
>>> t=M.RAW_DATA.timetx[0]*1e9
>>> plt.plot(t,s)
>>> plt.xlabel('time (ns)')
>>> se=TUsignal(t,s)
```

```python
>>> te = t[1]-t[0]
>>> cs = np.cumsum(s*s)
>>> E = cs[-1]*te
>>> EdB = 10*np.log10(E*30)
>>> print EdB
>>> print E*30
>>> use =1/E
>>> print use
-10.2361907016
0.0947067492189
316.767286888
```

```python
>>> E2=se.Emax()
>>> print E2*30
>>> E2dB=10*np.log10(E2*30)
>>> print E2dB
0.0918920633424
-10.3672199673
```

```python
>>> se.plot(typ='v')
(<matplotlib.figure.Figure at 0x7f2c2269c210>,
 array([[<matplotlib.axes.AxesSubplot object at 0x7f2c215695d0>]], dtype=object))
```

```python
>>> td1
array([ 16.63802705,  16.22905158,  15.89686715,  15.26732076,
        15.42201416,  14.94989777,  14.78166126,  14.32910319,
        13.8580487 ,  13.39009378,  12.91841813,  12.44769576,
        12.27846378,  12.75884594,  13.23550693,  13.70142849,
        13.54291613,  13.05896727,  12.60297775,  12.11540199,
        11.96937715,  12.45704202,  12.93235531,  13.40780514,
        13.28520053,  12.79592003,  12.32508324,  12.22779408,
        12.70149509,  12.65309875,  12.145696  ,  11.64408114,
        11.73348438,  11.84737775,  11.35013274,  11.48499662,
        11.64842176,  11.18276087,  11.01347706,  10.87195268,
        10.38563262,  10.5338205 ,  10.71673568,  10.24994967,
        10.06163999,   9.91002968,   9.43039528,   9.58756834,
         9.782949  ,   9.32605947,   9.11637664,   8.95437626,
         8.48282527,   8.65957274,   8.86191108,   8.43762996,
         8.19890922,   8.03001201,   7.54285004,   7.74911708,
         7.96266398,   7.53499816,   7.29638897,   7.07732451,
         6.62123076,   6.85684233,   7.09947199,   6.68099249,
         6.42128625,   6.14889592,   5.72478837,   5.99892575,
         6.26734075,   5.86938915,   5.5740077 ,   5.2705324 ,
         4.84724195,   5.17401311,   5.48614278,   5.85294709,
         6.21375247,   6.57846333,   6.96926048,   8.66469589,
         9.10164736,   9.5441802 ,  10.00011931,  10.22893391,
        10.44978677,  10.66274567,  11.115319  ,  11.33981619,
        10.9056425 ,  11.16089704,  11.56784403,  11.80936487,
         5.28906287,   5.54799698,   5.9734221 ,   5.75313436,
         6.22113476,   6.43860912,   6.88650904,   6.68037347,
         6.49954391,   7.1456863 ,   7.3478422 ,   7.6175347 ,
         7.80093813,   8.50739073,   8.28268026,   4.43741569,
         4.79654883,   5.12885782,   4.78646063,   4.3861392 ,
         4.05584659,   3.68823229,   4.11082963,   4.01511245,
         3.5713588 ,   2.9244687 ,   3.36393718,   3.84392945,
         4.33348152,   4.82720377,   5.3202106 ,   4.73076284,
         4.22538864,   3.73128982,   3.22785818,   2.77548704,
         2.46021144,   2.6839712 ,   3.17544241,   3.68555356,
         4.19807301,   4.20703032,   3.70401587,   3.19453039,
         2.69525932,   2.81926615,   3.29637135,   3.78773907,
         4.28199186,   4.40809119,   3.93465372,   3.46779841,
         2.98455999,   3.70440599,   4.13931887,   4.58926358,
         4.89083016,   5.37383427,   5.0592459 ,   5.26866816,
         5.53806419,   5.72012401,   5.53617501,   4.78217776,
         4.33567869,   3.97467902,   3.57635672,   3.9332935 ,
         4.30812933,   4.68910278,   5.09636539,   5.39895459,
         5.02145051,   4.64612565,   4.33198972,   4.75163358,
         5.02416557,   5.38446311,   5.73265782,   6.11697015,
         5.74674355,   5.42395157,   5.17310049,   5.61125298,
         5.83992563,   6.13509025,   6.45356677,   6.79084918,
         6.54278157,   6.27900107,   6.06948836,   6.71180054,
         6.9571285 ,   7.40743691,   7.17684452,   7.6350584 ,
         7.84483777,   8.29796522,   8.10517577,   8.56738738,
         8.75305301,   9.21565071,   9.03716299,   9.5144246 ,
         9.68171345,  10.14760049,   9.99354333,  10.61437379,
        10.466769  ,  10.94857171,  11.08608088,  11.55921579,
        11.42969697,  11.91336755,  12.03542457,  10.67221083,
        10.59280221,  10.52425148,  11.03106793,  11.00296178,
        10.48954005,  10.46008797,  10.98842391,  11.00074418,
        10.47094729,  10.50232476,  11.05242161,  11.1036464 ,
        10.57384902,  10.6514114 ,  11.15021192,  12.8764748 ,
        13.35628445,  13.47389805])
```

```python
>>> fig = plt.figure(figsize=(16,6))
>>> ax = fig.add_subplot(111)
>>> ax.semilogx(td1,te1+EdB,'.r',label='Rx1')
>>> ax.semilogx(td2,te2+EdB,'.b',label='Rx2')
>>> ax.semilogx(td3,te3+EdB,'.g',label='Rx3')
>>> ax.semilogx(td4,te4+EdB,'.c',label='Rx4')
>>> d = np.linspace(1,30,100)
>>> 
>>> LFS = -(32.4+20*np.log10(4)+20*np.log10(d))-4
>>> ax.semilogx(d,LFS)
>>> plt.legend()
>>> plt.grid()
```

```python
>>> fig = plt.figure(figsize=(16,6))
>>> ax = fig.add_subplot(111)
>>> ax.semilogx(td1,tt1+EdB,'.r',label='Rx1')
>>> ax.semilogx(td2,tt2+EdB,'.b',label='Rx2')
>>> ax.semilogx(td3,tt3+EdB,'.g',label='Rx3')
>>> ax.semilogx(td4,tt4+EdB,'.c',label='Rx4')
>>> d = np.linspace(1,30,100)
>>> 
>>> LFS = -(32.4+20*np.log10(4)+20*np.log10(d))-4
>>> ax.semilogx(d,LFS)
>>> plt.legend()
>>> plt.grid()
```

```python
>>> M.Etot()
(array([-67.62048799, -64.56362576, -54.22863588, -66.40678426]),)
```

On choisit un index pour Tx et Rx

```python
>>> #measure id
... tx_id = 100 #in M.valid_index
>>> rx_id = 2 #1,2,3,4
>>> M=UWBMeasure(tx_id)
>>> TX = M.tx
>>> RX =M.rx[rx_id]
```

```python
>>> TX
array([-22.3797,  13.3897,   1.2   ])
```

```python
>>> M.rx
array([[  0.    ,   0.    ,   1.2   ],
       [-12.2724,   7.7632,   1.2   ],
       [-18.7747,  15.178 ,   1.2   ],
       [ -4.1418,   8.8603,   1.2   ],
       [ -9.0914,  15.1899,   1.2   ]])
```

```python
>>> L.showG('s',figsize=(8,4))
>>> plt.plot(TX[0],TX[1],'ob')
>>> plt.plot(RX[0],RX[1],'or')
>>> plt.title('TOF = '+ str(np.sqrt(np.sum((TX-RX)**2))/0.3))
```

```python
>>> TX
array([-22.3797,  13.3897,   1.2   ])
```

```python
>>> RX
array([-18.7747,  15.178 ,   1.2   ])
```

```python
>>> #Lk = DLink()
... Lk = DLink(L=L,a=TX,b=RX,cutoff=4,verbose=False)
>>> Lk.Aa=Antenna('defant.vsh3')
>>> Lk.Ab=Antenna('defant.vsh3')
```

```python
>>> Lk.eval(force=['ray','Ct','H'],alg=5)
>>> #f,a = Lk.show(rays=True,labels=False)
(array([  3.04906559e-02,   1.35949285e-02,   6.48460691e-03,
          8.72794414e-03,   5.15903804e-03,   6.64521755e-03,
          2.19815883e-03,   3.42409368e-03,   1.10455144e-02,
          4.98814152e-03,   2.92460994e-03,   5.34524756e-03,
          7.38279704e-03,   2.42827989e-04,   2.75670724e-03,
          2.19703142e-03,   4.43994157e-03,   8.25802975e-04,
          4.92996856e-03,   2.91806424e-03,   3.13353800e-04,
          1.91635959e-03,   1.26634432e-03,   2.15588222e-03,
          1.66703498e-03,   3.84877626e-03,   3.84786279e-03,
          2.01421652e-03,   1.23210421e-03,   1.88925328e-03,
          3.32766085e-05,   2.74469050e-04,   5.61564698e-04,
          5.31861891e-05,   1.98996897e-03,   2.76766077e-04,
          1.27293031e-03,   1.27514284e-03,   2.59704171e-03,
          2.44913042e-03,   1.04851736e-04,   1.79076237e-03,
          2.14874407e-03,   1.90052906e-04,   2.54295210e-03,
          3.11998420e-04,   5.23415501e-04,   2.82480147e-03,
          2.62049966e-04,   2.40150628e-03,   2.40187283e-03,
          2.50551734e-04,   1.12991855e-04,   5.61026787e-05,
          2.58174247e-04,   9.29619289e-05,   1.24274315e-03,
          2.83906680e-04,   1.77950782e-03,   1.87008703e-03,
          2.44750945e-04,   7.72701459e-04,   6.83196615e-06,
          3.86100956e-04,   7.68641198e-04,   9.46681663e-05,
          4.01129661e-04,   2.59502942e-04,   1.05691122e-04,
          7.34403849e-04,   6.40102986e-04,   7.17266245e-05,
          4.69797084e-04,   8.73689714e-04,   3.61393307e-04,
          3.42515935e-04,   4.02486837e-05,   4.68671617e-05,
          2.40744607e-04,   1.08758859e-03,   1.66523089e-04,
          2.42727652e-04,   1.16063472e-03,   4.14288671e-04,
          1.22140202e-04,   6.24620127e-04,   1.53099172e-04,
          2.10294830e-04,   1.42105775e-04,   8.89947094e-05,
          5.35399563e-05,   2.21197751e-04,   1.43245515e-03,
          1.43030535e-03,   6.97348771e-05,   6.11175442e-05,
          8.83191767e-05,   2.44037978e-05,   2.13480045e-04,
          2.98371913e-04,   3.05616376e-04,   1.19514896e-04,
          9.34570842e-05,   5.26910027e-04,   3.71515036e-05,
          3.32129559e-04,   7.23439432e-04,   2.50837402e-04,
          2.38957438e-04,   1.30605611e-04,   7.02010102e-05,
          1.63237510e-04,   1.31188895e-04,   1.16464951e-03,
          1.16457963e-03,   2.57320189e-04,   5.12159907e-05,
          5.67243764e-07,   1.52322789e-05,   1.91406875e-05,
          3.75599886e-04,   2.21082335e-04,   4.53757846e-04,
          4.25033856e-04,   2.89649992e-04,   3.41272378e-04,
          3.77290443e-06,   2.08183824e-06,   8.14090657e-07,
          4.62557210e-06,   8.93054333e-05,   1.18543673e-04,
          7.20127938e-05,   4.21263097e-05,   2.03371993e-04,
          1.79059537e-04,   7.21542152e-05,   2.43513525e-04,
          7.91162680e-04,   2.46870193e-04,   4.60325782e-05,
          5.02556430e-05,   5.28022849e-05,   2.25076858e-05,
          5.31777755e-04,   6.02434222e-04,   1.41769944e-06,
          1.19566108e-04,   7.94246760e-05,   2.07025060e-05,
          1.02930462e-04,   4.59712881e-04,   2.24189356e-05,
          3.48425590e-05,   9.46724748e-05,   7.70692818e-06,
          2.25855690e-04,   2.22002020e-04,   4.47985165e-04,
          1.91095259e-05,   4.14978921e-05,   3.75678480e-05,
          2.61072217e-04,   5.42299340e-05,   5.79126811e-05,
          2.70148625e-05,   5.23464692e-05,   6.76137364e-04,
          8.06302573e-04,   2.47589128e-05,   1.08149147e-04,
          9.70024024e-05,   2.82213417e-04,   2.21824608e-04,
          5.60002257e-05,   5.55950227e-05,   4.97655782e-05,
          3.05628756e-05,   1.36261613e-04,   6.01103153e-05,
          1.28311240e-04,   1.11686650e-04,   2.96390052e-07,
          1.28731878e-05,   9.51678291e-05,   9.17733905e-06,
          7.09288463e-06,   1.25473974e-06,   3.86581065e-05,
          3.87255673e-05,   2.65419182e-06,   4.93015918e-05,
          9.74534320e-07,   1.39570402e-05,   1.28108794e-05,
          1.89037246e-05,   4.34650903e-05,   1.90452053e-05,
          4.21514481e-06,   4.40859375e-06,   3.81736391e-06,
          3.55209766e-04,   1.65047937e-04,   2.71394978e-04,
          5.81510185e-04,   4.87909474e-04,   2.43795853e-04,
          2.88092656e-05,   2.55664297e-04,   1.37244723e-04,
          2.78377451e-04,   2.12303159e-04,   4.12447962e-06,
          1.00182765e-04,   1.59775664e-04,   1.59774092e-04,
          2.22480722e-04,   2.18681725e-04,   2.02714357e-04,
          2.24960632e-04,   1.64855884e-04,   1.64854919e-04,
          1.82362422e-06,   2.15150851e-05,   3.03805208e-06,
          3.03182391e-05,   6.60349671e-06,   2.38657011e-06,
          3.60634702e-05,   9.40289490e-05,   4.09454292e-05,
          5.13224600e-05,   2.13765424e-05,   4.61137414e-05,
          1.96140009e-06,   4.48789151e-06,   1.20212960e-04,
          3.66536965e-04,   3.14899590e-06,   2.33891705e-04,
          1.99994339e-06,   2.30533080e-04,   8.86420697e-06,
          2.46315867e-05,   2.88458185e-05,   1.88002019e-05,
          4.16571272e-05,   1.59256101e-04,   5.17812734e-06,
          2.91938847e-05,   1.55499627e-05,   9.60842513e-06,
          9.66305026e-05,   1.58501238e-05,   1.83597262e-05,
          1.18096917e-04,   2.64852961e-05,   2.32775674e-05,
          7.41405246e-06,   5.58928042e-05,   1.18903000e-04,
          1.12664100e-04,   5.43423717e-05,   5.26165271e-05,
          7.79592168e-06,   1.31760716e-04,   4.08522099e-04,
          7.16268645e-07,   1.79960820e-06,   1.20651493e-05,
          1.21810059e-05,   6.65839706e-06,   6.79216731e-06,
          3.23242209e-05,   7.40711851e-05,   8.30063896e-05,
          1.91012612e-05,   9.13123897e-05,   1.00139660e-06,
          3.39900378e-06,   1.42231373e-06,   1.62724809e-06,
          3.65838939e-05,   3.04666123e-05,   1.25297484e-05,
          6.60072169e-06,   4.28791625e-06,   3.61328368e-06,
          3.14390325e-06,   3.86930041e-06,   6.13377507e-06,
          1.96604658e-05,   3.56758055e-06,   3.22343007e-06,
          1.57054297e-04,   1.19770599e-04,   1.95170495e-04,
          2.79047549e-04,   2.06616589e-05,   1.37179027e-05,
          3.21098147e-04,   3.21097943e-04,   1.32430025e-04,
          1.32460574e-04,   3.53324061e-06,   9.72704535e-05,
          2.94584947e-06,   2.24376341e-04,   1.88741332e-04,
          7.51926769e-05,   4.67854226e-05,   4.66184885e-05,
          7.28247316e-05,   7.28787473e-05,   6.40476762e-05,
          1.29837775e-04,   1.35437870e-04,   1.00744638e-04,
          2.25443415e-04,   2.69215060e-04,   4.87228845e-05,
          4.85264818e-05,   9.94131327e-05,   9.91809613e-05,
          1.96937571e-06,   3.09722782e-06,   1.82361902e-06,
          4.23570048e-06,   3.69703591e-05,   3.84650203e-05,
          5.34686728e-05,   8.74429512e-06,   2.32979157e-06,
          1.69586763e-06,   1.63339126e-06,   1.77786886e-06,
          2.82199195e-05,   8.63562281e-05,   1.12711834e-05,
          1.34952556e-05,   1.91205220e-04,   7.79788593e-05,
          8.14405229e-06,   2.99811016e-05,   6.68947439e-05,
          3.07963760e-05,   4.52634619e-05,   1.14372351e-05,
          1.88633203e-04,   1.17349531e-04,   8.46627511e-07,
          2.73548202e-06,   3.59338154e-06,   3.81429256e-06,
          1.01370916e-04,   2.26250465e-06,   2.15212008e-06,
          1.59617123e-04,   5.51160116e-05,   2.34473308e-05,
          9.69881936e-07,   2.32802974e-06,   3.31611493e-05,
          3.31359782e-05,   1.94621791e-05,   2.25644707e-06,
          7.33144951e-06,   7.35077683e-06,   2.24779319e-06,
          7.56060359e-07,   2.91838360e-06,   1.25671269e-04,
          3.62460908e-05,   4.15457976e-06,   1.93203506e-06,
          1.07139443e-04,   4.53909522e-05,   4.66147683e-06,
          1.11416939e-06,   2.07523063e-05,   8.03091034e-05,
          4.91204323e-05,   1.04586637e-04,   1.05109008e-04,
          8.71538669e-05,   1.04410043e-04,   1.73315120e-04,
          1.44991650e-04,   6.85461190e-05,   1.60390402e-04,
          1.14678256e-04,   1.14886488e-04,   1.14842474e-04,
          1.15070700e-04,   2.61548683e-04,   6.23813738e-05,
          9.33497473e-05,   2.24974566e-05,   4.65761906e-05,
          4.83150769e-05,   8.98210902e-05,   7.71000598e-05,
          1.74024766e-05,   9.75465719e-06,   6.60835229e-05,
          7.65330997e-05]),
 array([  13.41394046,   15.32668193,   17.28244898,   21.30894336,
          43.00088848,   17.28893227,   18.8059076 ,   19.04423909,
          19.46553824,   21.04003428,   22.56162839,   22.76117455,
          24.45549155,   25.38181522,   26.93572493,   37.75571867,
          43.73872895,   44.35880019,   44.64388435,   45.07722557,
          46.0793409 ,   69.09122106,   20.4367845 ,   22.30834285,
          23.93798395,   25.19736453,   25.19736453,   25.55439444,
          26.43261324,   26.43261324,   26.61271395,   27.8027092 ,
          27.93716783,   28.07555064,   28.09863479,   28.74527684,
          29.2244943 ,   29.2244943 ,   29.48784965,   29.91796403,
          38.47723012,   38.59396705,   39.61684354,   45.07441796,
          45.78161493,   45.95327142,   46.37435446,   46.64714638,
          46.76863968,   47.42442841,   47.42442841,   47.61623313,
          48.02257943,   48.09599831,   48.62359187,   48.93487963,
          50.57306244,   55.6288624 ,   69.5528348 ,   70.12557899,
          71.04787819,   96.12220937,   25.97668091,   27.45290806,
          27.45290806,   28.9307905 ,   29.06003004,   29.83774356,
          29.9414269 ,   30.15007588,   30.15007588,   30.28185329,
          30.40535062,   30.96909059,   31.14949343,   32.23483476,
          32.31464906,   32.31464906,   33.54896835,   33.54896835,
          39.30009209,   40.30505226,   42.72580359,   42.72580359,
          47.05933224,   47.15857717,   47.90178234,   48.65905008,
          48.65905008,   48.6843726 ,   48.75679495,   49.27731412,
          49.3148686 ,   49.3148686 ,   49.49917307,   49.57040502,
          49.58449802,   49.96093654,   50.08246886,   50.23251594,
          50.23251594,   50.30031643,   50.38474416,   50.63640199,
          50.76881905,   51.20190079,   51.97725122,   56.20115953,
          56.90843814,   57.24937054,   58.80300516,   63.79284658,
          71.49686003,   71.92771947,   71.92771947,   72.00464915,
          72.05415321,   72.93378444,   76.78735385,   77.58031207,
          80.97413944,   96.4545444 ,   96.86835982,   98.21329079,
         105.07108987,  122.32589205,   27.18065399,   27.83625084,
          28.32003175,   28.61447101,   30.99175769,   32.25661242,
          34.24895092,   34.24895092,   34.35819183,   34.35819183,
          35.01843715,   35.01843715,   35.98728347,   35.98728347,
          37.3535964 ,   43.36470037,   43.36470037,   46.06104502,
          47.83232589,   48.66139538,   48.93487963,   50.50327466,
          50.50327466,   50.59738313,   50.93252235,   51.26446339,
          51.38185652,   51.39526231,   51.7119119 ,   51.73351317,
          52.02084327,   52.02084327,   52.03888168,   52.08862691,
          52.08862691,   52.16773895,   52.41125108,   52.57617033,
          52.57617033,   52.86418868,   52.86418868,   54.38413964,
          54.38413964,   57.73078387,   57.80562626,   58.49350756,
          58.55656726,   59.11489095,   59.11489095,   59.34469998,
          60.01494327,   60.33853914,   62.39338624,   63.94479941,
          64.29251336,   64.91168828,   71.43639743,   72.20676519,
          72.44770183,   72.99773626,   73.35674899,   73.37122674,
          73.80922026,   73.80922026,   73.91438908,   74.08520055,
          74.91320462,   77.20296439,   77.71935223,   77.99169713,
          78.30049254,   78.5028969 ,   79.0721355 ,   79.0721355 ,
          79.88975898,   81.36836767,   81.7028972 ,   81.85848311,
          98.18084913,   98.18084913,   98.53857361,   98.91912432,
          98.94367331,  104.01500734,  105.37520547,  105.75412014,
         106.2239839 ,  106.3693353 ,  107.16277357,  107.16435484,
         117.74745617,  122.58720923,  122.81008214,  122.91307443,
         152.82612519,  152.82636823,   28.96302576,   29.42828909,
          30.31265183,   30.75750638,   32.78395875,   32.78395875,
          36.00679165,   36.00679165,   38.20066968,   39.2338013 ,
          46.75061356,   47.59852801,   49.58449802,   50.38474416,
          51.2243243 ,   51.2243243 ,   52.3484134 ,   53.01829156,
          53.10702764,   53.76745521,   53.81538051,   53.81538051,
          54.13059978,   54.13059978,   54.44304553,   54.44304553,
          54.5662257 ,   54.5662257 ,   58.28244509,   58.9647641 ,
          59.10052089,   59.77350223,   60.64231548,   60.64231548,
          60.86656969,   61.52023493,   62.11113762,   62.11113762,
          62.90417034,   63.53687627,   64.44328802,   65.06102805,
          66.85452322,   66.85452322,   67.4518169 ,   71.88295262,
          72.43727547,   72.64858525,   73.19711018,   73.79168396,
          74.33177397,   74.51588381,   74.73064632,   74.73064632,
          75.05076242,   75.13664376,   75.33915467,   75.62629776,
          75.62629776,   75.86822936,   78.70811351,   79.21469013,
          79.34921368,   79.34921368,   79.47579891,   79.47579891,
          79.97751317,   79.97751317,   80.11681984,   80.11681984,
          80.28931181,   80.78597397,   82.09362589,   82.57943697,
          83.40750121,   83.40750121,   99.24209367,   99.64433329,
         100.22899026,  100.22899026,  104.32220162,  104.70492706,
         106.52480817,  106.66974965,  106.89964806,  106.95762678,
         106.95762678,  107.044082  ,  107.46096984,  107.46254673,
         107.83255556,  107.83412702,  118.01891134,  118.3573548 ,
         123.07037123,  123.39496049,  123.95008619,  123.95008619,
         153.03537023,  153.03561294,  153.29652488,  153.29676718,
          34.27618504,   34.27618504,   34.67022063,   34.67022063,
          42.37087637,   42.37087637,   50.21573327,   50.21573327,
          52.86418868,   52.86418868,   55.4649113 ,   55.4649113 ,
          56.09758676,   56.09758676,   61.09699997,   61.09699997,
          61.87787625,   61.87787625,   63.56680978,   63.56680978,
          65.52049028,   65.52049028,   66.99953262,   66.99953262,
          67.92457289,   68.51093053,   74.18327896,   74.18327896,
          74.92540917,   74.92540917,   75.56133426,   76.03428583,
          76.03428583,   76.08886407,   76.7373243 ,   76.7373243 ,
          77.53701198,   77.53701198,   80.81439929,   80.81439929,
          80.95243505,   81.56226218,   81.56226218,   81.56226218,
          81.56226218,   82.35516736,   82.35516736,   84.11517943,
          84.11517943,  100.92072709,  100.92072709,  105.9203557 ,
         105.9203557 ,  108.09040085,  108.09040085,  108.23324578,
         108.23324578,  108.41707667,  109.01311865,  109.01311865,
         109.01467309,  109.01467309,  119.43392916,  119.43392916,
         124.42795616,  124.42795616,  154.12924622,  154.12924622,
         154.12948721,  154.12948721,   70.35444267,   70.35444267,
          77.75291143,   77.75291143,   81.34676847,   81.83701327,
         108.71183245,  109.0791571 ,   83.38643019,   83.38643019,
         110.24637188,  110.24637188]))
```

```python
>>> #%timeit Lk.eval(force=True,alg=7,cutoff=3)
... #f,a = Lk.show(rays=True,labels=False)
```

```python
>>> Lk.R
Rays3D
----------
0 / 1 : [0]
1 / 4 : [1 2 3 4]
2 / 17 : [ 5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21]
3 / 40 : [22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46
 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61]
4 / 64 : [ 62  63  64  65  66  67  68  69  70  71  72  73  74  75  76  77  78  79
  80  81  82  83  84  85  86  87  88  89  90  91  92  93  94  95  96  97
  98  99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115
 116 117 118 119 120 121 122 123 124 125]
5 / 96 : [126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143
 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161
 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179
 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197
 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215
 216 217 218 219 220 221]
6 / 102 : [222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239
 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257
 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275
 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293
 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311
 312 313 314 315 316 317 318 319 320 321 322 323]
7 / 70 : [324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341
 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359
 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377
 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393]
8 / 8 : [394 395 396 397 398 399 400 401]
9 / 4 : [402 403 404 405]
-----
ni : 2096
nl : 4598
```

```python
>>> #%timeit Lk.eval(force=True,alg=7,threshold=0.01)
... #f,a = Lk.show(rays=True,labels=False)
```

```python
>>> Lk.Si.keys()
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]
```

```python
>>> U=Lk.R[4]['sig2d'][0]
```

```python
>>> print U.shape
(2, 2, 9)
```

```python
>>> s1 = U[:,:,0]
>>> print s1
[[ 30 335]
 [  2   2]]
```

```python
>>> from pylayers.antprop.signature import Signature
```

```python
>>> S=Signature(s1)
```

```python
>>> S
[ 30 335]
[2 2]
```

```python
>>> wav = Waveform(typ='W1compensate')
```

```python
>>> wav.show()
```

```python
>>> #ir = Lk.H.applywavB(wav.sfg)
```

```python
>>> Lk.H.isFriis
True
```

```python
>>> if Lk.H.isFriis:
...     ir = Lk.H.applywavB(wav.sf)
>>> else:
...     ir = Lk.H.applywavB(wav.sfg)
```

```python
>>> Lk.R.los
True
```

```python
>>> Lk.H.ak
array([  3.04906559e-02,   1.35949285e-02,   6.48460691e-03,
         8.72794414e-03,   5.15903804e-03,   6.64521755e-03,
         2.19815883e-03,   3.42409368e-03,   1.10455144e-02,
         4.98814152e-03,   2.92460994e-03,   5.34524756e-03,
         7.38279704e-03,   2.42827989e-04,   2.75670724e-03,
         2.19703142e-03,   4.43994157e-03,   8.25802975e-04,
         4.92996856e-03,   2.91806424e-03,   3.13353800e-04,
         1.91635959e-03,   1.26634432e-03,   2.15588222e-03,
         1.66703498e-03,   3.84877626e-03,   3.84786279e-03,
         2.01421652e-03,   1.23210421e-03,   1.88925328e-03,
         3.32766085e-05,   2.74469050e-04,   5.61564698e-04,
         5.31861891e-05,   1.98996897e-03,   2.76766077e-04,
         1.27293031e-03,   1.27514284e-03,   2.59704171e-03,
         2.44913042e-03,   1.04851736e-04,   1.79076237e-03,
         2.14874407e-03,   1.90052906e-04,   2.54295210e-03,
         3.11998420e-04,   5.23415501e-04,   2.82480147e-03,
         2.62049966e-04,   2.40150628e-03,   2.40187283e-03,
         2.50551734e-04,   1.12991855e-04,   5.61026787e-05,
         2.58174247e-04,   9.29619289e-05,   1.24274315e-03,
         2.83906680e-04,   1.77950782e-03,   1.87008703e-03,
         2.44750945e-04,   7.72701459e-04,   6.83196615e-06,
         3.86100956e-04,   7.68641198e-04,   9.46681663e-05,
         4.01129661e-04,   2.59502942e-04,   1.05691122e-04,
         7.34403849e-04,   6.40102986e-04,   7.17266245e-05,
         4.69797084e-04,   8.73689714e-04,   3.61393307e-04,
         3.42515935e-04,   4.02486837e-05,   4.68671617e-05,
         2.40744607e-04,   1.08758859e-03,   1.66523089e-04,
         2.42727652e-04,   1.16063472e-03,   4.14288671e-04,
         1.22140202e-04,   6.24620127e-04,   1.53099172e-04,
         2.10294830e-04,   1.42105775e-04,   8.89947094e-05,
         5.35399563e-05,   2.21197751e-04,   1.43245515e-03,
         1.43030535e-03,   6.97348771e-05,   6.11175442e-05,
         8.83191767e-05,   2.44037978e-05,   2.13480045e-04,
         2.98371913e-04,   3.05616376e-04,   1.19514896e-04,
         9.34570842e-05,   5.26910027e-04,   3.71515036e-05,
         3.32129559e-04,   7.23439432e-04,   2.50837402e-04,
         2.38957438e-04,   1.30605611e-04,   7.02010102e-05,
         1.63237510e-04,   1.31188895e-04,   1.16464951e-03,
         1.16457963e-03,   2.57320189e-04,   5.12159907e-05,
         5.67243764e-07,   1.52322789e-05,   1.91406875e-05,
         3.75599886e-04,   2.21082335e-04,   4.53757846e-04,
         4.25033856e-04,   2.89649992e-04,   3.41272378e-04,
         3.77290443e-06,   2.08183824e-06,   8.14090657e-07,
         4.62557210e-06,   8.93054333e-05,   1.18543673e-04,
         7.20127938e-05,   4.21263097e-05,   2.03371993e-04,
         1.79059537e-04,   7.21542152e-05,   2.43513525e-04,
         7.91162680e-04,   2.46870193e-04,   4.60325782e-05,
         5.02556430e-05,   5.28022849e-05,   2.25076858e-05,
         5.31777755e-04,   6.02434222e-04,   1.41769944e-06,
         1.19566108e-04,   7.94246760e-05,   2.07025060e-05,
         1.02930462e-04,   4.59712881e-04,   2.24189356e-05,
         3.48425590e-05,   9.46724748e-05,   7.70692818e-06,
         2.25855690e-04,   2.22002020e-04,   4.47985165e-04,
         1.91095259e-05,   4.14978921e-05,   3.75678480e-05,
         2.61072217e-04,   5.42299340e-05,   5.79126811e-05,
         2.70148625e-05,   5.23464692e-05,   6.76137364e-04,
         8.06302573e-04,   2.47589128e-05,   1.08149147e-04,
         9.70024024e-05,   2.82213417e-04,   2.21824608e-04,
         5.60002257e-05,   5.55950227e-05,   4.97655782e-05,
         3.05628756e-05,   1.36261613e-04,   6.01103153e-05,
         1.28311240e-04,   1.11686650e-04,   2.96390052e-07,
         1.28731878e-05,   9.51678291e-05,   9.17733905e-06,
         7.09288463e-06,   1.25473974e-06,   3.86581065e-05,
         3.87255673e-05,   2.65419182e-06,   4.93015918e-05,
         9.74534320e-07,   1.39570402e-05,   1.28108794e-05,
         1.89037246e-05,   4.34650903e-05,   1.90452053e-05,
         4.21514481e-06,   4.40859375e-06,   3.81736391e-06,
         3.55209766e-04,   1.65047937e-04,   2.71394978e-04,
         5.81510185e-04,   4.87909474e-04,   2.43795853e-04,
         2.88092656e-05,   2.55664297e-04,   1.37244723e-04,
         2.78377451e-04,   2.12303159e-04,   4.12447962e-06,
         1.00182765e-04,   1.59775664e-04,   1.59774092e-04,
         2.22480722e-04,   2.18681725e-04,   2.02714357e-04,
         2.24960632e-04,   1.64855884e-04,   1.64854919e-04,
         1.82362422e-06,   2.15150851e-05,   3.03805208e-06,
         3.03182391e-05,   6.60349671e-06,   2.38657011e-06,
         3.60634702e-05,   9.40289490e-05,   4.09454292e-05,
         5.13224600e-05,   2.13765424e-05,   4.61137414e-05,
         1.96140009e-06,   4.48789151e-06,   1.20212960e-04,
         3.66536965e-04,   3.14899590e-06,   2.33891705e-04,
         1.99994339e-06,   2.30533080e-04,   8.86420697e-06,
         2.46315867e-05,   2.88458185e-05,   1.88002019e-05,
         4.16571272e-05,   1.59256101e-04,   5.17812734e-06,
         2.91938847e-05,   1.55499627e-05,   9.60842513e-06,
         9.66305026e-05,   1.58501238e-05,   1.83597262e-05,
         1.18096917e-04,   2.64852961e-05,   2.32775674e-05,
         7.41405246e-06,   5.58928042e-05,   1.18903000e-04,
         1.12664100e-04,   5.43423717e-05,   5.26165271e-05,
         7.79592168e-06,   1.31760716e-04,   4.08522099e-04,
         7.16268645e-07,   1.79960820e-06,   1.20651493e-05,
         1.21810059e-05,   6.65839706e-06,   6.79216731e-06,
         3.23242209e-05,   7.40711851e-05,   8.30063896e-05,
         1.91012612e-05,   9.13123897e-05,   1.00139660e-06,
         3.39900378e-06,   1.42231373e-06,   1.62724809e-06,
         3.65838939e-05,   3.04666123e-05,   1.25297484e-05,
         6.60072169e-06,   4.28791625e-06,   3.61328368e-06,
         3.14390325e-06,   3.86930041e-06,   6.13377507e-06,
         1.96604658e-05,   3.56758055e-06,   3.22343007e-06,
         1.57054297e-04,   1.19770599e-04,   1.95170495e-04,
         2.79047549e-04,   2.06616589e-05,   1.37179027e-05,
         3.21098147e-04,   3.21097943e-04,   1.32430025e-04,
         1.32460574e-04,   3.53324061e-06,   9.72704535e-05,
         2.94584947e-06,   2.24376341e-04,   1.88741332e-04,
         7.51926769e-05,   4.67854226e-05,   4.66184885e-05,
         7.28247316e-05,   7.28787473e-05,   6.40476762e-05,
         1.29837775e-04,   1.35437870e-04,   1.00744638e-04,
         2.25443415e-04,   2.69215060e-04,   4.87228845e-05,
         4.85264818e-05,   9.94131327e-05,   9.91809613e-05,
         1.96937571e-06,   3.09722782e-06,   1.82361902e-06,
         4.23570048e-06,   3.69703591e-05,   3.84650203e-05,
         5.34686728e-05,   8.74429512e-06,   2.32979157e-06,
         1.69586763e-06,   1.63339126e-06,   1.77786886e-06,
         2.82199195e-05,   8.63562281e-05,   1.12711834e-05,
         1.34952556e-05,   1.91205220e-04,   7.79788593e-05,
         8.14405229e-06,   2.99811016e-05,   6.68947439e-05,
         3.07963760e-05,   4.52634619e-05,   1.14372351e-05,
         1.88633203e-04,   1.17349531e-04,   8.46627511e-07,
         2.73548202e-06,   3.59338154e-06,   3.81429256e-06,
         1.01370916e-04,   2.26250465e-06,   2.15212008e-06,
         1.59617123e-04,   5.51160116e-05,   2.34473308e-05,
         9.69881936e-07,   2.32802974e-06,   3.31611493e-05,
         3.31359782e-05,   1.94621791e-05,   2.25644707e-06,
         7.33144951e-06,   7.35077683e-06,   2.24779319e-06,
         7.56060359e-07,   2.91838360e-06,   1.25671269e-04,
         3.62460908e-05,   4.15457976e-06,   1.93203506e-06,
         1.07139443e-04,   4.53909522e-05,   4.66147683e-06,
         1.11416939e-06,   2.07523063e-05,   8.03091034e-05,
         4.91204323e-05,   1.04586637e-04,   1.05109008e-04,
         8.71538669e-05,   1.04410043e-04,   1.73315120e-04,
         1.44991650e-04,   6.85461190e-05,   1.60390402e-04,
         1.14678256e-04,   1.14886488e-04,   1.14842474e-04,
         1.15070700e-04,   2.61548683e-04,   6.23813738e-05,
         9.33497473e-05,   2.24974566e-05,   4.65761906e-05,
         4.83150769e-05,   8.98210902e-05,   7.71000598e-05,
         1.74024766e-05,   9.75465719e-06,   6.60835229e-05,
         7.65330997e-05])
```

```python
>>> Lk.H.taud
array([  13.41394046,   15.32668193,   17.28244898,   21.30894336,
         43.00088848,   17.28893227,   18.8059076 ,   19.04423909,
         19.46553824,   21.04003428,   22.56162839,   22.76117455,
         24.45549155,   25.38181522,   26.93572493,   37.75571867,
         43.73872895,   44.35880019,   44.64388435,   45.07722557,
         46.0793409 ,   69.09122106,   20.4367845 ,   22.30834285,
         23.93798395,   25.19736453,   25.19736453,   25.55439444,
         26.43261324,   26.43261324,   26.61271395,   27.8027092 ,
         27.93716783,   28.07555064,   28.09863479,   28.74527684,
         29.2244943 ,   29.2244943 ,   29.48784965,   29.91796403,
         38.47723012,   38.59396705,   39.61684354,   45.07441796,
         45.78161493,   45.95327142,   46.37435446,   46.64714638,
         46.76863968,   47.42442841,   47.42442841,   47.61623313,
         48.02257943,   48.09599831,   48.62359187,   48.93487963,
         50.57306244,   55.6288624 ,   69.5528348 ,   70.12557899,
         71.04787819,   96.12220937,   25.97668091,   27.45290806,
         27.45290806,   28.9307905 ,   29.06003004,   29.83774356,
         29.9414269 ,   30.15007588,   30.15007588,   30.28185329,
         30.40535062,   30.96909059,   31.14949343,   32.23483476,
         32.31464906,   32.31464906,   33.54896835,   33.54896835,
         39.30009209,   40.30505226,   42.72580359,   42.72580359,
         47.05933224,   47.15857717,   47.90178234,   48.65905008,
         48.65905008,   48.6843726 ,   48.75679495,   49.27731412,
         49.3148686 ,   49.3148686 ,   49.49917307,   49.57040502,
         49.58449802,   49.96093654,   50.08246886,   50.23251594,
         50.23251594,   50.30031643,   50.38474416,   50.63640199,
         50.76881905,   51.20190079,   51.97725122,   56.20115953,
         56.90843814,   57.24937054,   58.80300516,   63.79284658,
         71.49686003,   71.92771947,   71.92771947,   72.00464915,
         72.05415321,   72.93378444,   76.78735385,   77.58031207,
         80.97413944,   96.4545444 ,   96.86835982,   98.21329079,
        105.07108987,  122.32589205,   27.18065399,   27.83625084,
         28.32003175,   28.61447101,   30.99175769,   32.25661242,
         34.24895092,   34.24895092,   34.35819183,   34.35819183,
         35.01843715,   35.01843715,   35.98728347,   35.98728347,
         37.3535964 ,   43.36470037,   43.36470037,   46.06104502,
         47.83232589,   48.66139538,   48.93487963,   50.50327466,
         50.50327466,   50.59738313,   50.93252235,   51.26446339,
         51.38185652,   51.39526231,   51.7119119 ,   51.73351317,
         52.02084327,   52.02084327,   52.03888168,   52.08862691,
         52.08862691,   52.16773895,   52.41125108,   52.57617033,
         52.57617033,   52.86418868,   52.86418868,   54.38413964,
         54.38413964,   57.73078387,   57.80562626,   58.49350756,
         58.55656726,   59.11489095,   59.11489095,   59.34469998,
         60.01494327,   60.33853914,   62.39338624,   63.94479941,
         64.29251336,   64.91168828,   71.43639743,   72.20676519,
         72.44770183,   72.99773626,   73.35674899,   73.37122674,
         73.80922026,   73.80922026,   73.91438908,   74.08520055,
         74.91320462,   77.20296439,   77.71935223,   77.99169713,
         78.30049254,   78.5028969 ,   79.0721355 ,   79.0721355 ,
         79.88975898,   81.36836767,   81.7028972 ,   81.85848311,
         98.18084913,   98.18084913,   98.53857361,   98.91912432,
         98.94367331,  104.01500734,  105.37520547,  105.75412014,
        106.2239839 ,  106.3693353 ,  107.16277357,  107.16435484,
        117.74745617,  122.58720923,  122.81008214,  122.91307443,
        152.82612519,  152.82636823,   28.96302576,   29.42828909,
         30.31265183,   30.75750638,   32.78395875,   32.78395875,
         36.00679165,   36.00679165,   38.20066968,   39.2338013 ,
         46.75061356,   47.59852801,   49.58449802,   50.38474416,
         51.2243243 ,   51.2243243 ,   52.3484134 ,   53.01829156,
         53.10702764,   53.76745521,   53.81538051,   53.81538051,
         54.13059978,   54.13059978,   54.44304553,   54.44304553,
         54.5662257 ,   54.5662257 ,   58.28244509,   58.9647641 ,
         59.10052089,   59.77350223,   60.64231548,   60.64231548,
         60.86656969,   61.52023493,   62.11113762,   62.11113762,
         62.90417034,   63.53687627,   64.44328802,   65.06102805,
         66.85452322,   66.85452322,   67.4518169 ,   71.88295262,
         72.43727547,   72.64858525,   73.19711018,   73.79168396,
         74.33177397,   74.51588381,   74.73064632,   74.73064632,
         75.05076242,   75.13664376,   75.33915467,   75.62629776,
         75.62629776,   75.86822936,   78.70811351,   79.21469013,
         79.34921368,   79.34921368,   79.47579891,   79.47579891,
         79.97751317,   79.97751317,   80.11681984,   80.11681984,
         80.28931181,   80.78597397,   82.09362589,   82.57943697,
         83.40750121,   83.40750121,   99.24209367,   99.64433329,
        100.22899026,  100.22899026,  104.32220162,  104.70492706,
        106.52480817,  106.66974965,  106.89964806,  106.95762678,
        106.95762678,  107.044082  ,  107.46096984,  107.46254673,
        107.83255556,  107.83412702,  118.01891134,  118.3573548 ,
        123.07037123,  123.39496049,  123.95008619,  123.95008619,
        153.03537023,  153.03561294,  153.29652488,  153.29676718,
         34.27618504,   34.27618504,   34.67022063,   34.67022063,
         42.37087637,   42.37087637,   50.21573327,   50.21573327,
         52.86418868,   52.86418868,   55.4649113 ,   55.4649113 ,
         56.09758676,   56.09758676,   61.09699997,   61.09699997,
         61.87787625,   61.87787625,   63.56680978,   63.56680978,
         65.52049028,   65.52049028,   66.99953262,   66.99953262,
         67.92457289,   68.51093053,   74.18327896,   74.18327896,
         74.92540917,   74.92540917,   75.56133426,   76.03428583,
         76.03428583,   76.08886407,   76.7373243 ,   76.7373243 ,
         77.53701198,   77.53701198,   80.81439929,   80.81439929,
         80.95243505,   81.56226218,   81.56226218,   81.56226218,
         81.56226218,   82.35516736,   82.35516736,   84.11517943,
         84.11517943,  100.92072709,  100.92072709,  105.9203557 ,
        105.9203557 ,  108.09040085,  108.09040085,  108.23324578,
        108.23324578,  108.41707667,  109.01311865,  109.01311865,
        109.01467309,  109.01467309,  119.43392916,  119.43392916,
        124.42795616,  124.42795616,  154.12924622,  154.12924622,
        154.12948721,  154.12948721,   70.35444267,   70.35444267,
         77.75291143,   77.75291143,   81.34676847,   81.83701327,
        108.71183245,  109.0791571 ,   83.38643019,   83.38643019,
        110.24637188,  110.24637188])
```

```python
>>> G=Lk.H.ift()
```

```python
>>> M.tdd.ch2.plot(typ='v')
>>> plt.xlim([10,130])
(10, 130)
```

```python
>>> M.tx
array([-22.3797,  13.3897,   1.2   ])
```

```python
>>> M.rx
array([[  0.    ,   0.    ,   1.2   ],
       [-12.2724,   7.7632,   1.2   ],
       [-18.7747,  15.178 ,   1.2   ],
       [ -4.1418,   8.8603,   1.2   ],
       [ -9.0914,  15.1899,   1.2   ]])
```

```python
>>> np.sqrt(np.sum((M.tx-M.rx[3,:])*(M.tx-M.rx[3,:]),axis=0))/0.3
62.639751380717335
```

```python
>>> Lk.H.ak
array([  3.04906559e-02,   1.35949285e-02,   6.48460691e-03,
         8.72794414e-03,   5.15903804e-03,   6.64521755e-03,
         2.19815883e-03,   3.42409368e-03,   1.10455144e-02,
         4.98814152e-03,   2.92460994e-03,   5.34524756e-03,
         7.38279704e-03,   2.42827989e-04,   2.75670724e-03,
         2.19703142e-03,   4.43994157e-03,   8.25802975e-04,
         4.92996856e-03,   2.91806424e-03,   3.13353800e-04,
         1.91635959e-03,   1.26634432e-03,   2.15588222e-03,
         1.66703498e-03,   3.84877626e-03,   3.84786279e-03,
         2.01421652e-03,   1.23210421e-03,   1.88925328e-03,
         3.32766085e-05,   2.74469050e-04,   5.61564698e-04,
         5.31861891e-05,   1.98996897e-03,   2.76766077e-04,
         1.27293031e-03,   1.27514284e-03,   2.59704171e-03,
         2.44913042e-03,   1.04851736e-04,   1.79076237e-03,
         2.14874407e-03,   1.90052906e-04,   2.54295210e-03,
         3.11998420e-04,   5.23415501e-04,   2.82480147e-03,
         2.62049966e-04,   2.40150628e-03,   2.40187283e-03,
         2.50551734e-04,   1.12991855e-04,   5.61026787e-05,
         2.58174247e-04,   9.29619289e-05,   1.24274315e-03,
         2.83906680e-04,   1.77950782e-03,   1.87008703e-03,
         2.44750945e-04,   7.72701459e-04,   6.83196615e-06,
         3.86100956e-04,   7.68641198e-04,   9.46681663e-05,
         4.01129661e-04,   2.59502942e-04,   1.05691122e-04,
         7.34403849e-04,   6.40102986e-04,   7.17266245e-05,
         4.69797084e-04,   8.73689714e-04,   3.61393307e-04,
         3.42515935e-04,   4.02486837e-05,   4.68671617e-05,
         2.40744607e-04,   1.08758859e-03,   1.66523089e-04,
         2.42727652e-04,   1.16063472e-03,   4.14288671e-04,
         1.22140202e-04,   6.24620127e-04,   1.53099172e-04,
         2.10294830e-04,   1.42105775e-04,   8.89947094e-05,
         5.35399563e-05,   2.21197751e-04,   1.43245515e-03,
         1.43030535e-03,   6.97348771e-05,   6.11175442e-05,
         8.83191767e-05,   2.44037978e-05,   2.13480045e-04,
         2.98371913e-04,   3.05616376e-04,   1.19514896e-04,
         9.34570842e-05,   5.26910027e-04,   3.71515036e-05,
         3.32129559e-04,   7.23439432e-04,   2.50837402e-04,
         2.38957438e-04,   1.30605611e-04,   7.02010102e-05,
         1.63237510e-04,   1.31188895e-04,   1.16464951e-03,
         1.16457963e-03,   2.57320189e-04,   5.12159907e-05,
         5.67243764e-07,   1.52322789e-05,   1.91406875e-05,
         3.75599886e-04,   2.21082335e-04,   4.53757846e-04,
         4.25033856e-04,   2.89649992e-04,   3.41272378e-04,
         3.77290443e-06,   2.08183824e-06,   8.14090657e-07,
         4.62557210e-06,   8.93054333e-05,   1.18543673e-04,
         7.20127938e-05,   4.21263097e-05,   2.03371993e-04,
         1.79059537e-04,   7.21542152e-05,   2.43513525e-04,
         7.91162680e-04,   2.46870193e-04,   4.60325782e-05,
         5.02556430e-05,   5.28022849e-05,   2.25076858e-05,
         5.31777755e-04,   6.02434222e-04,   1.41769944e-06,
         1.19566108e-04,   7.94246760e-05,   2.07025060e-05,
         1.02930462e-04,   4.59712881e-04,   2.24189356e-05,
         3.48425590e-05,   9.46724748e-05,   7.70692818e-06,
         2.25855690e-04,   2.22002020e-04,   4.47985165e-04,
         1.91095259e-05,   4.14978921e-05,   3.75678480e-05,
         2.61072217e-04,   5.42299340e-05,   5.79126811e-05,
         2.70148625e-05,   5.23464692e-05,   6.76137364e-04,
         8.06302573e-04,   2.47589128e-05,   1.08149147e-04,
         9.70024024e-05,   2.82213417e-04,   2.21824608e-04,
         5.60002257e-05,   5.55950227e-05,   4.97655782e-05,
         3.05628756e-05,   1.36261613e-04,   6.01103153e-05,
         1.28311240e-04,   1.11686650e-04,   2.96390052e-07,
         1.28731878e-05,   9.51678291e-05,   9.17733905e-06,
         7.09288463e-06,   1.25473974e-06,   3.86581065e-05,
         3.87255673e-05,   2.65419182e-06,   4.93015918e-05,
         9.74534320e-07,   1.39570402e-05,   1.28108794e-05,
         1.89037246e-05,   4.34650903e-05,   1.90452053e-05,
         4.21514481e-06,   4.40859375e-06,   3.81736391e-06,
         3.55209766e-04,   1.65047937e-04,   2.71394978e-04,
         5.81510185e-04,   4.87909474e-04,   2.43795853e-04,
         2.88092656e-05,   2.55664297e-04,   1.37244723e-04,
         2.78377451e-04,   2.12303159e-04,   4.12447962e-06,
         1.00182765e-04,   1.59775664e-04,   1.59774092e-04,
         2.22480722e-04,   2.18681725e-04,   2.02714357e-04,
         2.24960632e-04,   1.64855884e-04,   1.64854919e-04,
         1.82362422e-06,   2.15150851e-05,   3.03805208e-06,
         3.03182391e-05,   6.60349671e-06,   2.38657011e-06,
         3.60634702e-05,   9.40289490e-05,   4.09454292e-05,
         5.13224600e-05,   2.13765424e-05,   4.61137414e-05,
         1.96140009e-06,   4.48789151e-06,   1.20212960e-04,
         3.66536965e-04,   3.14899590e-06,   2.33891705e-04,
         1.99994339e-06,   2.30533080e-04,   8.86420697e-06,
         2.46315867e-05,   2.88458185e-05,   1.88002019e-05,
         4.16571272e-05,   1.59256101e-04,   5.17812734e-06,
         2.91938847e-05,   1.55499627e-05,   9.60842513e-06,
         9.66305026e-05,   1.58501238e-05,   1.83597262e-05,
         1.18096917e-04,   2.64852961e-05,   2.32775674e-05,
         7.41405246e-06,   5.58928042e-05,   1.18903000e-04,
         1.12664100e-04,   5.43423717e-05,   5.26165271e-05,
         7.79592168e-06,   1.31760716e-04,   4.08522099e-04,
         7.16268645e-07,   1.79960820e-06,   1.20651493e-05,
         1.21810059e-05,   6.65839706e-06,   6.79216731e-06,
         3.23242209e-05,   7.40711851e-05,   8.30063896e-05,
         1.91012612e-05,   9.13123897e-05,   1.00139660e-06,
         3.39900378e-06,   1.42231373e-06,   1.62724809e-06,
         3.65838939e-05,   3.04666123e-05,   1.25297484e-05,
         6.60072169e-06,   4.28791625e-06,   3.61328368e-06,
         3.14390325e-06,   3.86930041e-06,   6.13377507e-06,
         1.96604658e-05,   3.56758055e-06,   3.22343007e-06,
         1.57054297e-04,   1.19770599e-04,   1.95170495e-04,
         2.79047549e-04,   2.06616589e-05,   1.37179027e-05,
         3.21098147e-04,   3.21097943e-04,   1.32430025e-04,
         1.32460574e-04,   3.53324061e-06,   9.72704535e-05,
         2.94584947e-06,   2.24376341e-04,   1.88741332e-04,
         7.51926769e-05,   4.67854226e-05,   4.66184885e-05,
         7.28247316e-05,   7.28787473e-05,   6.40476762e-05,
         1.29837775e-04,   1.35437870e-04,   1.00744638e-04,
         2.25443415e-04,   2.69215060e-04,   4.87228845e-05,
         4.85264818e-05,   9.94131327e-05,   9.91809613e-05,
         1.96937571e-06,   3.09722782e-06,   1.82361902e-06,
         4.23570048e-06,   3.69703591e-05,   3.84650203e-05,
         5.34686728e-05,   8.74429512e-06,   2.32979157e-06,
         1.69586763e-06,   1.63339126e-06,   1.77786886e-06,
         2.82199195e-05,   8.63562281e-05,   1.12711834e-05,
         1.34952556e-05,   1.91205220e-04,   7.79788593e-05,
         8.14405229e-06,   2.99811016e-05,   6.68947439e-05,
         3.07963760e-05,   4.52634619e-05,   1.14372351e-05,
         1.88633203e-04,   1.17349531e-04,   8.46627511e-07,
         2.73548202e-06,   3.59338154e-06,   3.81429256e-06,
         1.01370916e-04,   2.26250465e-06,   2.15212008e-06,
         1.59617123e-04,   5.51160116e-05,   2.34473308e-05,
         9.69881936e-07,   2.32802974e-06,   3.31611493e-05,
         3.31359782e-05,   1.94621791e-05,   2.25644707e-06,
         7.33144951e-06,   7.35077683e-06,   2.24779319e-06,
         7.56060359e-07,   2.91838360e-06,   1.25671269e-04,
         3.62460908e-05,   4.15457976e-06,   1.93203506e-06,
         1.07139443e-04,   4.53909522e-05,   4.66147683e-06,
         1.11416939e-06,   2.07523063e-05,   8.03091034e-05,
         4.91204323e-05,   1.04586637e-04,   1.05109008e-04,
         8.71538669e-05,   1.04410043e-04,   1.73315120e-04,
         1.44991650e-04,   6.85461190e-05,   1.60390402e-04,
         1.14678256e-04,   1.14886488e-04,   1.14842474e-04,
         1.15070700e-04,   2.61548683e-04,   6.23813738e-05,
         9.33497473e-05,   2.24974566e-05,   4.65761906e-05,
         4.83150769e-05,   8.98210902e-05,   7.71000598e-05,
         1.74024766e-05,   9.75465719e-06,   6.60835229e-05,
         7.65330997e-05])
```

```python
>>> Lk.wav=wav
```

```python
>>> ir.plot(typ='v')
(<matplotlib.figure.Figure at 0x7f2c1e6d2850>,
 array([[<matplotlib.axes.AxesSubplot object at 0x7f2c22199790>]], dtype=object))
```

```python
>>> ir
Usignal :  (9047,)  (9047,) 
ax0 : 9047
```

```python
>>> fig = plt.figure(figsize=(10,7))
>>> ax1=fig.add_subplot(211)
>>> cmd='M.tdd.ch' + str(rx_id) + '.plot(typ=[\'l20\'],fig=fig,ax=ax1)'
>>> eval(cmd)
>>> ax2 = fig.add_subplot(212,sharex=ax1,sharey=ax1)
>>> #Lk.chanreal.plot(typ=['v'],fig=fig,ax=ax2)
... ir.plot(typ=['l20'],fig=fig,ax=ax2)
>>> plt.xlim(60,130)
(60, 130)
```

```python

```
