
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Generation of an Impulse of normalized energy &mdash; Python 1 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Python 1 documentation" href="../index.html" />
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-34943220-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>

    <div class="header-wrapper">
      <div class="header">
          <p class="logo"><a href="../index.html">
            <img src="../_static/pylayers.png" alt="Logo"/>
          </a>
          </p><div class="navbar">
          <ul>
            <li><a href="../download.html">Download</a></li>
            <li><a href="../notebook/TOC.html">User Guide</a></li>
            <li><a href="../modules/pylayers.html">Reference</a></li>
       </ul>

<div class="search_form">

<div id="cse" style="width: 100%;"></div>
<script src="http://www.google.com/jsapi" type="text/javascript"></script>
<script type="text/javascript">
  google.load('search', '1', {language : 'en'});
  google.setOnLoadCallback(function() {
    var customSearchControl = new google.search.CustomSearchControl('016639176250731907682:tjtqbvtvij0');
    customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
    var options = new google.search.DrawOptions();
    options.setAutoComplete(true);
    customSearchControl.draw('cse', options);
  }, true);
</script>

</div>
</div> <!-- end navbar --></div>
    </div>

    <div class="content-wrapper">

      <div class="sphinxsidebar">
	<div class="sphinxsidebarwrapper">
	   <div class="rel rellarge">
	     
	<!-- rellinks[1:] is an ugly hack to avoid link to module
	    index  -->
	<div class="rellink">
	<a href="../py-modindex.html" title="Python Module Index"
	    >Modules
	    <br>
	    <span class="smallrellink">
	    Python Module In...
	    </span>
	    <span class="hiddenrellink">
	    Python Module Index
	    </span>
	    
	    </a>
	</div>
	<!-- Ad a link to the 'up' page -->
    </div>
    <p style="text-align: center; background-color: #BFFFFF">This documentation is

    for Python <strong>version 1</strong>
    &mdash; <a href="https://github.com/pylayers/pylayers/archive/master.zip">Other versions</a></p>
    
    <h3>Citing</h3>
    <p>If you use the software, please consider
    <a href="../about.html#citing-pylayers">citing pylayers</a>.</p>
    <h3>This page</h3>
	<ul>
<li><a class="reference internal" href="#">Generation of an Impulse of normalized energy</a><ul>
<li><a class="reference internal" href="#verification-of-energy-normalization-in-both-domains">Verification of energy normalization in both domains</a></li>
<li><a class="reference internal" href="#calcul-of-uwb-channel-impulse-response">Calcul of UWB channel impulse response</a></li>
<li><a class="reference internal" href="#ploting-the-waveform">Ploting the waveform</a><ul>
<li><a class="reference internal" href="#in-time-domain">In time domain</a></li>
<li><a class="reference internal" href="#in-frequency-domain">in frequency domain</a></li>
</ul>
</li>
<li><a class="reference internal" href="#construction-of-the-propagation-channel">Construction of the propagation channel</a></li>
<li><a class="reference internal" href="#construction-of-the-transmission-channel">Construction of the transmission channel</a></li>
<li><a class="reference internal" href="#calculate-uwb-channel-impulse-response">Calculate UWB Channel Impulse Response</a></li>
</ul>
</li>
</ul>

    
    </div>
	  </div>


      <div class="content">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pylayers.signal.bsignal</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pylayers.simul.simulem</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">figsize</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="generation-of-an-impulse-of-normalized-energy">
<h1>Generation of an Impulse of normalized energy<a class="headerlink" href="#generation-of-an-impulse-of-normalized-energy" title="Permalink to this headline">¶</a></h1>
<p>One possible manner to define an ernergy normalized short UWB impulse is
as follows.</p>
<p><img class="math" src="../_images/math/d1adbfc8509ab884fe792a4c9cb13f13dbc28fd0.png" alt="p(t)= \frac{\sqrt{2\sqrt{2}}}{\tau\sqrt{\pi}} \cos(2\pi f_c t) e^{-(\frac{t}{\tau})^2}"/></p>
<p><img class="math" src="../_images/math/bfb0ffe4c8088040feab4e798714f8b9a6329e41.png" alt="\tau = \frac{2}{B\pi}\sqrt{\frac{\gamma_{dB}\ln{10}}{20}}"/></p>
<p>where <img class="math" src="../_images/math/83956e92fcc80dee17fce864543216939a3c9da7.png" alt="B"/> is the desired bandwidth defined at
<img class="math" src="../_images/math/188795ebfe88db0394a818814d3f11796cf7c8e1.png" alt="\gamma_{dB}"/> below the spectrum maximum and <img class="math" src="../_images/math/95dca2acb17190fe4abb62b64ba7d7f8f7a7c4a1.png" alt="f_c"/> is
the central frequency of the pulse.</p>
<p>This waveform is a gaussian windowing of a sine wave of frequency
<img class="math" src="../_images/math/95dca2acb17190fe4abb62b64ba7d7f8f7a7c4a1.png" alt="f_c"/>. The normalization term depends on the exponential scaling
factor <img class="math" src="../_images/math/d9e99c35d3632bb156b7aca0e93cd78a148a10e8.png" alt="\tau"/>.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">fc</span>     <span class="o">=</span> <span class="mi">4</span>
<span class="n">band</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="n">thresh</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">fe</span>     <span class="o">=</span> <span class="mi">100</span>
<span class="n">ip</span> <span class="o">=</span><span class="n">EnImpulse</span><span class="p">([],</span><span class="n">fc</span><span class="p">,</span><span class="n">band</span><span class="p">,</span><span class="n">thresh</span><span class="p">,</span><span class="n">fe</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ip</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>TUsignal
--------
shx :  (343,)
shy :  (343,)
dx :   0.01
xmin : -1.71
xmax : 1.71
ymin : -1.89545539648
ymax : 2.16154131873
</pre></div>
</div>
<div class="section" id="verification-of-energy-normalization-in-both-domains">
<h2>Verification of energy normalization in both domains<a class="headerlink" href="#verification-of-energy-normalization-in-both-domains" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">E1</span><span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ip</span><span class="o">.</span><span class="n">y</span><span class="o">*</span><span class="n">ip</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">ip</span><span class="o">.</span><span class="n">dx</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&quot;Integration in time&quot;</span><span class="p">,</span><span class="n">E1</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Integration in time 1.0
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">P</span> <span class="o">=</span> <span class="n">ip</span><span class="o">.</span><span class="n">esd</span><span class="p">()</span>
<span class="n">E2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">dx</span><span class="p">()</span>
<span class="k">print</span> <span class="s">&quot;Integration in frequency domain &quot;</span><span class="p">,</span><span class="n">E2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Integration in frequency domain  1.0
</pre></div>
</div>
</div>
<div class="section" id="calcul-of-uwb-channel-impulse-response">
<h2>Calcul of UWB channel impulse response<a class="headerlink" href="#calcul-of-uwb-channel-impulse-response" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">=</span> <span class="n">Simul</span><span class="p">()</span>
<span class="n">S</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s">&#39;where2.ini&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">st</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">st</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sf</span>
<span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>tw  :  30.0
band  :  4.0
fc  :  4.493
thresh  :  3.0
fe  :  50.0
Np  :  1500.0
te  :  0.02
type  :  file
</pre></div>
</div>
<p>Here the time domain waveform is measured and the anticausal part of the
signal is artificially set to 0.</p>
<p>To handle properly the time domain wavefom it is required to center the
signal in the middle of the array.</p>
<p><tt class="docutils literal"><span class="pre">st</span></tt> stands for signal in time domain</p>
</div>
<div class="section" id="ploting-the-waveform">
<h2>Ploting the waveform<a class="headerlink" href="#ploting-the-waveform" title="Permalink to this headline">¶</a></h2>
<div class="section" id="in-time-domain">
<h3>In time domain<a class="headerlink" href="#in-time-domain" title="Permalink to this headline">¶</a></h3>
<p>In[36]:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_00.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_00.png" />
</div>
<div class="section" id="in-frequency-domain">
<h3>in frequency domain<a class="headerlink" href="#in-frequency-domain" title="Permalink to this headline">¶</a></h3>
<p>The frequency domain version of the signal is embedded in the same
object.</p>
<p><tt class="docutils literal"><span class="pre">sf</span></tt> stands for signal in frequency domain.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_01.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_01.png" />
</div>
</div>
<div class="section" id="construction-of-the-propagation-channel">
<h2>Construction of the propagation channel<a class="headerlink" href="#construction-of-the-propagation-channel" title="Permalink to this headline">¶</a></h2>
<p>The link between Txid = 1 and Rxid =1 is simply loaded as</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">vc</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">VC</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>nray :  500
nfreq :  181
nb rays in .tauk file:  500
nb rays 2:  500
</pre></div>
</div>
<p>The following representation shows the spatial spreading of the
propagation channel. On the left are scattered the intensity of rays wrt
to angles of departure (in azimut and elevation). On the right is the
intensity of rays wrt to angles of arrival. It misses the application
between the 2 planes as well as the delay dimension of the propagation
channel.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">vc</span><span class="o">.</span><span class="n">doadod</span><span class="p">()</span>
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_02.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_02.png" />
</div>
<div class="section" id="construction-of-the-transmission-channel">
<h2>Construction of the transmission channel<a class="headerlink" href="#construction-of-the-transmission-channel" title="Permalink to this headline">¶</a></h2>
<p>The transmission channel is obtain from the combianation of the
propagation channel and the vector antenna pattern at bot side of the
radio link</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">sc</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">vec2scal</span><span class="p">()</span>
</pre></div>
</div>
<p>The ScalChannel object contains all the information about the ray
transfer functions. The transmission channel is obtained by applying a
vector radiation pattern using an antenna file. In the presented case,
it comes from a real antenna which has been used during the FP7 WHERE1
measurement campaign M1.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>defant.vsh3
type :  vsh3
--------------------------
fmin (GHz) : 2.0
fmax (GHz) : 8.0
Nf   : 121
Br
-------------
Nf   :  121
fmin (GHz) :  2.0
fmax (GHz) :  8.0
Ncoeff s3 :  18
Bi
-------------
Nf   :  121
fmin (GHz) :  2.0
fmax (GHz) :  8.0
Ncoeff s3 :  18
Cr
-------------
Nf   :  121
fmin (GHz) :  2.0
fmax (GHz) :  8.0
Ncoeff s3 :  18
Ci
-------------
Nf   :  121
fmin (GHz) :  2.0
fmax (GHz) :  8.0
Ncoeff s3 :  18
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">f</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">sc</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_03.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_03.png" />
<p>The antenna can also been taken into account</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c"># scaling constant depends on how are stored the antenna data</span>
<span class="n">sca</span> <span class="o">=</span> <span class="n">vc</span><span class="o">.</span><span class="n">vec2scalA</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">tx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">S</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">A</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">sca</span><span class="o">.</span><span class="n">H</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>(&lt;matplotlib.figure.Figure at 0xb1c9b2c&gt;,
 array([Axes(0.125,0.547727;0.775x0.352273),
       Axes(0.125,0.125;0.775x0.352273)], dtype=object))
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_04.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_04.png" />
</div>
<div class="section" id="calculate-uwb-channel-impulse-response">
<h2>Calculate UWB Channel Impulse Response<a class="headerlink" href="#calculate-uwb-channel-impulse-response" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cir</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">applywavB</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">wav</span><span class="o">.</span><span class="n">sfg</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cir</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_05.png" src="manual/4__UWB_Waveform_files/4__UWB_Waveform_fig_05.png" />
</div>
</div>


          </div>
        </div>
      </div>
        <div class="clearer"></div>
      </div>
    </div>
  

    <div class="footer">
        &copy; 2015, PyLayers developer team.
      Last updated on mars 27, 2015.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.2. Design by <a href="http://desgrana.es">Desgrana</a>.
    <span style="padding-left: 5ex;">
    <a href="../_sources/manual/4-UWBWaveform.txt"
	    rel="nofollow">Show this page source</a>
    </span>
    </div>
     <div class="rel rellarge">
    
    <div class="buttonPrevious">
      <a href="../py-modindex.html">
        Previous
      </a>  
    </div>
    
     </div>
     <script type="text/javascript">
       $("div.buttonNext, div.buttonPrevious").hover(
           function () {
               $(this).css('background-color', '#AFFFFF');
           },
           function () {
               $(this).css('background-color', '#AFFFFF');
           }
       );
     </script>
  </body>
</html>